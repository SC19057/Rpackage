<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="19057" />

<meta name="date" content="2020-01-01" />

<title>Introduction to R package SC19057</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Introduction to R package SC19057</h1>
<h4 class="author">19057</h4>
<h4 class="date">2020-01-01</h4>



<div id="overview" class="section level2">
<h2>Overview</h2>
<p><strong>SC19057</strong> is a simple R package mainly contains two R functions <em>knnde</em> and <em>indTest</em>. <em>knnde</em> is used to estimate density by k-nearest method, and <em>indTest</em> performs independence test on two vectors. The former function needs the R_package “FNN” and the latter function is based on R function “kedd”.</p>
</div>
<div id="k-nearest-neighbor-density-estimation" class="section level2">
<h2>K-nearest neighbor density estimation</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1">knnde &lt;-<span class="st"> </span><span class="cf">function</span>(x, k, xrange, yrange){ </a>
<a class="sourceLine" id="cb1-2" title="2">  p &lt;-<span class="st"> </span><span class="kw">ncol</span>(x) </a>
<a class="sourceLine" id="cb1-3" title="3">  n &lt;-<span class="st"> </span><span class="kw">nrow</span>(x) </a>
<a class="sourceLine" id="cb1-4" title="4">  est_pt &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(xrange, yrange) </a>
<a class="sourceLine" id="cb1-5" title="5">  distance &lt;-<span class="st"> </span>FNN<span class="op">::</span><span class="kw">knnx.dist</span>(x, est_pt, k) </a>
<a class="sourceLine" id="cb1-6" title="6">  est &lt;-<span class="st"> </span><span class="kw">matrix</span>(k <span class="op">/</span><span class="st"> </span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>n <span class="op">*</span><span class="st"> </span>distance[,k]), <span class="dt">nrow =</span> <span class="kw">length</span>(xrange)) </a>
<a class="sourceLine" id="cb1-7" title="7">  <span class="kw">return</span>(est) </a>
<a class="sourceLine" id="cb1-8" title="8">}</a>
<a class="sourceLine" id="cb1-9" title="9"><span class="kw">data</span>(<span class="st">&quot;law&quot;</span>,<span class="dt">package =</span> <span class="st">&quot;bootstrap&quot;</span>)</a>
<a class="sourceLine" id="cb1-10" title="10">x &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(law)</a>
<a class="sourceLine" id="cb1-11" title="11">xrange &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">500</span>, <span class="dt">to =</span> <span class="dv">700</span>, <span class="dt">by =</span> <span class="dv">10</span>) </a>
<a class="sourceLine" id="cb1-12" title="12">yrange &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">1</span>, <span class="dt">to =</span> <span class="dv">4</span>, <span class="dt">by =</span> <span class="fl">0.05</span>)</a>
<a class="sourceLine" id="cb1-13" title="13">k &lt;-<span class="st"> </span><span class="dv">4</span> </a>
<a class="sourceLine" id="cb1-14" title="14">fit &lt;-<span class="st"> </span><span class="kw">knnde</span>(x, k, xrange, yrange)</a>
<a class="sourceLine" id="cb1-15" title="15"><span class="kw">persp</span>(xrange,yrange,fit,<span class="dt">col=</span><span class="st">&#39;orange&#39;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>By the plot we can get the distribution of students’ LAST and GPA, and the two values seems not independent.</p>
</div>
<div id="independence-test-based-on-kernel-density-estimation-and-bootstrap-method" class="section level2">
<h2>Independence test based on kernel density estimation and bootstrap method</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">indTest&lt;-<span class="cf">function</span>(x,y,B,<span class="dt">alpha=</span><span class="fl">0.05</span>){</a>
<a class="sourceLine" id="cb2-2" title="2"></a>
<a class="sourceLine" id="cb2-3" title="3">n &lt;-<span class="st"> </span><span class="kw">length</span>(x)</a>
<a class="sourceLine" id="cb2-4" title="4">h.x &lt;-<span class="st"> </span>(<span class="kw">range</span>(x)[<span class="dv">2</span>]<span class="op">-</span><span class="kw">range</span>(x)[<span class="dv">1</span>])<span class="op">/</span><span class="kw">length</span>(x)</a>
<a class="sourceLine" id="cb2-5" title="5">h.y &lt;-<span class="st"> </span>(<span class="kw">range</span>(y)[<span class="dv">2</span>]<span class="op">-</span><span class="kw">range</span>(y)[<span class="dv">1</span>])<span class="op">/</span><span class="kw">length</span>(y)</a>
<a class="sourceLine" id="cb2-6" title="6"></a>
<a class="sourceLine" id="cb2-7" title="7">f &lt;-<span class="st"> </span><span class="cf">function</span>(xstar,ystar){ <span class="co"># return T_0</span></a>
<a class="sourceLine" id="cb2-8" title="8">  k.x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rep</span>(<span class="dv">0</span>,n<span class="op">^</span><span class="dv">2</span>),n,n) </a>
<a class="sourceLine" id="cb2-9" title="9">  k.y &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rep</span>(<span class="dv">0</span>,n<span class="op">^</span><span class="dv">2</span>),n,n)</a>
<a class="sourceLine" id="cb2-10" title="10">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</a>
<a class="sourceLine" id="cb2-11" title="11">    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</a>
<a class="sourceLine" id="cb2-12" title="12">      k.x[i,j] &lt;-<span class="st"> </span>kedd<span class="op">::</span><span class="kw">kernel.fun</span>((x[i]<span class="op">-</span>x[j])<span class="op">/</span>h.x)<span class="op">$</span>kx</a>
<a class="sourceLine" id="cb2-13" title="13">      k.y[i,j] &lt;-<span class="st"> </span>kedd<span class="op">::</span><span class="kw">kernel.fun</span>((y[i]<span class="op">-</span>y[j])<span class="op">/</span>h.y)<span class="op">$</span>kx</a>
<a class="sourceLine" id="cb2-14" title="14">      k.y[j,j] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb2-15" title="15">      k.x[i,i] &lt;-<span class="st"> </span><span class="dv">0</span> </a>
<a class="sourceLine" id="cb2-16" title="16">    }</a>
<a class="sourceLine" id="cb2-17" title="17">  }</a>
<a class="sourceLine" id="cb2-18" title="18">  f.x &lt;-<span class="st"> </span><span class="kw">rowSums</span>(k.x)<span class="op">/</span>(n<span class="dv">-1</span>) <span class="co"># leave-one-out KDE for x</span></a>
<a class="sourceLine" id="cb2-19" title="19">  f.y &lt;-<span class="st"> </span><span class="kw">rowSums</span>(k.y)<span class="op">/</span>(n<span class="dv">-1</span>) <span class="co"># leave-one-out KDE for y</span></a>
<a class="sourceLine" id="cb2-20" title="20">  f.xy &lt;-<span class="st"> </span><span class="kw">rowSums</span>(k.x<span class="op">*</span>k.y)<span class="op">/</span>(n<span class="dv">-1</span>) <span class="co"># leave-one-out KDE for (x,y)</span></a>
<a class="sourceLine" id="cb2-21" title="21">  Ihat &lt;-<span class="st"> </span><span class="kw">mean</span>(f.xy)<span class="op">+</span><span class="kw">mean</span>(f.x)<span class="op">*</span><span class="kw">mean</span>(f.y)<span class="op">-</span><span class="kw">t</span>(f.x)<span class="op">%*%</span>f.y<span class="op">*</span><span class="dv">2</span><span class="op">/</span>n <span class="co"># estimation for ISE</span></a>
<a class="sourceLine" id="cb2-22" title="22">  s2hat &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">/</span>(n<span class="op">^</span><span class="dv">2</span><span class="op">*</span>h.x<span class="op">*</span>h.y)<span class="op">*</span><span class="kw">sum</span>(k.x<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k.y<span class="op">^</span><span class="dv">2</span>) <span class="co"># estimation for variance \sigma^2</span></a>
<a class="sourceLine" id="cb2-23" title="23">  T_<span class="dv">0</span> &lt;-<span class="st"> </span>n<span class="op">*</span><span class="kw">sqrt</span>(h.x<span class="op">*</span>h.y)<span class="op">*</span>Ihat<span class="op">/</span><span class="kw">sqrt</span>(s2hat) <span class="co"># (Fan) T_0 assyptotically follows N(0,1)</span></a>
<a class="sourceLine" id="cb2-24" title="24">  <span class="kw">return</span>(T_<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb2-25" title="25">}</a>
<a class="sourceLine" id="cb2-26" title="26"></a>
<a class="sourceLine" id="cb2-27" title="27">T &lt;-<span class="st"> </span><span class="kw">numeric</span>(B)</a>
<a class="sourceLine" id="cb2-28" title="28">count &lt;-<span class="st"> </span><span class="kw">numeric</span>(B)</a>
<a class="sourceLine" id="cb2-29" title="29"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B) {<span class="co">#bootstrap to get T&#39;s B replicate</span></a>
<a class="sourceLine" id="cb2-30" title="30">  xstar &lt;-<span class="st"> </span><span class="kw">sample</span>(x,n,<span class="dt">replace =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb2-31" title="31">  ystar &lt;-<span class="st"> </span><span class="kw">sample</span>(y,n,<span class="dt">replace =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb2-32" title="32">  T[i] &lt;-<span class="st"> </span><span class="kw">f</span>(xstar,ystar)</a>
<a class="sourceLine" id="cb2-33" title="33">  count[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(T[i])<span class="op">&gt;</span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb2-34" title="34">}</a>
<a class="sourceLine" id="cb2-35" title="35">p &lt;-<span class="st"> </span><span class="kw">mean</span>(count)</a>
<a class="sourceLine" id="cb2-36" title="36"></a>
<a class="sourceLine" id="cb2-37" title="37"><span class="cf">if</span>(p<span class="op">&lt;=</span>alpha){</a>
<a class="sourceLine" id="cb2-38" title="38"><span class="kw">return</span>(<span class="kw">print</span>(<span class="st">&quot;Not Independent&quot;</span>))}<span class="cf">else</span> {</a>
<a class="sourceLine" id="cb2-39" title="39">  <span class="kw">return</span>(<span class="kw">print</span>(<span class="st">&quot;Independent&quot;</span>))</a>
<a class="sourceLine" id="cb2-40" title="40">}</a>
<a class="sourceLine" id="cb2-41" title="41">}</a>
<a class="sourceLine" id="cb2-42" title="42"></a>
<a class="sourceLine" id="cb2-43" title="43"><span class="kw">data</span>(<span class="st">&quot;law&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in data(&quot;law&quot;): data set &#39;law&#39; not found</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">x &lt;-<span class="st"> </span>law<span class="op">$</span>LSAT</a>
<a class="sourceLine" id="cb4-2" title="2">y &lt;-<span class="st"> </span>law<span class="op">$</span>GPA</a>
<a class="sourceLine" id="cb4-3" title="3">B &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb4-4" title="4"><span class="kw">indTest</span>(x,y,B,<span class="fl">0.05</span>)</a></code></pre></div>
<pre><code>## [1] &quot;Not Independent&quot;</code></pre>
<p>By the independece test we can also find that the two vectors are not independent.</p>
</div>
<div id="homework" class="section level2">
<h2>Homework</h2>
<div id="section" class="section level3">
<h3>2019.9.20</h3>
<div id="an-example-of-dateset-women" class="section level4">
<h4>An Example of Dateset Women</h4>
<p>This is an dataset from R.The dataset named Women contains average heights and weights for American women.</p>
<table>
<thead>
<tr class="header">
<th align="right">height</th>
<th align="right">weight</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">58</td>
<td align="right">115</td>
</tr>
<tr class="even">
<td align="right">59</td>
<td align="right">117</td>
</tr>
<tr class="odd">
<td align="right">60</td>
<td align="right">120</td>
</tr>
<tr class="even">
<td align="right">61</td>
<td align="right">123</td>
</tr>
<tr class="odd">
<td align="right">62</td>
<td align="right">126</td>
</tr>
<tr class="even">
<td align="right">63</td>
<td align="right">129</td>
</tr>
<tr class="odd">
<td align="right">64</td>
<td align="right">132</td>
</tr>
<tr class="even">
<td align="right">65</td>
<td align="right">135</td>
</tr>
<tr class="odd">
<td align="right">66</td>
<td align="right">139</td>
</tr>
<tr class="even">
<td align="right">67</td>
<td align="right">142</td>
</tr>
<tr class="odd">
<td align="right">68</td>
<td align="right">146</td>
</tr>
<tr class="even">
<td align="right">69</td>
<td align="right">150</td>
</tr>
<tr class="odd">
<td align="right">70</td>
<td align="right">154</td>
</tr>
<tr class="even">
<td align="right">71</td>
<td align="right">159</td>
</tr>
<tr class="odd">
<td align="right">72</td>
<td align="right">164</td>
</tr>
</tbody>
</table>
<p>From the table, we can easily find that weight has a positive correlation with height. To prove our thought and find the exact correlaion, we can make a linear regression based on the data.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">myfit&lt;-<span class="kw">lm</span>(weight<span class="op">~</span>height,women)</a>
<a class="sourceLine" id="cb6-2" title="2"><span class="kw">summary</span>(myfit)</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = weight ~ height, data = women)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.7333 -1.1333 -0.3833  0.7417  3.1167 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -87.51667    5.93694  -14.74 1.71e-09 ***
## height        3.45000    0.09114   37.85 1.09e-14 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.525 on 13 degrees of freedom
## Multiple R-squared:  0.991,  Adjusted R-squared:  0.9903 
## F-statistic:  1433 on 1 and 13 DF,  p-value: 1.091e-14</code></pre>
<p>From the result of anlysis, we know <em><span class="math inline">\(R^2= 0.991\)</span></em>, which tells that’s a good fit. And We can also get the fuction between weight and height.The equation is:</p>
<p><strong><span class="math display">\[ weight= -87.5167+ 3.45 * height \]</span></strong></p>
<p>Meanwhile, we can get the fitted line as following plot shows.From the picture, we can easily find that most spots are in the fitted line. <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAkFBMVEUAAAAAADoAAGYAAP8AOjoAOpAAZrY6AAA6ADo6Ojo6kNtmAABmtv+QOgCQ2/+2ZgC2/7a2///bkDrb/7bb////AAD/ADr/AGb/OgD/Ojr/Omb/OpD/ZgD/Zjr/Zmb/ZpD/Zrb/kDr/kGb/kLb/kNv/tmb/tpD/ttv/tv//25D/27b/29v/2////7b//9v////GFUKLAAAACXBIWXMAAA7DAAAOwwHHb6hkAAALz0lEQVR4nO2di3qbuBZGaZmm5zRJfepTJ2nimTbTMk3S2H7/txt0gw1G+iWQQK73+r6ZEiO2xLJugGwXB8ZJsXQBcocFAVgQgAUBWBCABQFYEIAFAVgQgAUBWBCABQFYEIAFAVgQgAUBWBCABQFYEIAFAVgQgAUBWBCABQFYEIAFAVgQgAUBWBCABQFYEIAFAYYE7e82kpv71+kZ1MEeQpL/WWf8LTTk4+amLer+q1dOnWPssV2CNoMhAgkUVIlsf4SGpCf7cnfrlVMUQei9jM9wsUOO2m6mCDrCIkhafN7If0Wtv1GmxOb9qyxCHf+fu83tK939d2325utrZ9ME++fLZvPluy7ZLxmnzbHZuW3r7VYeV7/wJOvVU5uRDtktjAkpI9weBT7OtfOCPbZLkCrjTtWl+4OpWjd3qkyCB7pbvSRL127qYPoFsknewHYnEVSJf3eqwYmSthmpkMeFkfl1BLlyJce4YuMatBXV5FmWsxJtbr/d6DI9vB5+kd072SKr3qYKpkI9yiiP8m17bLua7k5zBs+i1jzLZl7H+EYyUiGPC/PYyBwM3Mu1d4wtNuiD5Ln+kOFuTd47U6Yn9YfZXWdw/6spmdlUOepSb9sjn9sOrrvTCJJWHuVbLFyRjGhIWphdX5AzV3KMK7Zb0DcZ0tRNU7PomXR3b3SL724+NHVSHqSO3DVFHdipz+Chzuqv+gWtv1OOgcKokK0gZ670BVdsl6D7nwc97qqDTXQqiOyuB1i19XQgmzIzc6TsbPtFHdh5UH/fvGw2P+82P0RfWPVOYqAwfUHOXOkLrtjWPmj/qDq3Z9WU6DvSq0FP7ZEvYvBSiczm+BpUp1DV5y/RAvrliFyDrLEdnfSjDEZC9pq9PJNdf660JwXc9hr18dmQsP0+SA1Iquqo8cykH+qDhgS5cyUvuGK7RjE1B9lubn4eXjbHA4eZrpjd9d7vsnF1NodGsV5Rh0cx1Xxl6fWMyGQ0NIq1IUkEZ65dqdbYYJi/beYIN6/9qYcqB9n959Dm0DyoV9Tjnc35bWQnJlPueiGPC9NMLobnQQ5BjthgoiiOfhFn+7WZcD68dtsC2V2JuPfdzc5M+ke/ZJr+zqYc4g89oWgzIrPdTmFUyD2dLzty7bxgjz3mdsc26PIzMSkLI2IHCdqamdHs17ADpCwMiR0kyMwXItwFmU7KwpDYYU3s5cumuV5fnJSFaWPzLVcACwKwIAALArAgAAsCsCAACwKwIAALArAgAAsCsCAACwKwIAALArAgAAsCsCAACwKwIAALArAgAAsCsCAACwKwIEBkQcXJkEbQ/lpFf/spSrgl0G7SCFoXH9RGZTYmhVuCgvznfYAv++tGy/rd58nhlqAw/08iaHd5ZTYrSyM7b0FcgxDrQlch7oMs7C7VKGapPycgyIxipXf6yNnHDZeKskxUg+YOl4gyWRNb1YPX8/uiePMxSrhlKEXzSiNI+vnPx86APyHcMqjeJ9E8qB67Vhdi88SG+fbaq9S9c7KJop4L9SaK4deAs9KO6yV9yftYb0TtWZ9eDWpmh2XZe837YE92l28/ySpU2XrpnAWV5dFr3gd7U6mGdBEp3Dz0Whd5zfvgyGXJjW7rMi95Hxu5KDlSHM2cWRClX30OLKjD0IVponlQO985nRtmA9XnkKoG7a+td+vHhEuMmrZa7mske6phHeDHhEuKnD4PV59DynmQ5Sp1XLiEqNti1vIECrJenYeSlaC6+rAgK8XBeduHBYHbYucuSOhx3nwJFgRnOCHhFgc/szjrGmQd2wnnKkg0K69HXmcqaOC+hj2ld8jDbyOo8H/kNfPVfCY37Qv/R17nOYoFPPIaU4NitLMlBekrC78inKEgWX28G/nZCfIcvBrOSlBdbQL1nJegImS5T3tQeMITFRQwttOjRiQ8UUGBy1k0iQTlt9LetK7EgjwnivmttDeta5Y+CJLdOmk9to+5wkn04DCvlfbBYzshXNDqQi7PtK9sya0GhU4Nu4QK2l3WZ/z8/kqt0bSR00r7ctqdg1BBK1EjhCD3s9NsVtqPmvtQAgWpxiMEHdancLtj5NhOGHVHUQqydb+R851C88R0TkFt94sFSZET851A27rmE6SXh3e3jshifVDZXlrM2Ae1lcK6wFfuVIPXcjWI3NeYeP87eB5UqQnQ2r28Rc4GBgTNdNO+cK3XCAwVnnDlHL+bVHUNW6oGqdYV6TlM9ISG+oJ1IUHTx3ZCwudiz+//WEJQjLGdkPLB4f7a3lElE9S0rmX6oNwfHDaf8oo2Csz86DlVOM2k6/ZhfidBI55ZYMav7nBciy0zk5563T7MGEHqkt51sbrASvty3EMLSBpB86+0jzu2ExIJmnmlfdkshzoZQdHy9SHOdfswv4Gg5qZ8kkvgkxeUZGwnnLqgNGM74bQvNVKN7YSTnkknG9sJ4TUozkLpCOeUcGwnjGti8H5ivHytpBzbCWOamF78M6kqTbuRXhRpx3aa1+iEqzGddJSb9oXrM6axGSeomlqBpj3KK30/aBGBEYLWtR3Lmo0E+Q4cGvGZhUdugQlXMeyE5HvEDHMfyvhn8zPl26ecYeSihNagtXttWfx82yNEx16GfdAiAiP6oCqGo+AzlNUmwU15n3zDE4pFitMmi6GCRPrUF+7WjMclHDUPCs+3ST/n2N7JODyhmkm7lr/EX2k/79hOMw5LqK/FUBcUfaW9al0L+AkX5Kw4mujrpOVtsWU+CJzkflC8lfZkbF+IJIKi1aClxvZeEeImFERaab/Y2N4rQ9yEkjgr7Yuw7wRPQtb3pMd9iDIuWQtabGwnJBK0NnfUbOvxXeH0gA6/HGoWEnXS9WxpdymmkyME6Wqz7ODVkHCY31/XXXS4ILVn0bkPJelEcfXu8zr4O+1zGNsJaSeKq4tRNWjxsZ2QqA/SWurpUHgftNB9DQvJRjHVyKyLFY/CNa2uzGDoIuQyDzIznmw6Z0Mmggr9/9z0ZCYou+pzWFhQ29moqXNGXU9DonmQ10p7eqU16suP5iBNDfJaaW/6HcXEL0hIRqIm5rPSngrKsfdRpOqDPFbaE0HZ6lm2k8527kNZfhTLWk8G86C89SwoSFGP7bmzkCBn0OGXIySOkZ8NFgRgQQAWBGBBABYEYEEAFgRgQYA879ZkBAsCsCAACwKwIAALArAgAAsCsCAACwKwIAALArAgQFRBavmHXEdd4O9wEJ+QFWnlxxjRx9JN4nbDSqUf7FzJTZ8PwrmIKqj5UQ6x4hw9xq/efZar0vfXdeI1OmmduN0AqMSiGBMNRRVkPmanFoE4vh3/YNYUr99+Ut9O7f6tgSZxs4GKIpKoxO5iQKIKWuuy+Ajq/QSM+41uEjt/OIYe8P6D+Wr5aT8UElfQ6r+6N/FoYtXb/12Srsf9afQmce8oe0lEOGVz2rfWRRWkfhJgJb9LD/aO60I2Al3LrB9h7CXuHuUoiSyELMLETij+MC/eMfEGylpuZ/2GvL0V6KObxJ2jHGUgarITVLd8n8av9qqUoP6QxPQoB/K3nPJrYoq6WD5vnSq3PIc17FSaxOQoB/rbfrLrpHV1MCO3+61Tn60SacCPnXQSt0fhgmQ4zMuyiE7aow+SH70Xp4DSdRK3Gy5M3c1uoii/6evKbMB2o9Ks1YUBOI/KBKw8Ijetap3ZpcbvCAsCsCAACwKwIAALArAgAAsCsCAACwKwIAALArAgAAsCsCAACwKwIAALArAgAAsCsCAACwKwIAALArAgAAsCsCBAJoLMojGxsGell/G++6wWHsjFxWLBT5vo/+br5qYtbfEhR0HNN+ZLQXJ1jPx6OZrIfz3nRLIX1Kz1uWBBhyFB5q/1FQs6DAiii6XOW1DTMzed9AchiPxcTifR+Qmy1CAlaCUHrPOuQVZB5he7WJDA3kmzIPmvdZhnQY6JolztXPA8SEAvNd58JJca4prinAXlCwsCsCAACwKwIAALArAgAAsCsCAACwKwIAALArAgAAsCsCAACwKwIAALArAgAAsCsCAACwKwIAALAvwLdDRaX1P7pRsAAAAASUVORK5CYII=" /><!-- --></p>
</div>
<div id="aother-example-about-random-values" class="section level4">
<h4>Aother Example about Random Values</h4>
<p>I have produced 150 random values from standard normal distribution,which named x.Meanwhile, I also sampled same number random values from T distribution with 50 d.f,100 d.f and 150 d.f,which named y1,y2,y3. We can see the distribution of these values from the following plot.</p>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="section-1" class="section level3">
<h3>2019.9.29</h3>
<div id="section-2" class="section level4">
<h4>1.</h4>
<p>Souppose <span class="math inline">\(t\sim Gamma(1,\frac{1}{\sigma^2}),\sigma&gt;0\)</span>.</p>
<p><span class="math inline">\(\because F(x)=P(X\le x)=P(\sqrt{t}\le x)=P(t\le x^2)\)</span></p>
<p><span class="math inline">\(\therefore F&#39;(X)=f_T (x^2)*2x=\frac{1}{2\sigma^2}e^{-\frac{x^2}{2\sigma^2}}*2x = \frac{x}{\sigma^2} e^{-\frac{x^2}{2\sigma^2}}\)</span></p>
<p>Since we can find that when <span class="math inline">\(t\sim Gamma(1,\frac{1}{\sigma^2})\)</span>,<span class="math inline">\(x=\sqrt{t}\sim Rayleigh(\sigma)\)</span>, we can Generate a random <span class="math inline">\(t\)</span> from <span class="math inline">\(Gamma(1,\frac{1}{\sigma^2})\)</span> first, then diliver <span class="math inline">\(x=\sqrt{t}\)</span>. Thus, the <span class="math inline">\(x\)</span> we get is generated from <span class="math inline">\(Rayleigh(\sigma)\)</span>. Observing the histogram of x, we can find the mode of the generated samples is close to the theoretical mode <span class="math inline">\(σ\)</span>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb8-2" title="2">x&lt;-<span class="cf">function</span>(a){</a>
<a class="sourceLine" id="cb8-3" title="3">shape&lt;-<span class="dv">1</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>a<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb8-4" title="4">t&lt;-<span class="kw">rgamma</span>(<span class="fl">1e4</span>,<span class="dv">1</span>,shape)</a>
<a class="sourceLine" id="cb8-5" title="5">x&lt;-<span class="kw">sqrt</span>(t)</a>
<a class="sourceLine" id="cb8-6" title="6"><span class="kw">return</span>(x)</a>
<a class="sourceLine" id="cb8-7" title="7">}<span class="co">#generate a random R(σ) sample</span></a>
<a class="sourceLine" id="cb8-8" title="8"></a>
<a class="sourceLine" id="cb8-9" title="9"><span class="co">#layout(matrix(c(1:4),2,2,byrow = TRUE))</span></a>
<a class="sourceLine" id="cb8-10" title="10"><span class="kw">hist</span>(<span class="kw">x</span>(<span class="fl">0.1</span>),<span class="dt">prob=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAsVBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6ADo6AGY6OgA6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmZmZmkLZmkNtmtttmtv+QOgCQZgCQZjqQkGaQkLaQtpCQttuQtv+Q2/+2ZgC2Zjq2ZpC2kGa229u22/+2/7a2///bkDrbkGbbtmbbtpDb27bb29vb/7bb/9vb////tmb/25D/27b//7b//9v////7o0Z0AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKCElEQVR4nO2de2ObNhTFSZvM7tKtc5puq7NHu9CtWeljW0gTf/8PNr3ACCQOBGGwOOePNoC4SD9fXSR8LZId1apk6grMXQQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEFBTQw1Vydqv/X5UblcN/fgh5NWnx3TpJXjR231+cXMuDSXLyk1WFVFXpbv2ke0UOCOjrZY96dVOeCG0auzN5ZXF9qVWleoKYrJI40jzHp/EANZQmwQFliXQVRzU26tjb3cck2Ra7P18mGpAG2FGje9DHc+Ho399IPkIS0edXSfJUu778TE+vFTnRnjeXyZMb3Y7n17KjJKvP58nJ693HtSi1v0xpQJnUiO7W0oi4pvg3l/v0h1T5qDJRdK3rJwpvu7ZpbECZ8nNZ7QKQ2WN8XbbwfL/77DbXh0UTBSCt8wJt2VJjoAJI7t3If7byT1FYnC37UVo6S5acvjf1M8c6KTSgQgaQ9ILb3ScVKHQXu1sbbhsVQla3D2nB7exm948465tbWWijAG3kuclrU16paqDSxcSJJ2/WJvisdtpEtV9/fHFbhsW0ex8bGZCo5ul7c1TX1dQ41U4l/xYgNKCtKfjlr3NpQOwXzdD/mubuzeyKfll2PVFEu5P8UByAdnsP7xMORwak9+iIk5ooYeLkyXXxt9XWh18LA7qhVnMrjVTlrSCdmjuaLtsKyB3cnRo7Bn291CHlD1NX3V7Vu7bF31VAkujp718uvICqBuyG5mu9dVyAxPDnt/MipHbwIN2uez8grwcpZ9XjQGPCDtK7uQKS27/sI44/Bqk6K8cog7QDkDcGZep2V/qOvrw9IpshINHeH1Q/UzceWSv/XazwoLPbr1f+GOS7i8nd/16Y4cFKQ3itB4ollzkE6boHvSuHNWpe0DYOKmNQa5CujoMqgORd/loRL7xmP9VwAZrsNt/oYp9kBHp+szPD5hszEP5ZnyB2fXfTuIudvpVjPR+gioE9oDwxIUeFbl0LMZNVk9UGoD6TsTk87ujxeXZSjiLM3bpzCJoWUKqeVQjvcExtB0g4yLa1QD7VZLWvzLyr+y2lozJAPJ3qcUdvfX21NnP9oLq/aL1JTffALEYREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQFNCKhIyp+uBl00JaDJa9BF/aqXPvmgfjQyKGcusV0nJkCKzzP1g5rt8EvGB+j+Qv7qS+VHZgMSd2MGJNP6VYJobqdBJkmPiBsvIOU9WasHLRyQTK9VLpT7ovTCAZWp39487cUDCmGOgDqWISBQpgA07ynHDACNU5NQIiAgAgIiIKBDAqpFYwLyHCQgcJCAwEECAgd9gOY5XpwRoFEqNFhh6tPtgdmCAXUzR0AENMzccQMqlr4KZK7l4JEC0uvydF/TAprzHjxaQLsAjGIHpBENWHI1ckDyOwv53eDjvzaNGZBcGVSTyR/vQhED0otUBzPXcvBYAb3UfAa4z24RgDICsmTqk+6nm/g2f7feAnOtB48S0N6DWlSugO0fCkQMqIty7V7L9KBOur/Qy+1u61Zanwd5khKPCdD9xabsP+1BOhWDgb4e1I3IrAH1UJZsCKhVd+unywQkc1izpMMqp21LpQYANLNvN/b1SOU7DFYmzXe4OcfOXh40O0AyxzcXrjHCVCMeQDKTfoSpRhyARN+So5z7C3YxS9Ugrd7kMOzJfcyAxjNHQMBcJICKFzYwSFuqBOkQ74+LGJD6MVg4c66dxw5oG9Kca2c/QDOZcZQVGHSD9zwP6pTW2m1zMu0rkHd/MWIXc5WtOAB1fGDW1Vx1Kw5AY5gjIGAuMkDqfZTpsJt9zIDyk+tMzuYD5gdFBUj+mln+2Dvk86CoAMmBogQU8oliVIAKD0oHvS0uYkAmBmXDhosxA9JDxYFZVFEDCm8uBKCp56yzB+Sye0hV7mLygwIROkvMS899g4F4AaWm4a0JZpl6UbB6T/DSAJXr3bRkbpjFlVQa9dIAVZ6WtXw3Xzx0FEOlrNMKVPEAqszAWqYaZnkuCXFpHlR5IN021Siw6DfE+83VtpYDaFeMsx+uCGiIudoWAdXN1baiAARTxPuYq22FADTZlCPwFcf2IAIiIAJqbhGQzxwBAXMEBMwREDA3AqCDD4eODZDrMqMqzKUO9jzoWAF5zBGQx9yjfoO5KEC2cQKqmxsf0OHuZkcKyN4cUwQEREBABAREQEBHDmj8m9mRA7I3xxABAfWzDX+VOC2gMXpcL2Nl9lDuSyOaCJB77hdEfYyV2R3o/WKTeZD5L6Qn9THi/4K69jwombXGA9TBg+JTzxi01X94Y1B86udwRZLDYvznIIP149YogKYNwj49si1h0fQx2qnUgQsFOy2EUQIKUYqA5lUo2GkhjBJQiFIENK9CwU4LYZSAQpSKE1BMIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICCgkory5glftWs6oduPvWlUpTLaRyblzf5FqWMs/16vXou0ZbQEByBZlyFRlrw1tKflfryjWqFnq4En9kjtcIW5bkqhmu69Xrkff9VjgcIJ3aYBaPsTa8pdTn6wBkFdIL9jRXU7EKqdVZHCs+1+uhVhvt1axwgKyG+FpVO5AnG9dKD46zm97RLOQAVC+Unf0yHaBnsgmmvdaGt9TOXcZ1dnPF/WahrNnFaoXE5nQxSH/G5pO2Nryl1A4HoObZjnybeqHcFcntQrLDxQko98Ro+xKOdzDbhR6z0uhRdDFnvpbjEo5A1ajUhIAeEaR3HkB2IffSfI5LNFeoswplJg+mXqhVE9/m3YDsQp7lZR1jgaatZj2ObaDoXtCpWuhu7cmHtCzJdleSTL2XmxJQMdrXwxHf0N8u5VvxqlLIdAyHMctS6uk7tctNCihKERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQHNFtDD1dadMnz/cti7cntqtoCylS9lOD/o8k5zBSQXlPOkDCvfOpjmBkgmg8mkZ5kV40sZPugKc3MDVL7VfeXPZ3QmZo2luQESEP5+ea0z530ZsW0vyw2u2QHapTLlV61p6QNUeSvs+JofoFxm0ikn8XWxZQN6uPpRxemtP2V42YCys/9EnDa/3nGnDC86BknXkRwUFk/K8KLvYjrfeWVYuFOGFz0OKlRZmrnHoRE0V0BqLuYW52JK3hkXZ/PzEgEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERDQ/2V4i58en8whAAAAAElFTkSuQmCC" /><!-- --></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="kw">hist</span>(<span class="kw">x</span>(<span class="fl">0.5</span>),<span class="dt">prob=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="kw">hist</span>(<span class="kw">x</span>(<span class="dv">2</span>),<span class="dt">prob=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="kw">hist</span>(<span class="kw">x</span>(<span class="dv">5</span>),<span class="dt">prob=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAtFBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmZmZmkLZmkNtmtttmtv+QOgCQZgCQZjqQkGaQkLaQtpCQttuQtv+Q2/+2ZgC2Zjq2ZpC2kGa229u22/+2/7a2///bkDrbkGbbtmbbtpDb27bb29vb/7bb/9vb////tmb/25D/27b//7b//9v///8GNOA3AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJjUlEQVR4nO2deWObNhyGSZfM3tJtnd10W/GOdqHbstJjW3Bsvv/3mg6EsY14xWFbiPf5w3Fk+BkeC10IiHLSSHTpDfAdCgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCHASQdtVdPOo/87Kfyof//F+6C98N4+iF0fJm+XVfZ6nkWKWr+fP2n/xBQQ93XXYzmYyaWBxlJyqb06MILElx8sgTi/oiCQaXFAayaxSsxkLmY1KLelhXnbgbDnow20UXX33UPygUtGnV1H0xY9qi7fvouj6XpkT+/rmLnr2kH+6E8t9c6/2cPbpNrp6nX+Yi6V2X1MGUCG1ovVcBhHfKV4zlSZS4mKFyltnziWoKAjEZhtBRYpcUCwi9/B2l3zzmOmPxS4KQZpbo1azC1ARJFMX8iWWb+XCItBzYVr8NNXM5MypBBkKQTIXPOYfVUGhDzHxa2pvC7UPs8dtYrzdPOT/iLW+fJQLLZSghVw3el0sr6gGqBxiYsWrN+qj4gBPStPyfetj7EyCxN5c/1V8qgUVJVGiM5V8L0RoQXGx4Oc/b2UAkS52S78qY9UwuTkuy0NPLKJ1yB9FbMsv82txvM6L8rp18XcmQTpFlzhJUUqoH1Pumnm/t6/bX0wAvaP6dSeoGmC/kE6KGq0i0+Sx+sK8kXOVQU93OqP/XnjQ+6uOrti8rwqSRq9/+7y0CqoG2N/xbK7/2xOU+S5INH9+vTVFqkMO0nu3sQuy5iCVWeVHYxMk//95V+LYyyC1DypjlIV0jSBrGZSq6m5hll2/mi/Kpf0VJPb3e3WcqYqnaJ5YajGTg24en1b2MshWi8nkf5dF82Cma7W3+cd5UaN5U0gf5qB3u8o2A+2gsgxqLKSr7aCKIOnjXhk31byq1SJzEHtTzR8dYh9lCaSaa6rZ/FA0hH/SK4ikbx+OarHrt7KtZxNUCbATlOkaLNFFty78xGJXL4rt8aOh2JEOv28j2WGJs563LoL8EJSosYr1vK5r2wORYeK9hMyXzmpbin5X+yoGkB4YT3wZ7mjN06t50dcflM1yr9LyZ8AsJCgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAjQTpA8FRWrN4NPEvOVVoJSdb5SDoRTUB3b1UK9yjO+FFTDZhmrv8nNIwXVoXOQIJlRUC1Gi56oMg3a1mKx+rtdURDRUBCAggAUBGjXDiqnP7MWq2VClVdJu0Nsu+o3Byyq0ivS2Wi5mVn99USuex1Z3nvMwJtJQf3CURAFFdh68xTULxwFUVC/cMELMtfgWBvUExeUmqn8mW1O/7QFlWPSQpXlqpBpCzJnNQQZq/kamIMQZsyeZZANM2RmvS6tjaBxDH340Q6ioJqPJyWo74BZ8IJcw1FQTThbYUxBNUkUREHtw1EQCEdBIFwogswtrwYKV580ZkF6EnT7e1tYw9UljVtQPoCj0AVpRT2mcAQuKFNXGqiZ4kOEO04atSA51qPN2MZTW4WrTRqzIH1z6sHC1SeNWtBL7adH9sknIajfRQbBCkp2IxJdqvmmAbMwBO1y0EDh6pPGLOhk4SYlKBEFlLz1p7XCC1XQZrkoZ4k3FNLKz1f3eyeh68JZk0YryA2hUV5MJ9+2OPU8KUGxOT/fYvJCMIJk/kgbzirnOvekk81BiXx2waw4hOqRt/5UWSizldJdBfl7nr7SF4vVhQbNXY3M3AUbhatPGmFu2hMka6mLdzV8FSSOrc1SPkKl18h0yII2S/UEh0Y/XWa5BiPIgU6zXCckqNscxWAEwcOn4yzXYAQlsPqadg5SHS2AdZbrkANm/gqK8dJdZrmGIqjvBc0H4eqTxizIdkFz13C1SWMW5DJgtqPFJZmhCDpZOAoC4cIRpJ5DmfSbIRSyoOzqPpW9+SZDU+6symZyCu6QOOnOqmwoSkENI4rT7mqYHJTYR+0n3lnVZVDa0Fycdg4qmoqNs6g6XZIZjiAHptxZPVm4UATpzNH3OZ7hCkqKO413m0ce/oBZeS55PY/7h9s7k9xakF+nofUmVEbLms7Nu4aLjpP6v78QehMqPbAhTj2HKCg2CUPMk6YgEI6CQDgKAuFCFLSrWSloj5N0NSgIhKMgEI6CQDgKAuEoCISjIBCOgkA4CjqKsj+AQ0EgHAWBcMMJuvzoYruvdZy8cJIcNAZBrpMXpirI+dTzVAU5T16YqiDmIITr5IXJCnKdvDBdQY7hKAiEO42gyzQax9lQ9FWQNw1FTwX5U817KsifhqKngjzKQecrsIdpKB4OmHnNCQXhhmJ4XKj5NR4oCNBRUL+JemPiJDnosoWwnU77MrQch6DNH1/q0yFX6hk0YEH4BiguQcMVhDurTkGDFeTQ1XAKGqwg57mwUxXEHITAZzWcgoYryLWzOl1BE4SCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBhheUNd7GSo8HWO4Psv76PY5QhxorX3RbFzC4IHkfGetzSXL97CQL8rkmOEIN25VYPJXa26+LGFqQHnW030KmYaw202dLUIQa9D190uKxMT1vYHPA0ILKbbV8ntrVRQtlD0WwInJO53XtDC5IHUL2fJI8j+yPUdSCQAQrybP3nde1M7QgXQBYiwH58BexKxZDas9ABPs3C+9d123gzIKKhSw/cR9BmSmjPRfklMltN0rrcYjp8ywjOMSciklbXd+9kC5Oio+gkAYVrd6DxkOsS1VtTtiNoJpHTTW18Y2FdIfG3npuAvrfUJS/ZmNjXz40ObZ8VuQsEKH2KyVypdbrIthZBVAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAvgvaruJy6vDm5aBn3d3wXZCc9FlOJ8oucGswzwWpmz2U04lkdjo3ngqSk8TkkymVm93U4eYbPpwETwWVD3dX863KqcPDzo1ywlNBIuv8LYpk9XjTytThno/J7YKvgvJETus9vN9M5Xmw58JbQZmcqFfJMeotBZVsVz+ocjo2Caqup6CS9OY/UU4rIZWpwyyDDDLrSCW6FiunDrMWMySi4pKPMNdtxHLqMNtBh1QKoaP/zoPngvYvwGNf7Jhq94u9eR+hIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQYD/AdCRMk0WoCFeAAAAAElFTkSuQmCC" /><!-- --></p>
</div>
<div id="section-3" class="section level4">
<h4>2.</h4>
<p>The problem is to generate a mixture sample, thus we can use transformation method to get the mixture value. The algorithm is as follows: a. Generate an value <span class="math inline">\(u \sim U(0,1)\)</span> b. If <span class="math inline">\(u\le p_1\)</span>, deliver a random <span class="math inline">\(x\)</span> from <span class="math inline">\(N(0,1)\)</span>.Otherwise, deliver <span class="math inline">\(x\)</span> from <span class="math inline">\(N(3,1)\)</span></p>
<p>From the histogram of the mixture values under different <span class="math inline">\(p_1\)</span>, we can find that when <span class="math inline">\(p_1=0.45 \ or\ 0.6\)</span>, there is a bimodal trend in the plot.Thus, we can guess when <span class="math inline">\(p_1\in (0.45,0.6)\)</span> can produce a bimodal mixture.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb12-2" title="2">n &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb12-3" title="3">x1 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n)</a>
<a class="sourceLine" id="cb12-4" title="4">x2 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n,<span class="dv">3</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb12-5" title="5">x&lt;-<span class="cf">function</span>(p1){</a>
<a class="sourceLine" id="cb12-6" title="6">p&lt;-p1</a>
<a class="sourceLine" id="cb12-7" title="7">u &lt;-<span class="st"> </span><span class="kw">runif</span>(n)</a>
<a class="sourceLine" id="cb12-8" title="8">k &lt;-<span class="st"> </span><span class="kw">as.integer</span>(u <span class="op">&lt;</span><span class="st"> </span>p) <span class="co">#vector of 0’s and 1’s</span></a>
<a class="sourceLine" id="cb12-9" title="9">x &lt;-<span class="st"> </span>k <span class="op">*</span><span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>k) <span class="op">*</span><span class="st"> </span>x2 </a>
<a class="sourceLine" id="cb12-10" title="10">}<span class="co">#generte a mixture sample</span></a>
<a class="sourceLine" id="cb12-11" title="11"><span class="kw">layout</span>(<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>),<span class="dv">2</span>,<span class="dv">3</span>,<span class="dt">byrow =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb12-12" title="12"><span class="kw">hist</span>(<span class="kw">x</span>(<span class="fl">0.75</span>), <span class="dt">prob=</span><span class="ot">TRUE</span>);<span class="kw">lines</span>(<span class="kw">density</span>(<span class="kw">x</span>(<span class="fl">0.75</span>)),<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb12-13" title="13"><span class="kw">hist</span>(<span class="kw">x</span>(<span class="fl">0.15</span>), <span class="dt">prob=</span><span class="ot">TRUE</span>);<span class="kw">lines</span>(<span class="kw">density</span>(<span class="kw">x</span>(<span class="fl">0.15</span>)),<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb12-14" title="14"><span class="kw">hist</span>(<span class="kw">x</span>(<span class="fl">0.3</span>), <span class="dt">prob=</span><span class="ot">TRUE</span>);<span class="kw">lines</span>(<span class="kw">density</span>(<span class="kw">x</span>(<span class="fl">0.3</span>)),<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb12-15" title="15"><span class="kw">hist</span>(<span class="kw">x</span>(<span class="fl">0.45</span>), <span class="dt">prob=</span><span class="ot">TRUE</span>);<span class="kw">lines</span>(<span class="kw">density</span>(<span class="kw">x</span>(<span class="fl">0.45</span>)),<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb12-16" title="16"><span class="kw">hist</span>(<span class="kw">x</span>(<span class="fl">0.6</span>), <span class="dt">prob=</span><span class="ot">TRUE</span>);<span class="kw">lines</span>(<span class="kw">density</span>(<span class="kw">x</span>(<span class="fl">0.6</span>)),<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb12-17" title="17"><span class="kw">hist</span>(<span class="kw">x</span>(<span class="fl">0.9</span>), <span class="dt">prob=</span><span class="ot">TRUE</span>);<span class="kw">lines</span>(<span class="kw">density</span>(<span class="kw">x</span>(<span class="fl">0.9</span>)),<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="section-4" class="section level4">
<h4>3.</h4>
<p>Since a Wishart distribution sample <span class="math inline">\(X=X_1*X_1^T\)</span>, where <span class="math inline">\(X\sim N_d(0,Σ)\)</span> is a <span class="math inline">\(d\times1\)</span> vector. Thus, when <span class="math inline">\(Σ\)</span> is given, our algorithm is:</p>
<ol style="list-style-type: lower-alpha">
<li>Generate an <span class="math inline">\(n × d\)</span> matrix <span class="math inline">\(Z\)</span> containing nd random <span class="math inline">\(N(0,1)\)</span> variates</li>
<li>Compute a factorization <span class="math inline">\(Σ = Q^T Q\)</span>.</li>
<li>Apply the transformation <span class="math inline">\(X = ZQ\)</span> .</li>
<li>Deliver the <span class="math inline">\(n×d\)</span> matrix <span class="math inline">\(X\)</span>.</li>
<li>Deliver <span class="math inline">\(M=X^T*X\)</span></li>
</ol>
<p>In my case, I have produced a positive definite symmetric matrix Sigma first, and then I used the matrix to gnerate a wishart distribution sample by the transformation method and Bartlett’s decomposition.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="kw">set.seed</span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb13-2" title="2">wishart &lt;-<span class="st"> </span><span class="cf">function</span>(n,sigma){</a>
<a class="sourceLine" id="cb13-3" title="3">  d &lt;-<span class="st"> </span><span class="kw">nrow</span>(sigma)</a>
<a class="sourceLine" id="cb13-4" title="4">  T &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rep</span>(<span class="dv">0</span>,d<span class="op">*</span>d),d,d) </a>
<a class="sourceLine" id="cb13-5" title="5">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>d){</a>
<a class="sourceLine" id="cb13-6" title="6">    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>i){</a>
<a class="sourceLine" id="cb13-7" title="7">        <span class="cf">if</span>(i<span class="op">&gt;</span>j) T[i,j] &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb13-8" title="8">        <span class="cf">if</span>(i<span class="op">==</span>j) T[i,j] &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">rchisq</span>(<span class="dv">1</span>,<span class="dt">df =</span> (n<span class="op">-</span>i<span class="op">+</span><span class="dv">1</span>)))</a>
<a class="sourceLine" id="cb13-9" title="9">    }</a>
<a class="sourceLine" id="cb13-10" title="10">  }</a>
<a class="sourceLine" id="cb13-11" title="11">  L &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">chol</span>(sigma))</a>
<a class="sourceLine" id="cb13-12" title="12">  M &lt;-<span class="st"> </span>(L<span class="op">%*%</span>T)<span class="op">%*%</span><span class="kw">t</span>(L<span class="op">%*%</span>T)</a>
<a class="sourceLine" id="cb13-13" title="13">  M</a>
<a class="sourceLine" id="cb13-14" title="14">}</a>
<a class="sourceLine" id="cb13-15" title="15"></a>
<a class="sourceLine" id="cb13-16" title="16">n &lt;-<span class="st"> </span><span class="dv">5</span></a>
<a class="sourceLine" id="cb13-17" title="17">sigma &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.7</span>,<span class="fl">0.7</span>,<span class="dv">1</span>), <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">ncol =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb13-18" title="18">d &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb13-19" title="19">M &lt;-<span class="st"> </span><span class="kw">wishart</span>(n,sigma)</a>
<a class="sourceLine" id="cb13-20" title="20">M</a></code></pre></div>
<pre><code>##          [,1]     [,2]
## [1,] 5.827548 5.302377
## [2,] 5.302377 6.221034</code></pre>
</div>
</div>
<div id="section-5" class="section level3">
<h3>2019.10.11</h3>
<div id="section-6" class="section level4">
<h4>5.1</h4>
<p>We can transform the integral as follows:<span class="math display">\[\int_0^{\pi/3} \sin t\  dt=\frac\pi 3 \int_0^{\pi/3} \frac{\sin t}{\pi /3}dt=\frac\pi 3E(\sin t)  , \ \     where \ t\sim U(0,\frac\pi 3)\]</span> Therefore, we can extract m samples from a uniform distribution and then compute the mean of function <span class="math inline">\(f(t)=\sin t\)</span> which depends on the samples. The mean we get is a Monte Carlo estimate of the integral. We can also compute the exact value of the integral:<span class="math display">\[\int_0^{\pi/3} \sin t\  dt=\int_0^{\pi/3}-d\cos t =\cos(0)-cos(\pi/3)=0.5\]</span></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb15-2" title="2">m&lt;-<span class="fl">1e4</span></a>
<a class="sourceLine" id="cb15-3" title="3">t&lt;-<span class="kw">runif</span>(m,<span class="dv">0</span>,pi<span class="op">/</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb15-4" title="4">int.m&lt;-<span class="kw">mean</span>(<span class="kw">sin</span>(t))<span class="op">*</span>pi<span class="op">/</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb15-5" title="5">int.e&lt;-<span class="kw">cos</span>(<span class="dv">0</span>)<span class="op">-</span><span class="kw">cos</span>(pi<span class="op">/</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb15-6" title="6"><span class="kw">cat</span>(<span class="st">&quot;Monte Carlo estimate=&quot;</span>,int.m)</a>
<a class="sourceLine" id="cb15-7" title="7"><span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">exact value=&quot;</span>,int.e)</a></code></pre></div>
<pre><code>## Monte Carlo estimate= 0.49808
## exact value= 0.5</code></pre>
</div>
<div id="section-7" class="section level4">
<h4>5.10</h4>
<p>We can transform the integral as follows:<span class="math display">\[\int_0^1{\frac {e^{-x}}{1+x^2}}\ dx=E(\frac {e^{-x}}{1+x^2})=E(g(x)) ,\ where\  g(x)=\frac {e^{-x}}{1+x^2} ,x\sim U(0,1)\]</span> Then, we can define a pair of antithetic variables <span class="math inline">\(Y_i\ and\ Y_i^-\)</span>:<span class="math display">\[Y_i=g(x_i)\ ,\ Y_i^-=g(1-x_i)\ \ \ \ where \ x_i \ is \ from \ U(0,1)\]</span><br />
since <span class="math inline">\(g(x)\)</span> is montone, <span class="math inline">\(Y_i\ and\ Y_i^-\)</span> are negatively correlated.Therefore, we can estimate the integral as follows:<span class="math display">\[\int_0^1{\frac {e^{-x}}{1+x^2}}\ dx=E(g(x)) \approx \frac2 m \sum_{i=1}^{m/2}{\frac{Y_i+Y_i^-}2}\]</span>(the m is the size of x which we generate from the uniform distribution)</p>
<p>From the code below, we can get the Monte Carlo estimate of the integral is <em>0.524</em>, and the approximate reduction in variance as a percentage of the variance without variance reduction is <em>98.2%</em></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb17-2" title="2">m&lt;-<span class="dv">1000</span></a>
<a class="sourceLine" id="cb17-3" title="3">x&lt;-<span class="kw">runif</span>(m)</a>
<a class="sourceLine" id="cb17-4" title="4"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb17-5" title="5">x&lt;-<span class="kw">runif</span>(m)</a>
<a class="sourceLine" id="cb17-6" title="6">y1&lt;-<span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb17-7" title="7">y2&lt;-<span class="kw">exp</span>(x<span class="dv">-1</span>)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>(<span class="dv">1</span><span class="op">-</span>x)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb17-8" title="8">est&lt;-<span class="kw">mean</span>((y1<span class="op">+</span>y2)<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb17-9" title="9"><span class="kw">cat</span>(<span class="st">&quot;estimation=&quot;</span>,est)</a>
<a class="sourceLine" id="cb17-10" title="10"><span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">var=&quot;</span>,<span class="kw">var</span>((y1<span class="op">+</span>y2)<span class="op">/</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb17-11" title="11"><span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">approximate reduction in variance=&quot;</span>,(<span class="kw">var</span>(y1)<span class="op">-</span><span class="kw">var</span>((y1<span class="op">+</span>y2)<span class="op">/</span><span class="dv">2</span>))<span class="op">/</span><span class="kw">var</span>(y1))</a></code></pre></div>
<pre><code>## estimation= 0.5244618
## var= 0.001088789
## approximate reduction in variance= 0.9817578</code></pre>
</div>
<div id="section-8" class="section level4">
<h4>5.15</h4>
<p>The question is to compare estimates of the intergral <span class="math inline">\(\int_0^1{\frac {e^{-x}}{1+x^2}}\ dx\)</span> with different method. By my answer 5.10, I have used antithetic variables to estimate the intergral, where I got the estimation is <span class="math inline">\(0.5244\)</span> with the variance being <span class="math inline">\(0.0011\)</span>.</p>
<p>Then I use stratified importance sampling to estimate the integral(as the below code shows).And from the result, I get that the estimation is <span class="math inline">\(0.5249\)</span> with the variance is <span class="math inline">\(5.3739\times10^{-8}\)</span>.</p>
<p>By compare the estimation and its corresponding variance, we can find that both estimation is similar with the exact value. However, the second one(with stratified importance sampling) possesses a much fewer variance. Therefore, the second one performs better in that case.</p>
<p><strong>More Discussion：</strong></p>
<p>By the code below, we can also find that the estimation with importance sampling only is <span class="math inline">\(0.5249\)</span> while its variance is <span class="math inline">\(1.008\times10^{-6}\)</span>.Obviously, though the variance of that estimation is larger than the second one(with stratified importance sampling), it is still much fewer than the first one. Thus, we can draw a conclusion: in that case, the estimate with stratified importance sampling performs best, and the estimate with importance sampling second, and the one with antithetic variables worst.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"><span class="co">#to calculate the new estimator with stratified importance sampling</span></a>
<a class="sourceLine" id="cb19-2" title="2">M &lt;-<span class="st"> </span><span class="dv">10000</span> <span class="co">#number of replicates</span></a>
<a class="sourceLine" id="cb19-3" title="3">k &lt;-<span class="st"> </span><span class="dv">5</span> <span class="co">#number of strata</span></a>
<a class="sourceLine" id="cb19-4" title="4">r &lt;-<span class="st"> </span>M <span class="op">/</span><span class="st"> </span>k <span class="co">#replicates per stratum</span></a>
<a class="sourceLine" id="cb19-5" title="5">N &lt;-<span class="st"> </span><span class="dv">50</span> <span class="co">#number of times to repeat the estimation</span></a>
<a class="sourceLine" id="cb19-6" title="6">T1 &lt;-<span class="st"> </span><span class="kw">numeric</span>(k)</a>
<a class="sourceLine" id="cb19-7" title="7">estimates &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb19-8" title="8">fg&lt;-<span class="cf">function</span>(u){</a>
<a class="sourceLine" id="cb19-9" title="9">  x &lt;-<span class="st"> </span><span class="op">-</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>u <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</a>
<a class="sourceLine" id="cb19-10" title="10">  g&lt;-<span class="kw">exp</span>(<span class="op">-</span>x <span class="op">-</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)) <span class="op">*</span><span class="st"> </span>(x <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">*</span><span class="st"> </span>(x <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb19-11" title="11">  fg &lt;-<span class="st"> </span>g<span class="op">/</span><span class="st"> </span>(<span class="kw">exp</span>(<span class="op">-</span>x) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</a>
<a class="sourceLine" id="cb19-12" title="12">  <span class="kw">return</span>(fg)</a>
<a class="sourceLine" id="cb19-13" title="13">}</a>
<a class="sourceLine" id="cb19-14" title="14"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb19-15" title="15">  u &lt;-<span class="st"> </span><span class="kw">runif</span>(M) </a>
<a class="sourceLine" id="cb19-16" title="16">  estimates[i, <span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">fg</span>(u)) <span class="co">#the estimate with importance sampling(f3) only</span></a>
<a class="sourceLine" id="cb19-17" title="17">  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k){</a>
<a class="sourceLine" id="cb19-18" title="18">    y &lt;-<span class="st"> </span><span class="kw">runif</span>(M<span class="op">/</span>k, (j<span class="dv">-1</span>)<span class="op">/</span>k, j<span class="op">/</span>k) <span class="co">#the estimate by stratified importance sampling(f3)</span></a>
<a class="sourceLine" id="cb19-19" title="19">    T1[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">fg</span>(y))</a>
<a class="sourceLine" id="cb19-20" title="20">    estimates[i, <span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(T1)</a>
<a class="sourceLine" id="cb19-21" title="21">  }</a>
<a class="sourceLine" id="cb19-22" title="22">}</a>
<a class="sourceLine" id="cb19-23" title="23"><span class="kw">apply</span>(estimates, <span class="dv">2</span>, mean)</a>
<a class="sourceLine" id="cb19-24" title="24"><span class="kw">apply</span>(estimates, <span class="dv">2</span>, var)</a></code></pre></div>
<pre><code>## [1] 0.5248928 0.5248431
## [1] 8.862449e-07 3.991573e-08</code></pre>
</div>
</div>
<div id="section-9" class="section level3">
<h3>2019.10.18</h3>
<div id="section-10" class="section level4">
<h4>6.5</h4>
<p>Since <span class="math inline">\(\frac{\bar{x}-\mu}{\sqrt{S_n/n}} \sim t(n-1)\)</span>, we can produce a t-interval about mean.The 95% t-interval is: <span class="math inline">\(\bar{x}\pm\sqrt{\frac{S_n}{n}}*t_{1-\alpha/2}(n-1)\)</span>.<br />
Because this confidence interval(c.i) is based on the assumption that the sample is from normal distribution, the coverage probability of the c.i is not equal to <span class="math inline">\((1-\alpha)100\%\)</span>.The result from the lower code proves it.<br />
In this question, sample x is from <span class="math inline">\(χ^2 (2)\)</span>. We can get the coverage probability of the t-interval is 0.908, which is lower than 0.95. Compared with the example 6.4, we can find the t-interval is more robust, because the coverage probability given by Chi-square method is 0.812, which is much smaller than 0.908.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb21-2" title="2">m&lt;-<span class="dv">1000</span></a>
<a class="sourceLine" id="cb21-3" title="3">c&lt;-<span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb21-4" title="4"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb21-5" title="5">  n&lt;-<span class="dv">20</span></a>
<a class="sourceLine" id="cb21-6" title="6">  x&lt;-<span class="kw">rchisq</span>(n,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb21-7" title="7">  alpha&lt;-<span class="fl">0.05</span></a>
<a class="sourceLine" id="cb21-8" title="8">  u&lt;-<span class="kw">mean</span>(x)<span class="op">+</span><span class="kw">sqrt</span>(<span class="kw">var</span>(x)<span class="op">/</span>n)<span class="op">*</span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)</a>
<a class="sourceLine" id="cb21-9" title="9">  l&lt;-<span class="kw">mean</span>(x)<span class="op">+</span><span class="kw">sqrt</span>(<span class="kw">var</span>(x)<span class="op">/</span>n)<span class="op">*</span><span class="kw">qt</span>(alpha<span class="op">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)</a>
<a class="sourceLine" id="cb21-10" title="10">  <span class="cf">if</span>(<span class="dv">2</span><span class="op">&lt;=</span>u<span class="op">&amp;&amp;</span><span class="dv">2</span><span class="op">&gt;=</span>l) c[i]=<span class="dv">1</span></a>
<a class="sourceLine" id="cb21-11" title="11">}</a>
<a class="sourceLine" id="cb21-12" title="12"><span class="kw">cat</span>(<span class="st">&quot;coverage probability(t-interval)=&quot;</span>,<span class="kw">sum</span>(c)<span class="op">/</span>m)</a></code></pre></div>
<pre><code>## coverage probability(t-interval)= 0.908</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"><span class="co">#The example using Chi-square interval</span></a>
<a class="sourceLine" id="cb23-2" title="2">n &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb23-3" title="3">alpha &lt;-<span class="st"> </span><span class="fl">.05</span></a>
<a class="sourceLine" id="cb23-4" title="4">UCL &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">1000</span>, <span class="dt">expr =</span> {</a>
<a class="sourceLine" id="cb23-5" title="5">x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n, <span class="dt">df =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb23-6" title="6">(n<span class="dv">-1</span>) <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(x) <span class="op">/</span><span class="st"> </span><span class="kw">qchisq</span>(alpha, <span class="dt">df =</span> n<span class="dv">-1</span>)</a>
<a class="sourceLine" id="cb23-7" title="7">} )</a>
<a class="sourceLine" id="cb23-8" title="8"><span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">coverage probability(Chi-square interval)=&quot;</span>,<span class="kw">mean</span>(UCL <span class="op">&gt;</span><span class="st"> </span><span class="dv">4</span>))</a></code></pre></div>
<pre><code>## 
## coverage probability(Chi-square interval)= 0.812</code></pre>
</div>
<div id="section-11" class="section level4">
<h4>6.6</h4>
<p>To estimate the 0.025, 0.05, 0.95, and 0.975 quantiles of the skewness under normality by a Monte Carlo experiment, I first produced n samples from standard normal distribution, which could produce one estimation of skewness. Then repeated the procedure for m times, and I got m skewness’ estimators where I could compute the required quantiles’ estimators.</p>
<p>To get the s.e of these estimators, I first computed the density of each quantile using the normal approximation for the density.After that, I computed the variance of these quantiles by the formula(2.14), and finally got the standard error of each quantile.</p>
<p>To Compare the estimated quantiles with the quantiles of the large sample approximation, I have produced m values from <span class="math inline">\(N(0,6/n)\)</span>, and then their quantiles were the quantiles of the large sample approximation.</p>
<p>The s.e of the estimated quantiles, estimated quantiles, and the quantile of the large sample approximation can be seen at the end of R code below. By comparison, we can find the estimated quantiles differ from the one from normal. With some more trial, I found that when the n increased, the difference between them decrease. Therefore, I guess the difference maight mainly caused by sample size n.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"><span class="kw">library</span>(moments)</a>
<a class="sourceLine" id="cb25-2" title="2">m&lt;-<span class="dv">1000</span></a>
<a class="sourceLine" id="cb25-3" title="3">n&lt;-<span class="dv">1000</span></a>
<a class="sourceLine" id="cb25-4" title="4">p&lt;-<span class="kw">c</span>(<span class="fl">0.025</span>, <span class="fl">0.05</span>, <span class="fl">0.95</span>, <span class="fl">0.975</span>)</a>
<a class="sourceLine" id="cb25-5" title="5">sk&lt;-<span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb25-6" title="6"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb25-7" title="7">  x&lt;-<span class="kw">rnorm</span>(n)</a>
<a class="sourceLine" id="cb25-8" title="8">  sk[i]&lt;-<span class="kw">skewness</span>(x)</a>
<a class="sourceLine" id="cb25-9" title="9">}</a>
<a class="sourceLine" id="cb25-10" title="10">q&lt;-<span class="kw">quantile</span>(sk,<span class="dt">probs =</span>p)<span class="co">#quantiles of the estimator</span></a>
<a class="sourceLine" id="cb25-11" title="11"></a>
<a class="sourceLine" id="cb25-12" title="12"><span class="co">#to compute the s.e of the estimator&#39;s quantiles</span></a>
<a class="sourceLine" id="cb25-13" title="13">var.q&lt;-p<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p)<span class="op">/</span>(n<span class="op">*</span><span class="kw">dnorm</span>(q,<span class="dv">0</span>,<span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">/</span>n))<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb25-14" title="14">se.q&lt;-<span class="kw">sqrt</span>(var.q<span class="op">/</span>m)</a>
<a class="sourceLine" id="cb25-15" title="15"></a>
<a class="sourceLine" id="cb25-16" title="16">sk.n&lt;-<span class="kw">rnorm</span>(m,<span class="dv">0</span>,<span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">/</span>n))</a>
<a class="sourceLine" id="cb25-17" title="17">q.n&lt;-<span class="kw">quantile</span>(sk.n,<span class="dt">probs =</span>p)<span class="co">#the quantiles of the large sample approximation </span></a>
<a class="sourceLine" id="cb25-18" title="18"></a>
<a class="sourceLine" id="cb25-19" title="19"><span class="kw">print</span>(<span class="st">&#39;s.e of esimators:&#39;</span>);se.q</a>
<a class="sourceLine" id="cb25-20" title="20"><span class="kw">print</span>(<span class="st">&#39;estimated quantiles:&#39;</span>);q</a>
<a class="sourceLine" id="cb25-21" title="21"><span class="kw">print</span>(<span class="st">&#39;quantiles of the large sample approximation:&#39;</span>);q.n</a></code></pre></div>
<pre><code>## [1] &quot;s.e of esimators:&quot;
##         2.5%           5%          95%        97.5% 
## 0.0001942355 0.0001662685 0.0001908729 0.0002043681 
## [1] &quot;estimated quantiles:&quot;
##       2.5%         5%        95%      97.5% 
## -0.1492973 -0.1281446  0.1344511  0.1513271 
## [1] &quot;quantiles of the large sample approximation:&quot;
##       2.5%         5%        95%      97.5% 
## -0.1440712 -0.1240718  0.1322356  0.1460294</code></pre>
</div>
</div>
<div id="section-12" class="section level3">
<h3>2019.11.1</h3>
<div id="question" class="section level4">
<h4>Question</h4>
<div id="section-13" class="section level6">
<h6>6.7</h6>
<p>Estimate the power of the skewness test of normality against symmetric <span class="math inline">\(Beta(α, α)\)</span> distributions and comment on the results. Are the results different for heavy-tailed symmetric alternatives such as t(ν)?</p>
</div>
<div id="a" class="section level5">
<h5>6A</h5>
<p>Use Monte Carlo simulation to investigate whether the empirical Type I error rate of the t-test is approximately equal to the nominal significance level <span class="math inline">\(α\)</span>, when the sampled population is non-normal. The t-test is robust to mild departures from normality. Discuss the simulation results for the cases where the sampled population is (i) <span class="math inline">\(χ2(1)\)</span>, (ii) Uniform(0,2), and (iii) Exponential(rate=1). In each case, test <span class="math inline">\(H_0 : µ = µ_0 \  vs \ H_0 : µ = µ_0\)</span>, where <span class="math inline">\(µ_0\)</span> is the mean of <span class="math inline">\(χ2(1)\)</span>, Uniform(0,2), and Exponential(1), respectively.</p>
</div>
<div id="slide-discussion" class="section level5">
<h5>Slide Discussion</h5>
<p>If we obtain the powers for two methods under a particular simulation setting with 10000 experiments:say, 0.651 for one method and 0.676 for another method. Can we say the powers are different at 0.05 level?<br />
(1)What is the corresponding hypothesis test problem?<br />
(2)What test should we use? Z-test, two-sample t-test, paired-t test or McNemar test?<br />
(3)What information is needed to test your hypothesis?</p>
</div>
</div>
<div id="answer" class="section level4">
<h4>Answer</h4>
<div id="section-14" class="section level5">
<h5>6.7</h5>
<p>This question is to estimate the power of the skewness test of normality against symmetric <span class="math inline">\(Beta(α, α)\)</span> distributions. There are two ways to estimate the power.One is to use samples from unsymmetric beta distribution(by set the shape parameter), and the other is to use samples from a comtaminated beta distribution(which is also unsymmetric).I have computed the power using this two kind of samples below.</p>
<p>By plot 1, we can find when <span class="math inline">\(\beta\)</span> is away from 5, which means the beta distribution is not symmetric and skwness is away from 0, the power of the test is larger.<br />
From plot 2, we can find when <span class="math inline">\(\epsilon\)</span> is 0 or 1, which means the distribution is a unc0ntaminated beta distribution, the power equals 0.when <span class="math inline">\(\epsilon\)</span> is about 0.9, the power reach its peak.<br />
Compare plot 2 and 3, which both are sample from contaminated distribution, we can find that the power has changed under different contaminated distribution. In plot 3, when <span class="math inline">\(\epsilon\)</span> equals 0, the power is still large. Besides, the power gradually decreased as $$ becomes larger.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb27-2" title="2">sk &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb27-3" title="3">  <span class="co">#computes the sample skewness coeff.</span></a>
<a class="sourceLine" id="cb27-4" title="4">  xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb27-5" title="5">  m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb27-6" title="6">  m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb27-7" title="7">  <span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )</a>
<a class="sourceLine" id="cb27-8" title="8">}</a>
<a class="sourceLine" id="cb27-9" title="9">alpha &lt;-<span class="st"> </span><span class="fl">.1</span></a>
<a class="sourceLine" id="cb27-10" title="10">n &lt;-<span class="st"> </span><span class="dv">30</span></a>
<a class="sourceLine" id="cb27-11" title="11">m &lt;-<span class="st"> </span><span class="dv">2500</span></a>
<a class="sourceLine" id="cb27-12" title="12">epsilon &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>, <span class="fl">.01</span>)</a>
<a class="sourceLine" id="cb27-13" title="13">N &lt;-<span class="st"> </span><span class="kw">length</span>(epsilon)</a>
<a class="sourceLine" id="cb27-14" title="14"><span class="kw">par</span>(<span class="dt">cex=</span><span class="fl">0.7</span>,<span class="dt">cex.lab=</span><span class="fl">1.5</span>,<span class="dt">cex.axis=</span><span class="dv">1</span>,<span class="dt">cex.main=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb27-15" title="15">cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>) <span class="op">/</span><span class="st"> </span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))<span class="co">#critical value for the skewness test</span></a>
<a class="sourceLine" id="cb27-16" title="16"></a>
<a class="sourceLine" id="cb27-17" title="17"><span class="co"># against beta distribution</span></a>
<a class="sourceLine" id="cb27-18" title="18">a&lt;-<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">5</span>,<span class="fl">0.05</span>)</a>
<a class="sourceLine" id="cb27-19" title="19">pw&lt;-<span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb27-20" title="20"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) { <span class="co">#for each a</span></a>
<a class="sourceLine" id="cb27-21" title="21">  sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb27-22" title="22">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { <span class="co">#for each replicate</span></a>
<a class="sourceLine" id="cb27-23" title="23">    x &lt;-<span class="st"> </span><span class="kw">rbeta</span>(n,a[j],<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb27-24" title="24">    sktests[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv)</a>
<a class="sourceLine" id="cb27-25" title="25">  }</a>
<a class="sourceLine" id="cb27-26" title="26">  pw[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)</a>
<a class="sourceLine" id="cb27-27" title="27">}</a>
<a class="sourceLine" id="cb27-28" title="28"><span class="kw">plot</span>(a, pw, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,<span class="dt">xlab =</span> <span class="kw">bquote</span>(a), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">main=</span><span class="st">&#39;against beta distribution&#39;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1"><span class="co">#contaminated beta distribution</span></a>
<a class="sourceLine" id="cb28-2" title="2">pw.b&lt;-<span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb28-3" title="3"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) { <span class="co">#for each epsilon</span></a>
<a class="sourceLine" id="cb28-4" title="4">  e &lt;-<span class="st"> </span>epsilon[j]</a>
<a class="sourceLine" id="cb28-5" title="5">  sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb28-6" title="6">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { <span class="co">#for each replicate</span></a>
<a class="sourceLine" id="cb28-7" title="7">    s &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">1000</span>), <span class="dt">replace =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb28-8" title="8">                  <span class="dt">size =</span> n, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>e, e))</a>
<a class="sourceLine" id="cb28-9" title="9">    x &lt;-<span class="st"> </span><span class="kw">rbeta</span>(n,s,s)</a>
<a class="sourceLine" id="cb28-10" title="10">    sktests[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv)</a>
<a class="sourceLine" id="cb28-11" title="11">  }</a>
<a class="sourceLine" id="cb28-12" title="12">  pw.b[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)</a>
<a class="sourceLine" id="cb28-13" title="13">}</a>
<a class="sourceLine" id="cb28-14" title="14"><span class="kw">plot</span>(epsilon, pw.b, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,</a>
<a class="sourceLine" id="cb28-15" title="15">     <span class="dt">xlab =</span> <span class="kw">bquote</span>(epsilon), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">main =</span> <span class="st">&#39;against contaminated beta distribution&#39;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1"><span class="co">#against t(v) </span></a>
<a class="sourceLine" id="cb29-2" title="2">pw.t &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb29-3" title="3"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) { <span class="co">#for each epsilon</span></a>
<a class="sourceLine" id="cb29-4" title="4">  e &lt;-<span class="st"> </span>epsilon[j]</a>
<a class="sourceLine" id="cb29-5" title="5">  sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb29-6" title="6">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { <span class="co">#for each replicate</span></a>
<a class="sourceLine" id="cb29-7" title="7">    d.f &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">5</span>), <span class="dt">replace =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb29-8" title="8">                  <span class="dt">size =</span> n, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>e, e))</a>
<a class="sourceLine" id="cb29-9" title="9">    x &lt;-<span class="st"> </span><span class="kw">rt</span>(n,d.f)</a>
<a class="sourceLine" id="cb29-10" title="10">    sktests[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv)</a>
<a class="sourceLine" id="cb29-11" title="11">  }</a>
<a class="sourceLine" id="cb29-12" title="12">  pw.t[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)</a>
<a class="sourceLine" id="cb29-13" title="13">}</a>
<a class="sourceLine" id="cb29-14" title="14"><span class="kw">plot</span>(epsilon, pw.t, <span class="dt">type =</span> <span class="st">&#39;p&#39;</span>,<span class="dt">pch=</span><span class="st">&#39;$&#39;</span>,<span class="dt">col=</span><span class="st">&#39;goldenrod&#39;</span>,</a>
<a class="sourceLine" id="cb29-15" title="15">     <span class="dt">xlab =</span> <span class="kw">bquote</span>(epsilon), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">main =</span> <span class="st">&#39;aganist t-distribution&#39;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAACplBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmAGZmOgBmOjpmOpBmZjpmZmZmkJBmkLZmkNtmtttmtv+QOgCQOjqQOmaQZgCQZjqQttuQ27aQ29uQ2/+2ZgC2Zjq2kDq2kGa2tpC225C227a229u22/+2/7a2/9u2///apSDapiDap1faqCDaqCzaqDjaqD7aqFfaqGHaqGfaqHTaqTDaqUzaqiDaqijaqkbaqnTaqofaqyDaqzDaq0baq0jaq0zaq43arFHarIfarJnarTjarTrarWHarWfarYfaryvar0zar1Har3Tar4far5nasCDasCvasD7asJHasKXasjTaslrasqXasrzatHTatJnatT7auVHauVrauaXaubzaxKXaxLzbkDrbkGbbpSDbqCDbqiDbrCDbrSDbry3bsCDbsTPbsjrbtEbbtmbbtpDbuVzbuWfbvIfbxMHbxN7b29vb2//b/7bb/9vb///cpSDcqiDcryDcsiDdqCDdqiDdrSDdtzrduUzepSDeqCDeryDesjDetCDeuUzewGfew5nezd7ezf/fpSDfryXftC3fxGfgpSDgxFzgxGfg097hqSDhrSDhryDhsCDhtSDhuSDisiDitCDiuSDiwD7ksiXkuTDkw0zkxEXkxEzkzWfkzXTk4f/lqCDmqCDnqCDnqiDnwD7nxEznzWfnzXTn05nn4d7n4f/qqiDqqyDqrSDqryDtqyDtryDttCDttSDtuSDvuSDvxCDysiDyuSDyxCD0tSL0uSX0xDD0zT704XT5uSX5wzD5xC35xDD5zT7500z54XT5////tmb/zT7/25D/27b/29v/4Wf/4XT//7b//9v//97///+kvFDYAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAPDElEQVR4nO2di38cRR3AN6VNEARMaSsKbUEeTfFBMQNFhSoIQcSi0Nb2rKTQBo+Ys2Kp2NIS1CD1hU/aWk/QIlKtD0StbXrWkor2WnmUPLgkdpPef+L8Znb3du9297e3j2R37/e9T5u77Oze7PdmfjM7M7lVyoQrynRnIO6QIAQShECCEEgQAglCIEEIJAiBBCGQIAQShECC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" /><!-- --></p>
</div>
<div id="a-1" class="section level5">
<h5>6A</h5>
<p>With MC method, we can find that when samples is from uniform distribution,empirical Type I error rate is close to the nominal 0.05, while that of samples from chisquare and exp(1) are lower than 0.05.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb30-2" title="2">n &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb30-3" title="3">alpha &lt;-<span class="st"> </span><span class="fl">.05</span></a>
<a class="sourceLine" id="cb30-4" title="4">m &lt;-<span class="st"> </span><span class="dv">10000</span> <span class="co">#number of replicates</span></a>
<a class="sourceLine" id="cb30-5" title="5">p &lt;-<span class="st"> </span><span class="kw">numeric</span>(m) <span class="co">#storage for p-values</span></a>
<a class="sourceLine" id="cb30-6" title="6"></a>
<a class="sourceLine" id="cb30-7" title="7"><span class="co">#Chisquare</span></a>
<a class="sourceLine" id="cb30-8" title="8"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb30-9" title="9">  x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb30-10" title="10">  ttest &lt;-<span class="st"> </span><span class="kw">t.test</span>(x, <span class="dt">alternative =</span> <span class="st">&quot;greater&quot;</span>, <span class="dt">mu =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb30-11" title="11">  p[j] &lt;-<span class="st"> </span>ttest<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb30-12" title="12">}</a>
<a class="sourceLine" id="cb30-13" title="13">p.chi &lt;-<span class="st"> </span><span class="kw">mean</span>(p <span class="op">&lt;</span><span class="st"> </span>alpha)</a>
<a class="sourceLine" id="cb30-14" title="14">se.chi &lt;-<span class="st"> </span><span class="kw">sqrt</span>(p.chi <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>p.chi) <span class="op">/</span><span class="st"> </span>m)</a>
<a class="sourceLine" id="cb30-15" title="15"><span class="kw">print</span>(<span class="kw">c</span>(p.chi, se.chi))</a></code></pre></div>
<pre><code>## [1] 0.014300000 0.001187245</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1"><span class="co">#Uniform</span></a>
<a class="sourceLine" id="cb32-2" title="2"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb32-3" title="3">  x &lt;-<span class="st"> </span><span class="kw">runif</span>(n, <span class="dv">0</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb32-4" title="4">  ttest &lt;-<span class="st"> </span><span class="kw">t.test</span>(x, <span class="dt">alternative =</span> <span class="st">&quot;greater&quot;</span>, <span class="dt">mu =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb32-5" title="5">  p[j] &lt;-<span class="st"> </span>ttest<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb32-6" title="6">}</a>
<a class="sourceLine" id="cb32-7" title="7">p.unif &lt;-<span class="st"> </span><span class="kw">mean</span>(p <span class="op">&lt;</span><span class="st"> </span>alpha)</a>
<a class="sourceLine" id="cb32-8" title="8">se.unif &lt;-<span class="st"> </span><span class="kw">sqrt</span>(p.unif <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>p.unif) <span class="op">/</span><span class="st"> </span>m)</a>
<a class="sourceLine" id="cb32-9" title="9"><span class="kw">print</span>(<span class="kw">c</span>(p.unif, se.unif))</a></code></pre></div>
<pre><code>## [1] 0.050100000 0.002181513</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1"><span class="co">#exp</span></a>
<a class="sourceLine" id="cb34-2" title="2"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb34-3" title="3">  x &lt;-<span class="st"> </span><span class="kw">rexp</span>(n, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb34-4" title="4">  ttest &lt;-<span class="st"> </span><span class="kw">t.test</span>(x, <span class="dt">alternative =</span> <span class="st">&quot;greater&quot;</span>, <span class="dt">mu =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb34-5" title="5">  p[j] &lt;-<span class="st"> </span>ttest<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb34-6" title="6">}</a>
<a class="sourceLine" id="cb34-7" title="7">p.exp &lt;-<span class="st"> </span><span class="kw">mean</span>(p <span class="op">&lt;</span><span class="st"> </span>alpha)</a>
<a class="sourceLine" id="cb34-8" title="8">se.exp &lt;-<span class="st"> </span><span class="kw">sqrt</span>(p.exp <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>p.exp) <span class="op">/</span><span class="st"> </span>m)</a>
<a class="sourceLine" id="cb34-9" title="9"><span class="kw">print</span>(<span class="kw">c</span>(p.exp, se.exp))</a></code></pre></div>
<pre><code>## [1] 0.020700000 0.001423781</code></pre>
</div>
<div id="discussion" class="section level5">
<h5>Discussion</h5>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1"><span class="co">#an example</span></a>
<a class="sourceLine" id="cb36-2" title="2">n&lt;-<span class="dv">10000</span></a>
<a class="sourceLine" id="cb36-3" title="3">x&lt;-<span class="kw">rbinom</span>(n,n,<span class="dt">p=</span><span class="fl">0.651</span>)</a>
<a class="sourceLine" id="cb36-4" title="4">y&lt;-<span class="kw">rbinom</span>(n,n,<span class="dt">p=</span><span class="fl">0.676</span>)</a>
<a class="sourceLine" id="cb36-5" title="5"><span class="kw">t.test</span>(x,y,<span class="st">&#39;two.sided&#39;</span>,<span class="dt">mu=</span><span class="dv">0</span>)</a></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  x and y
## t = -371.78, df = 19992, p-value &lt; 2.2e-16
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -251.2362 -248.6010
## sample estimates:
## mean of x mean of y 
##  6509.980  6759.899</code></pre>
<p>(1)The hypothesis test is to test whether the sample means of power given by two methods are equal.that is: <span class="math inline">\(H_0:p_1=p_2\)</span> VS <span class="math inline">\(H_1:p_1\ne p_2\)</span> where <span class="math inline">\(p_i\)</span> is the corresponding power of different method.<br />
(2)McNemar test<br />
(3)The power function is needed</p>
</div>
</div>
</div>
<div id="section-15" class="section level3">
<h3>2019.11.8</h3>
<div id="question-1" class="section level4">
<h4>Question</h4>
<div id="section-16" class="section level6">
<h6>7.6</h6>
<p>Efron and Tibshirani discuss the scor (bootstrap) test score data on 88 students who took examinations in five subjects. The first two tests (mechanics, vectors) were closed book and the last three tests (algebra, analysis, statistics) were open book. Each row of the data frame is a set of scores $ (x_{i1},…x_{i5})$ for the <span class="math inline">\(i^{th}\)</span> student. Use a panel display to display the scatter plots for each pair of test scores. Compare the plot with the sample correlation matrix. Obtain bootstrap estimates of the standard errors for each of the following estimates: <span class="math inline">\(\hat\rho_{12}=\hat\rho(mec,vec),\hat \rho_{34}=\hat\rho(alg,ana), \hat\rho_{35}=\hat\rho(alg,sta), \hat\rho_{45}=\hat\rho(ana,sta)\)</span></p>
</div>
<div id="b" class="section level5">
<h5>7.B</h5>
<p>Repeat Project 7.A for the sample skewness statistic. Compare the coverage rates for normal populations (skewness 0) and <span class="math inline">\(χ^2(5)\)</span> distributions (positive skewness)</p>
</div>
</div>
<div id="answer-1" class="section level4">
<h4>Answer</h4>
<div id="section-17" class="section level5">
<h5>7.6</h5>
<p>Comparing the scatter plot with the sample correlation matrix, we can find the results are same.Both indicate that ala and alg, alg and vec have a relatively strong relation.And there is little relation between sta and mec.<br />
By Boot function, we can get the required bootstrap estimates of s.e:<br />
$ s.e(<em>{12}) = 0.07675172, \ s.e(</em>{34}) = 0.04844542, \ s.e(<em>{35} )= 0.06027028, \s.e(</em>{45}) = 0.06668117$.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb38-2" title="2"><span class="kw">library</span>(bootstrap)</a>
<a class="sourceLine" id="cb38-3" title="3"><span class="kw">library</span>(lattice)</a>
<a class="sourceLine" id="cb38-4" title="4"><span class="kw">splom</span>(scor)</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAACslBMVEUAAAAAAAMAAAgAAAoAAAsAAA0AAA4AABAAABEAABcAAB0AACEAACQAACgAACoAADoAAEkAAGYABAAAFwAAITIAKAAAKBAAKpAAOigAOpAAPh0ASUkASYEASbYAWGYAWLYAZmYAZoEAZrYAgP8DAAADABAEAAAEAAQEAAoEACgKAAAKACgKSdsLABcNAAANABANABQNABcNACgNAGYQAAAQAA0RAAARABAUAAAUOjEXAAAXABcXAGYXWFgXZtsYAAAYhv8ZAAAdAAAdADodPgAdkNsdnf8gABggAGYgCzoge9shAAAhIAAhhv8iADokAAAlAAAoAAAoAAQoABcoADooAGYogf8qAAAqAGYqKAAqnf8qvP8xABcxGwA0ADo0trY6AAA6ABc6ABg6ACg6ACo6ADI6ADo6AEk6AGY6DTI6KAA6MZA6OgA6OpA6Sxw6Zlg6ZmY6akU6fHs6hpA6kJw6kLw6kNs6nf86vP9JAABJAA1JABdJAChJADpJPgBJSQBJnWZJtttJtv9J2/9LHA1RfGZRvP9YAABYAAZYKwBYSRdYZjpYtv9ctmZc/7Zc//9mAABmAAZmAApmABFmABdmABhmACBmACFmACpmADpmAGZmFwBmWABmZgBmZmZmgWZmkJBmnJBmoVFmtoFmtrZmtttmtv9mvGZm24Fm2/97fDp82/+BHQCBWACBZgCBtmaB/7aB//+QMQCQOgCQOjqQOmaQZgCQkGaQnWaQvJCQ27aQ2/+cOgCdZgCd25Cd//+2SQC2WAC2ZgC2kDq2nDK2tiy2vDq2vFG222a225C2/4G2/5y2/7a2/9u2///bZhfbfCHbkDrb25Db/7bb/9vb////gSj/nDr/nTr/tkn/tlj/tmb/vFH/20n/22b/23z/25D//4H//5z//7b//9v///9a7YV0AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAgAElEQVR4nO1diZ9dSVUuGcdxZsxkWkSNokhKUVFHEdeIorihuEVhgqjYIIa44G7jqDg4KC6j0u4Gxn1sHVQWg8oYVHhuBEOwwYj6cGzp1P/hrXvrbFWnlvvevckwefVLXr/uOvfUOV+drepuxm1asZlrLcDDvW0AqrQNQJW2AajSNgBV2gagStsAVGkbgCptA1ClbQCqtA1AlbYBqNI2AFXaBqBK2wBUaRuAKm0DUKVtAKq0DUCVtgGo0jYAVdoGoEqrAGSug7YeQPjN9v+SFv5sbfdP4xUf1v/uqTMjE70FYpcljg+zOuvD3T23v3XJLY77f0JnMwKBcrfFj1iwoHH3Q+EVH0Yqq3AyeqLMsE4P68GxKeuDM5fc4dnz3b/+6wagmPrKuT23PHY54DQTQO9bLhZFlyvnzLHLbmaABivBH/gV/5zRwlr4xG/WE+dGFvQWjqsm2yCLyvpwd8fHoLkBCoKQReCs1XlZcIDGkYEWR2uyIBxBj0FXBSAmhYX5sjnigcqREwYfKI0M9NYykKpi8qNSC7oaQRrUIldhWBVUtmRoFgzDFkYGS0BvaQIogB/gT3z9yrmdudM8qsViCapdAIjlIxtsoug1PEpBBKqLiQPADMTUB9vm6Hkfi0wHU0bFXGvq5skXzQaVKLgYyg36VgFCY7BoETUxyeAAo1Hrp2kBYoZsaaoVXsIPwdoaXIxgZ4xFuREXGzE8SlHQpXmz0/+YyYK4i4XAzMFRXAzKI4rNDNX8yBE+SoJMyrGQ3rEq0Cxo0VWJp89jDFoFgVo3Bmn4blEwDSCMPZY5GSfNjEyVIbhjLEfEhCRiRhcD1Of24UefxXQVM21smrcMGzTphBj1QP9ylMsKI7PaUPpYHiCaBzgkcbGACtZBZRXX7KbaB51NIxY+yavtctXkgDsNExEnLiaD9PBbtNRYHvsHY/auEkA8QFMVmBIjbgwfVv1lR2Y+6RjzUpC2HCON9bKL0Muj5+cGiKvMS/u80yAw6IzlIG15/VCtQcMhAA+njwHqVqrdin5mgMhpRK7XczE7wiKWtgwQw51l7KyYEAl5XnW6BXlkOoA6cK78RZrvp94P4glKBN2YVzAHjKBUTKsjY7GEcGbCG3JnbB1+UakXnYsduafL8YtHH0/y/cQA8YxaKhQFkqK60QGy3HpshDwWrFBsoDNyI8oD5AvFk3u41JD5fkoXEymYgnXOJhgtg0ivpDk8Ekgiti6yXxbSeR2kKeX3pfV8P2GQRmePZi03cTE14KNpEdFq3osh3Mlkx7EH1t3ytEvs3nSOnury/Z7//djl//7g7vudUwME41KBEpk1s2yhlAyjdEQKEFcVGWYAciRCzB1BNd5eusTeRZqDUx/l8/zewtzj3J+ZncWH3vjyaQESpszydYqPMyLpK07D8RHeC6YlCWMxA3sK4Sn/AFBI7B0Ky6PP8m61/PAT97j/+/oPu3zw7U+9c1KAoMSwBJOcMg5Q0GLQWsSrRIeoOFYIFTGtmJwsPgN1Z0UdEoe7Nz/QudpfvrUD6OD0sy/9V+djkwZpVmFQxk6MQgPI4QG62gpAVALFJsSIwXOlCYl82lPvDyd63ttFH3PvzkMeoG825vYfNfcMaX6qM6tYvlEpF5kQgsJdzBKlyPTayHFkCwaiL/2B1KX2KbKF32MFX1rc+qceoPfc8ZNdvr9jT24tThSkLcgUxVKLxaMM0loCo/gTjZwamuV8HbkYQhQVQdbi2nCg3vd7rAjQyT0P0H8eeb07/DWf3cYh0NCN0TWeM8dnWvBSEJKpO07zEnlIWZzYsn880dNKBqn3oSJc3vr0Lg71rtSB9GL30Am/1pgeIOZmEiDuNonKuSCqjayQRmgG83EQELmPiRDkjF9P+NYFmzd30HTWdHCyq4Pe1H1/3OKoXK/OAJAeU5I9CRZsFXzSujuGJ1MoInHkYdzeFoPJsGDTZy31tMZEW67gYjl7ELwgmDumbWwTad3t8pwTF4uRz4a3epsAILJgykyJvo6j6WTmYkFeHxkTgGaYRGzBwXA5BihlioKWtj5ALOdCCYKWrvKSOQbiVAoQKkUapzhy1uR4mLPUQxKlaGk2g4sF+2UpFuOREigG8VnJB7/BxBM1/i4sLgk/xBqdy0WAxsYcK0VLM+W8z9qFInk6qIF2navmZKCiIjPVgtslOW+CDxCLQp5KtBjRWClaminnfdYHiOeuoL5DK0qrOSeml1ucpjNLSqyoUeVwrEQUrptxSNmGpRlfpE6z1GCGT24fpdyUV7wwTwM6uhhizsxNkyP2KjShbMSSyhl2Dd4oBKrdPJY4y80mv2ASmqQxIlATwBa11ygd80ewMObhKaYKQPvmUubE2CRZDGaM4gjKmeUlgq7qNSwC8ZSXFZOCOUuL2jEpQPtHTe7U6hT7QYNgcnptfuIYjZpkiJolslz+SuSgycLfNdZCoG5p1n2fK0jTb1KuRLKUF81vLjFZpFSJEjlSZrmcx376pZn/Pkuaz7Q2gLKkCXWGKCGu0Elq+JkuzbJyVMQc0V1w/QbSlDobfiLiMp2kNsrfanJM191WfmRIFepc+ImJi3SS+moAdB209QAqdVKV08QLSpZwSJmaKuqePENs+A/6pcIaRSixjoZYpRvrIKhHqnKF8mnQvYw9VEbhsAkBonkahJkRIEsA9RNeBwgL7BqcVhZGNuMPqwME01STuhUgioxsE4f2MAacslkMSnGxgKoARAv3KV2MWSYIMwlAFGmw8OPL9TJAliyH1gk5alqKIjgFfxwDkAWrITkmczEbfbABaF0k54KZnCNCWrDnbp5CIrChYciYOFwaboYtwhpAKCEuVNgaaA6ApBa4K8OLFUpubF+Iz5w6srB9vnqNicOl4WZYO1QAEvub0oBqyWKMi1m0HkgDwmUEL7YgsLLRIlcFSJC7LHH50vBkFSPxtlLyqYI0m9hU65hX4o4CoszIzMjYaIFYZrHypeGSNWfr5MeUdRCyTDVWAFJjeZ4aD8kwTojLl4bzmZLT6SQ4xdybETPXbVUFLEaUmJfN2A/tIqWL1Zje5QEqXhoupI53f6kWmxggGw9GI+acRrEetiWvrOZzWCoWVLo0nAJDHNVYNsMibqpKmmwzHjCvcgpOHiAV/pyYdGl4MUjzpIWQUzZzEwZpGClxAqZxugVmlWMyLqZxzwPUXxrO7kLVpIZCJ4IHi7LxCGS60VtjL3CpFvy3xNoGYl2w0CeRz7tYXyjuucxdqD01lmdyMgM0+fiv8Sp2W5gL3XwEMddfP0AXLEIHoWTEbZs3xFpNKsx2JgMI4Q68swYBvHDNVrYfWTWJEpfUKYrZBx9+OcKyR3DH/41kZgsjqvwzcqwFkDLHgww5gDIhXRnZyhzpOPuCmAuPTByEhsBkkGskBWI2AoFaN7qY0Bp/COLYxYQ5xOQcoNg+pQqqmO+++Vn9Nb5bF1ga85dxdKkNgrSWIGzMaKIgnViRS9VIg3Rs4PrIygom1iMR88qr/CX0b7n90uLxrBDaHx7yEpbYonBWZWhDoK2bbJ4NXOSFPqX5TBSk+08BZ8SaBRx/lmvvHR/y/Cd8664x32huee59xgzX9voHBRFAA09LKcYlMoxCINsdmAremsZJZUOaQ5FYHhmxUaYZ2hBz9j/oK/7ulDn64Okvuu1v7jKPC5dFR7kOMzq3/5UQKHdTjpfaVwCCbsvKez0Gudgb0jjRW9BQN1/0HnXwtZ/87hue8KUHL/jMp97/qx//I/4aO29C+z5egwXR/FgmxCoIlLvR+sFdHCWdLC82Z5ShXBYgi4hrhtkTn+FXryyDofz+Cz771P2//qQH/B88QAt/jXgI0jQ2MVdC9DQAUfXAzKkQ7jDrOVzsp+LJ3SMWSzU1GED7xmz9+Ymf7/D5soPTT+t+3ND94cL2XghBDtM8yOpwRnXWNQRq3WA9IqQUwx2rnSxkjjQAZABSUzED6MHt/iIE37Yu/uYJ//PFwcVgn3E3pHmoe3jknylIW7IiiqVZC+JUKFwpvcoiVPUDBOiNPpEtzZ0HL/isLz7/lvc/dfdH3PCy/p7CmDWiDVM0k4sxZR1YD8xOjpdwRMwihZFlRafJgUH6AlmQ+YX/eaLZ+ucnPMf/gd+iArmXl3CZJD8JQBx+Ps2lIO0cGZGSwpKRIaYWAArrin1/c8ri6IPb5jnu4JTZW9ww/OG8TPMs9hBMqyJQ7gZcKBrVgjQqLfymXBQI6FM50ntRDr5t69LBC+8yt78kfdoEBR5RY8wHEFoAGxE3FPK8eAhKi+OY0iFtm5j8yX8JNXoUmr9umlMF6Wg8DNciWKeLB+aOir2xvwGnbJBWZONP/lOk5m6FMZRkK7Ie1U0RCEFhCZ9brlx+opCZ+CjucC2Zmiam39Y4eNHlwlO3LJWqtCJjso1AoNyNKYC0GVRCrFKAsCRjfqhHrPBXtJ6Mh6Vi+nIxd4sc31F0iFLykWNdGTnuxtiMTLFahICd8GKSYImjj8zMnqLqeDGBChoNy2YVDWhagJT4D8i4bJDGmoCXTTFrYesWIulKqUalJpZC0qldTKtAWcrnPXGQxtpGi9HR9pqj+mEFMXVqEsKJLxMHaXVxhP7D++INMxArB1DCFJe2KrHhh5k+e5nysyN58ElcKy/H6G5F5lEAqQs3fcNMHcxpAB3udsiYyrMjrZ0foIzNV1wMaYSVpyNL7mUXkwCZ7/MWVKiDIEHm0ntO6pHdObYYpEu8aAGXGTnmnqt2FYD62+NMoZJmJUT0JWVdaI2L1aaWAlQ62lT6E9ZaDJIA0WK1nfN1BRBRXz2Asi7WxKt0dC5BZonHANTOeV2AroM2J35yphqruXBIjtpon82FYs+8lbqFeE2AhK+3yQWHzALQwLx9purE1xCgjIU/sgDauFiRf1QEVnhFFdsMAMFSpYm6kXiNbpFJ60PFVXVEjdeHmeT+lFaAcKHSQg2LxPkAEkuNurEGckJVoe6vDzPJ/SmNABHzktQk8NwuFsyBNjUqt8g5pM/N3HB9WCgB2fDNAMGuWJ6aL13DZt5cAMGGZliv22I+gO1Z3KZ16UvA8Pqw0c9VpzMIVseeb7w6hzvfw/+ZAJLqVoxV7N3DHk1CDdeHjQXIOtiqDfu7MTVb2Q/S4Jb1HADhdNFJrCBhlhfsFLITjhpA/cbOeIDQ1eGsSMya12qAzHCAQpy0xm6Woi24L7UwssaLn+6iL6q9wfVhYwHCAfDcmgoQyY1ONl2QxhQdXJeuM8BNwNSyQS42ZfyQhBquDxv5fhlSOOc1FAAtn9oJ03yUotGFCacML+vE5KJpa9R4fdiYNxSBDISP4mKEnOUI1WuC5m5hPU4Ow86FagHLJggBeZzF6Pqw9ndcCUEwOUnqYPMh2dpZAMIYGwcfobHghX7XRF1tOnEaDWOv4ZMJ8HHKZgRq3ZSz2gCyNHPxFGeWGm54XmZ/KyHaUHj3Xn97SoJOHnxDNFZYDXkZ5Z21AQJboBHYNwrSPTEv5HUFkDgZuYfnXbt/dM7cfilEIXpJs2KcFICyMyVjAT/9zxaG6wKEdY7V5JEq80Kez5yMWJmRl8e7NHa4e/fjz953XN72DbenOORts1MgAXLSdoCEYtL6aZ6WUDWLCLwCQrmAhSVbMvLih99wvgPomQ+euTBcTs9f0myAq2OzoswYB0iVlk9TpmAdD1AyB5q+EiBWlmmi9dQii/k7VJ753ebI9lMunHmNMTf+dH/zhb/zkqhwTRHYJGKJuKtOEFNmIoAck0VzMY6QvF8sO3tAvc0eYbw4fnj2W3oknnzhpDG3/1h4MSq8pNk4KvZykxXkCUplTZ6n5EkqaQJeqo1Zk6NJ9qOKxvBxhj3C2F+PefrB7ce+8m0nn/wvT3zs2ftuu4+91QAAYmuEzHSxIF2AMGjkpgrShEU6rGMas+yqGjhVlAN19AjjpTGf/3l/cvLJ/2TMzX/w6a9lAMHtKQydyL0wPHGA0iISIzM39bUBYvk0UdtJlQmfnHFLanqEsb/k8B/Nl9z8xye+5ufMR596zJE3DvXPDkvzCLLAhrhLnTUyMhtuyWsChEu9TGbKAJR4mZNg9tT78AjjB7f3lltv/RxjPvDU3Tfc8nXmluf2ALGXNAe+iU2Qv3CdLbN7qm5dPEfTAMSGYnajqS1dLG9pQE1vl/F3qPhbDJ71tpMvPWG2Lv7W6VfLt19gmhfQwJ4Oy9pAnYCoTtI0ADkuERsvuLIVlu1Ak0TGhDV7u0x/j9PPmB8487aTP3j6aR1AzzMBIFkMSLux5EguBogcksk+G0AgGYY+yKJO5DF1l4FST8yav2+wM5/bvutvb316B9ALX3KfMUdeK5f00eIBrRqESgoyi5Q8D8/jYriMH77zf1K0aJdBGlzKGt8uM6y8Fr+7deHMhRe988xrjh/e9bhlDiBpwOhccTBERCgIRSiOQaDWzSYjSMLlUxMmFmI2g8/gPOzVlcM9YPcc/sYzTpojr9uVryjS1ucOQlBqnAAKCJePhBMBhLaaUmQSJkQhzbmyI/cF0eIjB+QyxIGdxe+5sIIW71zOiHNyjO/mq7tGXlGV3TTymDcUEf9sWCHrztDl5Fih2wpfauKlRsT2kYEqexkYRp88azKagvTTAOR0/yryqhwwwZZrbpAcnKvI0bTUaGyj5Eqpy28oGiEHrsWaidfobvCsAq/S0TF1+Q1FY+TABVIr8brdK89FKTYGavpcHjP98t5kX34xYqaKI2tyrNV9dQDyn355b7KvT3lYApSpfmq8qFqpuJj89Mt7o95dAJyahMFKeqTUK3W35PeEFythK9Tis1/eZyyIr3RaBGkqTKTUq3WvYqxNxygA9cv7vIs1MuYO2YjmOt1XDyD/hqsumeWD9MMToJUSZssxMUAHp8P30huK2l2sWfBJdhTb2qiyOwEI3lBkimux1iDdTLsuQNdBmxM/bHYcL1OnliGkTQ44plHqgXxugNi2y0wA2WaVYXuoGSC/4zAzQJZUGTFUA0CC8ziVx9j9VbtfzNdlFa8eCZBjJ7Kab3AaNokeNhaEpw7GzkUVIItcRwCEZwlUapHT2BmRGQEK6LRO8wiA4vM6TU5DZxM1akshCn6ZBSBYhbLzdq3T3AYQnWzk51Gqlkxnx3ULgvN4lsW2OVyM5gFVGJQYEUmLIzNF+Imaqj8iqk6fKTz7hOerxweGhm6APoRlduJ3RHYtjYxnQqMTWUV/FC2jMzu3ah1ZUV3qFQHC//x80xQAEVdxoi/P2kb4SJ1xKjGq0b82qVdwsbTleIW3gJUf8iP5R/gUXQwTHXcxEaQhTMrz4PjLKgjUuhVw8kOFt4C1336B6qKRhokuEbtIHopBwY0sx51iaIF1RUylGzNugpDLT3P5LWD5SCp0ya5ibKK7BpDkR7UDpJaJAILoHwmDXh2Io0q6/BawKkD5Zd6gpGNeIyxabI7E4mIOsxMChKaqBaB8JC2/BSyO/yl3yjYy7EKtoYnDg3SCjbVwDca0LkYpUglBrIJPACq+BSw2CpVx5L0og4sNR0wWTmvqfwFZqk+m2FHUcin7ngcI3gL29i6bfWWczQR14imkLVfZWnIr/aCBGq1PZYqxfxqAKKjpWuQBwreA3XfsnaefGWczCZCiTGKcIhKSVC4RxkDBnPJ05GRTuZiompVAnQcI3wJ25LwHJspmkQWlbGPjBJ/DAik7W4PdE2nKFBeQ07gYt06ASUFILRT3nHvoRO9aUSyKAcqqy+SgzO70ueIAieKQqcAqNxbR1wCIpte5dES5YAqXsPzvMzwk/lqN/S7rf6/PZvca/1qVDECaqhwfcDGup5b2yCisztdxF51msQqZEZjHCDnnCCC8hOXRx33AOXbZXwvdgbbj3nHjyw9eeNdODFAAIdE1wsfhLRFxja0eYWhGWX63zOhYoF4TIAprqsFCUgi8Qt46PPvqrQtnLu7uHPYXq/7H0b8/3P2q+J2W4AdCTRuJL+VwIqhgdGRzhayxKHSCKR2O0WiCGETox7HR8XkLvPo7VC7u3n/2jUfPL/vr5d9zxz0H298Zv9MS/CBCiCkUiyksQWofA2SdpMR+DtBk+0E8stlYpCSLDXeoLB7fJffL8BKeLzh4Hr7Tki1IEKDIdx3LwpEcHMao0OHUVswkdwCM7gGudQFCKTDNMjfWtAh3qCxv//HtIR65IZvd6aILfIWLiQBsE3wcuz6IDS4AkoLE9sisXYSF9bMYhFGaMie9TvKCO1QOd7+hA8MH7b4dRlfOOxGkU00izmATARKep1N4IDCAgAx0RHkMAtVukT/AbhIVBuJ9vEPlLcYXzT1e/q0p/suVc8cj1kHLTCiJidGswJaZoShSYw9zAJdyn6KSZikA452iiHF+e8y3LtS8ebibwNdBPWj7fR2kjYzxUjVLTsx7KFKjcYhsISIBSe8Sydd2MZSDJVllInpiuIQl8wbdmLWwB9BERYjv8MiDMI+ysEUWRMGcwkMc3mpiNmgBcQFl0ky1yiumJo8JPssCXY418zJuzY6XDHwtxqzGIgcltRTErHWz6sdRRpsCIOdIW9ARokaGNY+z5OlWdomFiahRYroWqZtcDPlTcGzjVb67gCRF8HPcY4CYzuh00sW4eQmfndrFBEPMtG28xt1dgJEkG6RJGC0jySDNY06OTpdaH7nQLXJHxnh0Xrg00y9cjZEoME+DdIMgeVsvSr1ed8Z48rzo4QFAlb+KKM88JW4TpESVZT1hdwMxPjwgc234Gqynob4WALGjzNalzHmfRwxADVYa8yKm++Z87sxhbmR1vIKYpbKywrXGuqm7Jc7FvPDL/pb/mgvSatPHy4tZqJqqXCusm7q1fFrlBV+6pVn/VU/zKo/MeFkxVfo0tehcy6zbutcCqLg0e4QAtJ6Llfg/QlxszSA9HqD3tSB9HbRpABp+hQcbsrsCDaMt8xoarB+rxYpYgzdWNmFboLUO6lez0xaK3brcP3h+dYBwMVo7HyV3cdpU7oG3Y+B0E19IDg82XBkgthSvA8S2hpqNs/9oBahFjnHd8GDDNQFqdDG2W9EGEAB67SwIHmzIbrxdwcUap5nvVrS62OC+1y4GwYMN2Y23IwBCF6iOLLbmG8TEwJaxt1ySb5iokd3hwYbsxtt2gKKTgqXShqhcm7lZckmFmnqRYTPr1brVSlAHyHJrwE3ihLXctrTMvaKApRqDOB+lvXgEpgcZ0hmga7EfxIVjF+TgeS+X5GJ+NYHDk6IYpEMkxfNcyii4SU+JiSFC5wPYSbQZsthoYjopCCJaDSC6GMWhqgEhpoUFJNJRgFjAiSGeTkhahKu1HrsKAPGT6OxMn4nIcHIjQvQD0iweRHCHxEQll+McYQpwViZdaozlhbGBbALljFzMMTMjKjALDlBkQZyvDhANS3MFX2cK0o3ELKCAkLni2JKXcTwFMSoXjcEttP+TdDEuBdglcF8bgbUB4tBwB0uoOUXsEUDMoiz8HrtXj4ahiG/hkgK8dIRdYVQrN9bvrhFLjyGzUKijOKUCBHTyEI7twN+w8MzQjmLcwwCgVGNWr0UuplC72NwAXcurAXkEi1hkPBxxi2Y3l4v1izB5OQLU1zE+UYhGo1ABUuAhOHma56aTmhBQQwzWYGQ10wwALTwy4jwFvGEmjSpay7BWsIzQpLjCmCshiG0Uq+NDBFoZgXL3u2/8pNe7924bc/TZYEK4xo/0VTXOupimigYQmoCS4AEg5oscGBJqHQTK3VdeZY683l+huXjMbXCuFDdiub4uRUiWeUkMitQR9Y6opKmSidmTBWlRLcxaVGmuCVCINQfb9+8as+MviHrUx73i8Ge70vEDnvQAXJoJG7FCXV2RnAVFActF9SAEaWZFkWVw3kitgYTyTQMQtO3+zp2tf/2OnzI3veLfHvWxxx/6jEe9vL+493D3h5JyO5tkmHUnIV2S6tOMAGEmcwpzTk3AEPZTAhS2Dg+2d/qPN33u95ibfmn30z7hZYe//H7fFC4Px41Ypm2cXrhWmZF1Q4uIqdxmy5MYUwSI2yTCpBrnygCFzeeDbf+S2O0/PNlbyq1f3gH0K+YL+79qQVqxHpm205GFOwgkJTHDPA3tgjq2LguVNWSyGQC6++57v/+Om34xeNRXh+vGcSMWlZBzy34y6y5kMZeYULKyxSqQ19CiSOcLNEEB0k1TKEqABgMytz3/U0+Zmz7lgWBBcaEoA0U8w2qQjpV1BT/AaMOWeuxPTqz9xeoLbQg9dGqA9hZ777njE1+3+xM+zR85H92ikgCUOFgFIIFkASCHBYNIUxpACDuYDW2rTAMQBuk9yPVdu/eWE93nzQ9Et6gkkVRISCppI4MDMpfIion1kJOuGbkY+BGBCIeTr60PUFhSgAX5j6f0Lyoabk0Rt6jwSAqfXGvs0HRmETTFR9nhR3VliENqlq/4FOEhUwXp9NKn5pdfcJRgKnVqomTKt5W7wN5y9rDdQQxD5NGOvmbbHdwoygARJcZ2VwcIjUMtsRAgXJwqxUMv1dUASNu4hrBLASCaPxNTcj3K5oYxxFIQir2XQjKrnSTsA4jXyoKE2mlQiQBCR0i1jVjzWhizXQQpBmlHeIMEjPG1BYibD/ySoSbTYYaRsSC5yMBcRFkcqKM0jy7Owt3VczGNmJaTUQ5WqClCgCnE5IaT8gyOhmHZMQEgwZVXGUh5DYM0Si2rIJWa6cLd0abEFMjBggh5dgzVQYww/E1S1lWcCSARba11icaemlVuzNKsjVVA1izLUfHgkg++ewT+yNlNDJDhvxSPEq9TBxfgYUNS059EPBXOIAbEOI4WR8zFMcGCcH4wDjkXUTYhUOlWAdJvsoxDJmrgkhKEdB6UcU7orQZpshvmXExZGaR5uRDXQPz7PADl777A+edRMrYeombKsWpRIRa9NBNRDU2sRe7UKodUqxW7VYDy9++wNGGdbg6BOklWmWjOickkJU6JILJyVmUauusAAAK/SURBVGFMtFqxWwVIvwNMRhU1NHPWaeWWYCaGjrDmOCWsnfRqnWuk1YrdDQDhUiMylQpAer9ubnlOCr3ywp2cg11dC0oOL0wcVXMt7eH7hrrroK0F0KZtAKq0DUCVtgGo0jYAVdoGoErbAFRpG4AqbQNQpc0A0KE/P60/BG+5N/xP2/CQBn+WFh9OCQe4/qLa4SqApb+ULe6Vh0zcpgdo2T9AcXE0ecr/oEhGmUWv+OHuscucAL4P1/h5Mg7QnLhgmx6gYSNNPnUztCpA/olnOkAf0y+ND1/52+/zAAlk4NoG70B7/TPxfOt09B2d0xye/evgjAGgg+29Xu1l3+8P6P/eMV14H1se+yv/O7E79i7P4WK4UFt5YuzabQ4XQ4SGazx3eqMavgcLGh5UvtO71EAqLWjZPzLmOLOg48semR1PJ9l1f/Bf+svceICaqM0QpP3MDs+8DROKl2ABQEPHcusSTTnEoB4Ur6xwtw6gcCFkRxex2wm+tty6mL7dZP02T5rvgmpvIxQjlsNzhPbw2YrkTn0LWWzQdjiQ9XcAhavVwdI4u2BoC6OEvbXbbHXQYusSPBvYR5ytC8yC4EHlHCD0DgSo+8IAcvvH/Xs6FkMAE+wCQEP6nLpNDhCYjX+pD17juSddbAk1QBEgaUHu4Mzb33C+f2VZzG74uHLud6pPIF6hzZbFWITxb2cJcZdp5VsGIC0Gdf9/rwtDHV3CLgT+Y/9+bvokNksW87r6N0PBNZ7DbJudPqL2qMGDyjMAsSw2qNyj3seYYEGM3R7VV8sZTGiupcbgRKEO2ve/+9raF8ILqIP4M+8jgEIdhJVzD1AfY0IMQnbvAoAW/XNjpw/Tm8VqpW0AqrQNQJW2AajSNgBV2gagStsAVGkbgCptA1ClbQCqtA1AlbYBqNI2AFXaBqBK2wBUaRuAKu3/AYxvfhtyKSTZAAAAAElFTkSuQmCC" /><!-- --></p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1"><span class="kw">cor</span>(scor)</a></code></pre></div>
<pre><code>##           mec       vec       alg       ana       sta
## mec 1.0000000 0.5534052 0.5467511 0.4093920 0.3890993
## vec 0.5534052 1.0000000 0.6096447 0.4850813 0.4364487
## alg 0.5467511 0.6096447 1.0000000 0.7108059 0.6647357
## ana 0.4093920 0.4850813 0.7108059 1.0000000 0.6071743
## sta 0.3890993 0.4364487 0.6647357 0.6071743 1.0000000</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1">x&lt;-<span class="kw">as.matrix</span>(scor)</a>
<a class="sourceLine" id="cb41-2" title="2"></a>
<a class="sourceLine" id="cb41-3" title="3"><span class="kw">library</span>(boot) <span class="co">#for boot function</span></a></code></pre></div>
<pre><code>## 
## 载入程辑包：&#39;boot&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:lattice&#39;:
## 
##     melanoma</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" title="1">rho&lt;-<span class="cf">function</span>(k,l){</a>
<a class="sourceLine" id="cb44-2" title="2">r &lt;-<span class="st"> </span><span class="cf">function</span>(x, i) {</a>
<a class="sourceLine" id="cb44-3" title="3">  <span class="co">#want correlation of columns 1 and 2</span></a>
<a class="sourceLine" id="cb44-4" title="4">  <span class="kw">cor</span>(x[i,k], x[i,l])</a>
<a class="sourceLine" id="cb44-5" title="5">}</a>
<a class="sourceLine" id="cb44-6" title="6">theta &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> scor, <span class="dt">statistic =</span> r, <span class="dt">R =</span> <span class="dv">2000</span>)</a>
<a class="sourceLine" id="cb44-7" title="7"><span class="kw">return</span>(theta)</a>
<a class="sourceLine" id="cb44-8" title="8">}</a>
<a class="sourceLine" id="cb44-9" title="9"><span class="kw">rho</span>(<span class="dv">1</span>,<span class="dv">2</span>)</a></code></pre></div>
<pre><code>## 
## ORDINARY NONPARAMETRIC BOOTSTRAP
## 
## 
## Call:
## boot(data = scor, statistic = r, R = 2000)
## 
## 
## Bootstrap Statistics :
##      original       bias    std. error
## t1* 0.5534052 -0.001524183  0.07675172</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" title="1"><span class="kw">rho</span>(<span class="dv">3</span>,<span class="dv">4</span>)</a></code></pre></div>
<pre><code>## 
## ORDINARY NONPARAMETRIC BOOTSTRAP
## 
## 
## Call:
## boot(data = scor, statistic = r, R = 2000)
## 
## 
## Bootstrap Statistics :
##      original       bias    std. error
## t1* 0.7108059 -0.001676954  0.04844542</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" title="1"><span class="kw">rho</span>(<span class="dv">3</span>,<span class="dv">5</span>)</a></code></pre></div>
<pre><code>## 
## ORDINARY NONPARAMETRIC BOOTSTRAP
## 
## 
## Call:
## boot(data = scor, statistic = r, R = 2000)
## 
## 
## Bootstrap Statistics :
##      original       bias    std. error
## t1* 0.6647357 -0.001619369  0.06027028</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" title="1"><span class="kw">rho</span>(<span class="dv">4</span>,<span class="dv">5</span>)</a></code></pre></div>
<pre><code>## 
## ORDINARY NONPARAMETRIC BOOTSTRAP
## 
## 
## Call:
## boot(data = scor, statistic = r, R = 2000)
## 
## 
## Bootstrap Statistics :
##      original       bias    std. error
## t1* 0.6071743 0.0006308768  0.06668117</code></pre>
</div>
<div id="b-1" class="section level5">
<h5>7.B</h5>
<p>From the results below, we can know that when x is from N(0,1), the coverage probabilities of the standard normal bootstrap confidence interval, the basic bootstrap confidence interval, and the percentile confidence interval are 0.894 , 0.889 and 0.994 respectively.<br />
The correspondingly proportion of times that the confidence intervals miss on the left are 0.057,0.058,0.004.<br />
And the correspondingly porportion of times that the confidence intervals miss on the right are 0.049,0.053 ,0.002.</p>
<p>When x is from <span class="math inline">\(χ^2(5)\)</span>,the coverage probabilities of the standard normal bootstrap confidence interval, the basic bootstrap confidence interval, and the percentile confidence interval are 0.75,0.711, 0.73 respectively.<br />
The correspondingly proportion of times that the confidence intervals miss on the left are 0.245, 0.246 ,0.27.<br />
And the correspondingly porportion of times that the confidence intervals miss on the right are 0.005,0.043,0.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" title="1"><span class="kw">library</span>(boot)</a>
<a class="sourceLine" id="cb52-2" title="2"><span class="kw">library</span>(moments)</a>
<a class="sourceLine" id="cb52-3" title="3"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb52-4" title="4">mu1&lt;-<span class="dv">0</span></a>
<a class="sourceLine" id="cb52-5" title="5">mu2&lt;-(<span class="dv">8</span><span class="op">*</span><span class="kw">gamma</span>(<span class="dv">11</span><span class="op">/</span><span class="dv">2</span>)<span class="op">/</span><span class="kw">gamma</span>(<span class="dv">5</span><span class="op">/</span><span class="dv">2</span>)<span class="op">-</span><span class="dv">3</span><span class="op">*</span><span class="dv">5</span><span class="op">*</span><span class="dv">2</span><span class="op">*</span><span class="dv">5-5</span><span class="op">^</span><span class="dv">3</span> )<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span><span class="dv">5</span>)<span class="op">^</span>(<span class="dv">3</span><span class="op">/</span><span class="dv">2</span>)<span class="co"># compute the skewness of chisquare with freedom 5</span></a>
<a class="sourceLine" id="cb52-6" title="6">n&lt;-<span class="fl">1e1</span></a>
<a class="sourceLine" id="cb52-7" title="7">m&lt;-<span class="fl">1e3</span></a>
<a class="sourceLine" id="cb52-8" title="8">boot.sk &lt;-<span class="st"> </span><span class="cf">function</span>(x,i) <span class="kw">skewness</span>(x[i])</a>
<a class="sourceLine" id="cb52-9" title="9">ci.n&lt;-ci.b&lt;-ci.p&lt;-<span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb52-10" title="10"></a>
<a class="sourceLine" id="cb52-11" title="11"><span class="co">#sample from N(0,1)</span></a>
<a class="sourceLine" id="cb52-12" title="12"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb52-13" title="13">  x&lt;-<span class="kw">rnorm</span>(n)</a>
<a class="sourceLine" id="cb52-14" title="14">  de &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>x,<span class="dt">statistic=</span>boot.sk, <span class="dt">R =</span> <span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb52-15" title="15">  ci &lt;-<span class="st"> </span><span class="kw">boot.ci</span>(de,<span class="dt">type=</span><span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</a>
<a class="sourceLine" id="cb52-16" title="16">  ci.n[i,]&lt;-ci<span class="op">$</span>norm[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>]</a>
<a class="sourceLine" id="cb52-17" title="17">  ci.b[i,]&lt;-ci<span class="op">$</span>basic[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb52-18" title="18">  ci.p[i,]&lt;-ci<span class="op">$</span>percent[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb52-19" title="19">}</a>
<a class="sourceLine" id="cb52-20" title="20"><span class="kw">cat</span>(<span class="st">&#39;norm =&#39;</span>,<span class="kw">mean</span>(ci.n[,<span class="dv">1</span>]<span class="op">&lt;=</span>mu1 <span class="op">&amp;</span><span class="st"> </span>ci.n[,<span class="dv">2</span>]<span class="op">&gt;=</span>mu1),</a>
<a class="sourceLine" id="cb52-21" title="21">    <span class="st">&#39;</span><span class="ch">\n</span><span class="st">basic =&#39;</span>,<span class="kw">mean</span>(ci.b[,<span class="dv">1</span>]<span class="op">&lt;=</span>mu1 <span class="op">&amp;</span><span class="st"> </span>ci.b[,<span class="dv">2</span>]<span class="op">&gt;=</span>mu1),</a>
<a class="sourceLine" id="cb52-22" title="22">    <span class="st">&#39;</span><span class="ch">\n</span><span class="st">perc =&#39;</span>,<span class="kw">mean</span>(ci.p[,<span class="dv">1</span>]<span class="op">&lt;=</span>mu1 <span class="op">&amp;</span><span class="st"> </span>ci.p[,<span class="dv">2</span>]<span class="op">&gt;=</span>mu1))</a></code></pre></div>
<pre><code>## norm = 0.894 
## basic = 0.889 
## perc = 0.994</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" title="1"><span class="kw">cat</span>(<span class="st">&#39;</span><span class="ch">\n</span><span class="st">norm(right) =&#39;</span>,<span class="kw">mean</span>(ci.n[,<span class="dv">2</span>]<span class="op">&lt;=</span>mu1),</a>
<a class="sourceLine" id="cb54-2" title="2">     <span class="st">&#39;</span><span class="ch">\n</span><span class="st">basic(right) =&#39;</span>,<span class="kw">mean</span>(ci.b[,<span class="dv">2</span>]<span class="op">&lt;=</span>mu1 ),</a>
<a class="sourceLine" id="cb54-3" title="3">     <span class="st">&#39;</span><span class="ch">\n</span><span class="st">perc(right) =&#39;</span>,<span class="kw">mean</span>(ci.p[,<span class="dv">2</span>]<span class="op">&lt;=</span>mu1))</a></code></pre></div>
<pre><code>## 
## norm(right) = 0.057 
## basic(right) = 0.058 
## perc(right) = 0.004</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" title="1"><span class="kw">cat</span>(<span class="st">&#39;</span><span class="ch">\n</span><span class="st">norm(left) =&#39;</span>,<span class="kw">mean</span>(ci.n[,<span class="dv">1</span>]<span class="op">&gt;=</span>mu1),</a>
<a class="sourceLine" id="cb56-2" title="2">     <span class="st">&#39;</span><span class="ch">\n</span><span class="st">basic(left) =&#39;</span>,<span class="kw">mean</span>(ci.b[,<span class="dv">1</span>]<span class="op">&gt;=</span>mu1),</a>
<a class="sourceLine" id="cb56-3" title="3">     <span class="st">&#39;</span><span class="ch">\n</span><span class="st">perc(left)=&#39;</span>,<span class="kw">mean</span>( ci.p[,<span class="dv">1</span>]<span class="op">&gt;=</span>mu1))</a></code></pre></div>
<pre><code>## 
## norm(left) = 0.049 
## basic(left) = 0.053 
## perc(left)= 0.002</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" title="1"><span class="co">#sample from chisqare</span></a>
<a class="sourceLine" id="cb58-2" title="2"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb58-3" title="3">  x&lt;-<span class="kw">rchisq</span>(n,<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb58-4" title="4">  de &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>x,<span class="dt">statistic=</span>boot.sk, <span class="dt">R =</span> <span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb58-5" title="5">  ci &lt;-<span class="st"> </span><span class="kw">boot.ci</span>(de,<span class="dt">type=</span><span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</a>
<a class="sourceLine" id="cb58-6" title="6">  ci.n[i,]&lt;-ci<span class="op">$</span>norm[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>]</a>
<a class="sourceLine" id="cb58-7" title="7">  ci.b[i,]&lt;-ci<span class="op">$</span>basic[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb58-8" title="8">  ci.p[i,]&lt;-ci<span class="op">$</span>percent[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb58-9" title="9">}</a>
<a class="sourceLine" id="cb58-10" title="10"><span class="kw">cat</span>(<span class="st">&#39;</span><span class="ch">\n</span><span class="st">norm =&#39;</span>,<span class="kw">mean</span>(ci.n[,<span class="dv">1</span>]<span class="op">&lt;=</span>mu2 <span class="op">&amp;</span><span class="st"> </span>ci.n[,<span class="dv">2</span>]<span class="op">&gt;=</span>mu2),</a>
<a class="sourceLine" id="cb58-11" title="11">    <span class="st">&#39;</span><span class="ch">\n</span><span class="st">basic =&#39;</span>,<span class="kw">mean</span>(ci.b[,<span class="dv">1</span>]<span class="op">&lt;=</span>mu2 <span class="op">&amp;</span><span class="st"> </span>ci.b[,<span class="dv">2</span>]<span class="op">&gt;=</span>mu2),</a>
<a class="sourceLine" id="cb58-12" title="12">    <span class="st">&#39;</span><span class="ch">\n</span><span class="st">perc =&#39;</span>,<span class="kw">mean</span>(ci.p[,<span class="dv">1</span>]<span class="op">&lt;=</span>mu2 <span class="op">&amp;</span><span class="st"> </span>ci.p[,<span class="dv">2</span>]<span class="op">&gt;=</span>mu2))</a></code></pre></div>
<pre><code>## 
## norm = 0.75 
## basic = 0.711 
## perc = 0.73</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" title="1"><span class="kw">cat</span>(<span class="st">&#39;</span><span class="ch">\n</span><span class="st">norm(right) =&#39;</span>,<span class="kw">mean</span>(ci.n[,<span class="dv">2</span>]<span class="op">&lt;=</span>mu2),</a>
<a class="sourceLine" id="cb60-2" title="2">     <span class="st">&#39;</span><span class="ch">\n</span><span class="st">basic(right) =&#39;</span>,<span class="kw">mean</span>(ci.b[,<span class="dv">2</span>]<span class="op">&lt;=</span>mu2 ),</a>
<a class="sourceLine" id="cb60-3" title="3">     <span class="st">&#39;</span><span class="ch">\n</span><span class="st">perc(right) =&#39;</span>,<span class="kw">mean</span>(ci.p[,<span class="dv">2</span>]<span class="op">&lt;=</span>mu2 ))</a></code></pre></div>
<pre><code>## 
## norm(right) = 0.245 
## basic(right) = 0.246 
## perc(right) = 0.27</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" title="1"><span class="kw">cat</span>(<span class="st">&#39;</span><span class="ch">\n</span><span class="st">norm(left) =&#39;</span>,<span class="kw">mean</span>(ci.n[,<span class="dv">1</span>]<span class="op">&gt;=</span>mu2),</a>
<a class="sourceLine" id="cb62-2" title="2">     <span class="st">&#39;</span><span class="ch">\n</span><span class="st">basic(left) =&#39;</span>,<span class="kw">mean</span>(ci.b[,<span class="dv">1</span>]<span class="op">&gt;=</span>mu2),</a>
<a class="sourceLine" id="cb62-3" title="3">     <span class="st">&#39;</span><span class="ch">\n</span><span class="st">perc(left)=&#39;</span>,<span class="kw">mean</span>( ci.p[,<span class="dv">1</span>]<span class="op">&gt;=</span>mu2))</a></code></pre></div>
<pre><code>## 
## norm(left) = 0.005 
## basic(left) = 0.043 
## perc(left)= 0</code></pre>
</div>
</div>
</div>
<div id="section-18" class="section level3">
<h3>2019.11.15</h3>
<div id="question-2" class="section level4">
<h4>Question</h4>
<div id="section-19" class="section level5">
<h5>7.8</h5>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat{θ}\)</span>.</p>
</div>
<div id="section-20" class="section level5">
<h5>7.10</h5>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to select the best fitting model. Repeat the analysis replacing the Log-Log model with a cubic polynomial model. Which of the four models is selected by the cross validation procedure? Which model is selected according to maximum adjusted <span class="math inline">\(R^2\)</span>?</p>
</div>
</div>
<div id="answer-2" class="section level4">
<h4>Answer</h4>
<div id="section-21" class="section level5">
<h5>7.8</h5>
<p>To compute jackknife estimates of bias and standard error of <span class="math inline">\(\hat{θ}\)</span>, I first computed <span class="math inline">\(\hat{θ}\)</span>’s jackknife estimates. And then, with the properties of jackknife estimates: <span class="math display">\[\hat{bias}_{jack} = (n − 1)( \bar{\hat{θ}}(·) − \hat{θ} )\]</span> <span class="math display">\[\hat{se}_{jack} =\sqrt{\frac{n-1}{n}\sum_{i=1}^{n}( \hat{\theta}_{(-i)}-\bar{\hat{θ}}(·) )^2}\]</span> where <span class="math inline">\(\hat{\theta}_{(-i)}\)</span> is the estimate with <span class="math inline">\(i^{th}\)</span> observation left out, and <span class="math inline">\(\bar{\hat{θ}}(·)\)</span> is the mean of all jackknife estimates.<br />
I could compute the bias and s.e of jackknife estimate.The code and result is showed below.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" title="1"><span class="kw">library</span>(bootstrap)</a>
<a class="sourceLine" id="cb64-2" title="2"><span class="kw">data</span>(scor)</a>
<a class="sourceLine" id="cb64-3" title="3">n&lt;-<span class="kw">nrow</span>(scor)</a>
<a class="sourceLine" id="cb64-4" title="4">c&lt;-<span class="kw">cov</span>(scor)</a>
<a class="sourceLine" id="cb64-5" title="5">lambda&lt;-<span class="kw">eigen</span>(c)<span class="op">$</span>values</a>
<a class="sourceLine" id="cb64-6" title="6">theta.hat&lt;-lambda[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(lambda)</a>
<a class="sourceLine" id="cb64-7" title="7"></a>
<a class="sourceLine" id="cb64-8" title="8"><span class="co"># to compute jackknife estimates</span></a>
<a class="sourceLine" id="cb64-9" title="9">theta.j&lt;-<span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb64-10" title="10"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</a>
<a class="sourceLine" id="cb64-11" title="11">  c.j&lt;-<span class="kw">cov</span>(scor[<span class="op">-</span>i,])</a>
<a class="sourceLine" id="cb64-12" title="12">  l.j&lt;-<span class="kw">eigen</span>(c.j)<span class="op">$</span>values</a>
<a class="sourceLine" id="cb64-13" title="13">  theta.j[i]&lt;-l.j[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(l.j)</a>
<a class="sourceLine" id="cb64-14" title="14">}</a>
<a class="sourceLine" id="cb64-15" title="15">bias.j &lt;-<span class="st"> </span>(n<span class="dv">-1</span>)<span class="op">*</span>(<span class="kw">mean</span>(theta.j)<span class="op">-</span>theta.hat)</a>
<a class="sourceLine" id="cb64-16" title="16">se.j &lt;-<span class="st"> </span><span class="kw">sqrt</span>((n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">mean</span>((theta.j<span class="op">-</span><span class="kw">mean</span>(theta.j))<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb64-17" title="17"><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">theta.hat=</span>theta.hat,<span class="dt">bias.jack=</span>bias.j, <span class="dt">se.jack=</span>se.j),<span class="dv">3</span>)</a></code></pre></div>
<pre><code>## theta.hat bias.jack   se.jack 
##     0.619     0.001     0.050</code></pre>
</div>
<div id="section-22" class="section level5">
<h5>7.10</h5>
<p>In this question, the four models are: <span class="math display">\[
1. Linear: Y = β_0 + β_1X + ε.\\
2. Quadratic: Y = β_0 + β_1X + β_2X^2 + ε.\\
3. Exponential: log(Y) = log(β_0) + β_1X + ε.\\
4. Cubic: Y = β_0 + β_1X + β_2X^2 + β_3X^3 + ε.
\]</span></p>
<p>By compare the estimates for prediction error are obtained from the n-fold cross validation, we can find the quadratic model, whose prediction error is minimum, would be the best fit for the data.<br />
According to maximum adjusted <span class="math inline">\(R^2\)</span>, the quadratic model, whose adjusted <span class="math inline">\(R^2\)</span> is the largest, would be best.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" title="1"><span class="kw">library</span>(knitr)</a>
<a class="sourceLine" id="cb66-2" title="2"><span class="kw">library</span>(DAAG)</a>
<a class="sourceLine" id="cb66-3" title="3"><span class="kw">attach</span>(ironslag)</a>
<a class="sourceLine" id="cb66-4" title="4">n &lt;-<span class="st"> </span><span class="kw">length</span>(magnetic) <span class="co">#in DAAG ironslag</span></a>
<a class="sourceLine" id="cb66-5" title="5"></a>
<a class="sourceLine" id="cb66-6" title="6"><span class="co"># cross validation</span></a>
<a class="sourceLine" id="cb66-7" title="7">e1 &lt;-<span class="st"> </span>e2 &lt;-<span class="st"> </span>e3 &lt;-<span class="st"> </span>e4 &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb66-8" title="8"><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</a>
<a class="sourceLine" id="cb66-9" title="9">  y &lt;-<span class="st"> </span>magnetic[<span class="op">-</span>k]</a>
<a class="sourceLine" id="cb66-10" title="10">  x &lt;-<span class="st"> </span>chemical[<span class="op">-</span>k]</a>
<a class="sourceLine" id="cb66-11" title="11">  </a>
<a class="sourceLine" id="cb66-12" title="12">  J1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x)</a>
<a class="sourceLine" id="cb66-13" title="13">  yhat1 &lt;-<span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>]<span class="op">*</span>chemical[k]</a>
<a class="sourceLine" id="cb66-14" title="14">  e1[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat1</a>
<a class="sourceLine" id="cb66-15" title="15">  </a>
<a class="sourceLine" id="cb66-16" title="16">  J2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb66-17" title="17">  yhat2 &lt;-<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>]<span class="op">*</span>chemical[k] <span class="op">+</span>J2<span class="op">$</span>coef[<span class="dv">3</span>]<span class="op">*</span>chemical[k]<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb66-18" title="18">  e2[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat2</a>
<a class="sourceLine" id="cb66-19" title="19">  </a>
<a class="sourceLine" id="cb66-20" title="20">  J3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span>x)</a>
<a class="sourceLine" id="cb66-21" title="21">  logyhat3 &lt;-<span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>]<span class="op">*</span>chemical[k]</a>
<a class="sourceLine" id="cb66-22" title="22">  yhat3 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat3)</a>
<a class="sourceLine" id="cb66-23" title="23">  e3[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat3</a>
<a class="sourceLine" id="cb66-24" title="24">  </a>
<a class="sourceLine" id="cb66-25" title="25">  J4 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">3</span>))</a>
<a class="sourceLine" id="cb66-26" title="26">  yhat4 &lt;-<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>]<span class="op">*</span>chemical[k] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">3</span>]<span class="op">*</span>chemical[k]<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">4</span>]<span class="op">*</span>chemical[k]<span class="op">^</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb66-27" title="27">  e4[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat4</a>
<a class="sourceLine" id="cb66-28" title="28">}</a>
<a class="sourceLine" id="cb66-29" title="29"></a>
<a class="sourceLine" id="cb66-30" title="30"></a>
<a class="sourceLine" id="cb66-31" title="31">L1 &lt;-<span class="st"> </span><span class="kw">lm</span>(magnetic<span class="op">~</span>chemical)</a>
<a class="sourceLine" id="cb66-32" title="32">L2 &lt;-<span class="st"> </span><span class="kw">lm</span>(magnetic<span class="op">~</span>chemical<span class="op">+</span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb66-33" title="33">L3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(magnetic)<span class="op">~</span>chemical)</a>
<a class="sourceLine" id="cb66-34" title="34">L4 &lt;-<span class="st"> </span><span class="kw">lm</span>(magnetic<span class="op">~</span>chemical<span class="op">+</span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">3</span>))</a>
<a class="sourceLine" id="cb66-35" title="35"><span class="co"># to get adjustied R^2 </span></a>
<a class="sourceLine" id="cb66-36" title="36">r1 &lt;-<span class="st"> </span><span class="kw">summary</span>(L1)<span class="op">$</span>adj.r.squared</a>
<a class="sourceLine" id="cb66-37" title="37">r2 &lt;-<span class="st"> </span><span class="kw">summary</span>(L2)<span class="op">$</span>adj.r.squared</a>
<a class="sourceLine" id="cb66-38" title="38">r3 &lt;-<span class="st"> </span><span class="kw">summary</span>(L3)<span class="op">$</span>adj.r.squared</a>
<a class="sourceLine" id="cb66-39" title="39">r4 &lt;-<span class="st"> </span><span class="kw">summary</span>(L4)<span class="op">$</span>adj.r.squared</a>
<a class="sourceLine" id="cb66-40" title="40"></a>
<a class="sourceLine" id="cb66-41" title="41">results &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Linear=</span><span class="kw">c</span>(<span class="kw">mean</span>(e1<span class="op">^</span><span class="dv">2</span>),r1),<span class="dt">Quadratic=</span><span class="kw">c</span>(<span class="kw">mean</span>(e2<span class="op">^</span><span class="dv">2</span>),r2),</a>
<a class="sourceLine" id="cb66-42" title="42">           <span class="dt">Exponential=</span><span class="kw">c</span>(<span class="kw">mean</span>(e3<span class="op">^</span><span class="dv">2</span>),r3),<span class="dt">Cubic=</span><span class="kw">c</span>(<span class="kw">mean</span>(e4<span class="op">^</span><span class="dv">2</span>),r4),</a>
<a class="sourceLine" id="cb66-43" title="43">           <span class="dt">row.names=</span><span class="kw">c</span>(<span class="st">&quot; prediction error&quot;</span>,<span class="st">&quot;adjustied R-square&quot;</span>))</a>
<a class="sourceLine" id="cb66-44" title="44"><span class="kw">kable</span>(results)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">Linear</th>
<th align="right">Quadratic</th>
<th align="right">Exponential</th>
<th align="right">Cubic</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>prediction error</td>
<td align="right">19.5564444</td>
<td align="right">17.8524751</td>
<td align="right">18.4418785</td>
<td align="right">18.1775605</td>
</tr>
<tr class="even">
<td>adjustied R-square</td>
<td align="right">0.5281545</td>
<td align="right">0.5768151</td>
<td align="right">0.5280556</td>
<td align="right">0.5740396</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="section-23" class="section level3">
<h3>2019.11.22</h3>
<div id="question-3" class="section level4">
<h4>Question</h4>
<div id="section-24" class="section level5">
<h5>8.3</h5>
<p>The Count 5 test for equal variances in Section 6.4 is based on the maximum number of extreme points. Example 6.15 shows that the Count 5 criterion is not applicable for unequal sample sizes. Implement a permutation test for equal variance based on the maximum number of extreme points that applies when sample sizes are not necessarily equal.</p>
</div>
<div id="slides-31" class="section level5">
<h5>slides 31</h5>
<p>Power comparison (distance correlation test versus ball covariance test)<br />
Model 1: Y = X/4 + e<br />
Model 2: Y = X/4 × e<br />
<span class="math inline">\(X ∼ N(0_2, I_2), e ∼ N(0_2, I_2)\)</span>, X and e are independent.</p>
</div>
</div>
<div id="answer-3" class="section level4">
<h4>Answer</h4>
<div id="section-25" class="section level5">
<h5>8.3</h5>
<p>By permutation, we can get the type-I error is 0.039, while without permutation, the type-I error is 0.318. Therefore, permutation test for equal variance based on the maximum number of extreme points that applies when sample sizes are not necessarily equal performs better.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" title="1">count5test &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</a>
<a class="sourceLine" id="cb67-2" title="2">  X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb67-3" title="3">  Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</a>
<a class="sourceLine" id="cb67-4" title="4">  outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</a>
<a class="sourceLine" id="cb67-5" title="5">  outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</a>
<a class="sourceLine" id="cb67-6" title="6">  <span class="co"># return 1 (reject) or 0 (do not reject H0)</span></a>
<a class="sourceLine" id="cb67-7" title="7">  <span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>))</a>
<a class="sourceLine" id="cb67-8" title="8">}</a>
<a class="sourceLine" id="cb67-9" title="9"></a>
<a class="sourceLine" id="cb67-10" title="10"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb67-11" title="11"><span class="co"># Count Five test permutation</span></a>
<a class="sourceLine" id="cb67-12" title="12">count5test_permutation &lt;-<span class="st"> </span><span class="cf">function</span>(z) {</a>
<a class="sourceLine" id="cb67-13" title="13">n &lt;-<span class="st"> </span><span class="kw">length</span>(z)</a>
<a class="sourceLine" id="cb67-14" title="14">x &lt;-<span class="st"> </span>z[<span class="dv">1</span><span class="op">:</span>(n<span class="op">/</span><span class="dv">2</span>)]</a>
<a class="sourceLine" id="cb67-15" title="15">y &lt;-<span class="st"> </span>z[<span class="op">-</span>(<span class="dv">1</span><span class="op">:</span>(n<span class="op">/</span><span class="dv">2</span>))]</a>
<a class="sourceLine" id="cb67-16" title="16">X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb67-17" title="17">Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</a>
<a class="sourceLine" id="cb67-18" title="18">outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y)) </a>
<a class="sourceLine" id="cb67-19" title="19">outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</a>
<a class="sourceLine" id="cb67-20" title="20"><span class="co"># return 1 (reject) or 0 (do not reject H0) </span></a>
<a class="sourceLine" id="cb67-21" title="21"><span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>))</a>
<a class="sourceLine" id="cb67-22" title="22">}</a>
<a class="sourceLine" id="cb67-23" title="23"></a>
<a class="sourceLine" id="cb67-24" title="24">permutation &lt;-<span class="st"> </span><span class="cf">function</span>(z,R) {</a>
<a class="sourceLine" id="cb67-25" title="25">  n &lt;-<span class="st"> </span><span class="kw">length</span>(z)</a>
<a class="sourceLine" id="cb67-26" title="26">  out &lt;-<span class="st"> </span><span class="kw">numeric</span>(R)</a>
<a class="sourceLine" id="cb67-27" title="27">  <span class="cf">for</span> (r <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="st"> </span>R){</a>
<a class="sourceLine" id="cb67-28" title="28">      p &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>n ,n ,<span class="dt">replace =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb67-29" title="29">      out[r] &lt;-<span class="st"> </span><span class="kw">count5test_permutation</span>(z[p])</a>
<a class="sourceLine" id="cb67-30" title="30">  }</a>
<a class="sourceLine" id="cb67-31" title="31">  <span class="kw">sum</span>(out)<span class="op">/</span>R</a>
<a class="sourceLine" id="cb67-32" title="32">}              </a>
<a class="sourceLine" id="cb67-33" title="33"></a>
<a class="sourceLine" id="cb67-34" title="34">n1 &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb67-35" title="35">n2 &lt;-<span class="st"> </span><span class="dv">50</span></a>
<a class="sourceLine" id="cb67-36" title="36">mu1 &lt;-<span class="st"> </span>mu2 &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb67-37" title="37">sigma1 &lt;-<span class="st"> </span>sigma2 &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb67-38" title="38">m &lt;-<span class="st"> </span><span class="fl">1e3</span></a>
<a class="sourceLine" id="cb67-39" title="39"></a>
<a class="sourceLine" id="cb67-40" title="40">alphahat1 &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">replicate</span>(m, <span class="dt">expr=</span>{</a>
<a class="sourceLine" id="cb67-41" title="41">x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1, mu1, sigma1)</a>
<a class="sourceLine" id="cb67-42" title="42">y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2, mu2, sigma2)</a>
<a class="sourceLine" id="cb67-43" title="43">x &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x) <span class="co">#centered by sample mean</span></a>
<a class="sourceLine" id="cb67-44" title="44">y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</a>
<a class="sourceLine" id="cb67-45" title="45"><span class="kw">count5test</span>(x, y)</a>
<a class="sourceLine" id="cb67-46" title="46">}))</a>
<a class="sourceLine" id="cb67-47" title="47">alphahat2 &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">replicate</span>(m, <span class="dt">expr=</span>{</a>
<a class="sourceLine" id="cb67-48" title="48">x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1, mu1, sigma1)</a>
<a class="sourceLine" id="cb67-49" title="49">y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2, mu2, sigma2)</a>
<a class="sourceLine" id="cb67-50" title="50">x &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x) <span class="co">#centered by sample mean </span></a>
<a class="sourceLine" id="cb67-51" title="51">y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</a>
<a class="sourceLine" id="cb67-52" title="52">z &lt;-<span class="st"> </span><span class="kw">c</span>(x,y)</a>
<a class="sourceLine" id="cb67-53" title="53"><span class="kw">permutation</span>(z,<span class="dv">1000</span>) </a>
<a class="sourceLine" id="cb67-54" title="54">})<span class="op">&lt;</span><span class="fl">0.05</span>)</a>
<a class="sourceLine" id="cb67-55" title="55"></a>
<a class="sourceLine" id="cb67-56" title="56"><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">count5test=</span>alphahat1,<span class="dt">count5test_permutation=</span>alphahat2),<span class="dv">4</span>)</a></code></pre></div>
<pre><code>##             count5test count5test_permutation 
##                  0.318                  0.039</code></pre>
</div>
<div id="slides-31-1" class="section level5">
<h5>slides 31</h5>
<p>By the code below, we can find that in model 1, power of two methods are similiar. But in model 2, the ball covariance test seems better.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" title="1"><span class="co">#some function used in distance correlation</span></a>
<a class="sourceLine" id="cb69-2" title="2">dCov &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</a>
<a class="sourceLine" id="cb69-3" title="3">  x &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(x); y &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(y)</a>
<a class="sourceLine" id="cb69-4" title="4">  n &lt;-<span class="st"> </span><span class="kw">nrow</span>(x); m &lt;-<span class="st"> </span><span class="kw">nrow</span>(y)</a>
<a class="sourceLine" id="cb69-5" title="5">  <span class="cf">if</span> (n <span class="op">!=</span><span class="st"> </span>m <span class="op">||</span><span class="st"> </span>n <span class="op">&lt;</span><span class="st"> </span><span class="dv">2</span>) <span class="kw">stop</span>(<span class="st">&quot;Sample sizes must agree&quot;</span>)</a>
<a class="sourceLine" id="cb69-6" title="6">  <span class="cf">if</span> (<span class="op">!</span><span class="st"> </span>(<span class="kw">all</span>(<span class="kw">is.finite</span>(<span class="kw">c</span>(x, y)))))</a>
<a class="sourceLine" id="cb69-7" title="7">    <span class="kw">stop</span>(<span class="st">&quot;Data contains missing or infinite values&quot;</span>)</a>
<a class="sourceLine" id="cb69-8" title="8">  Akl &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb69-9" title="9">    d &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">dist</span>(x))</a>
<a class="sourceLine" id="cb69-10" title="10">    m &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(d); M &lt;-<span class="st"> </span><span class="kw">mean</span>(d)</a>
<a class="sourceLine" id="cb69-11" title="11">    a &lt;-<span class="st"> </span><span class="kw">sweep</span>(d, <span class="dv">1</span>, m); b &lt;-<span class="st"> </span><span class="kw">sweep</span>(a, <span class="dv">2</span>, m)</a>
<a class="sourceLine" id="cb69-12" title="12">    b <span class="op">+</span><span class="st"> </span>M</a>
<a class="sourceLine" id="cb69-13" title="13">  }</a>
<a class="sourceLine" id="cb69-14" title="14">  A &lt;-<span class="st"> </span><span class="kw">Akl</span>(x); B &lt;-<span class="st"> </span><span class="kw">Akl</span>(y)</a>
<a class="sourceLine" id="cb69-15" title="15">  <span class="kw">sqrt</span>(<span class="kw">mean</span>(A <span class="op">*</span><span class="st"> </span>B))</a>
<a class="sourceLine" id="cb69-16" title="16">}</a>
<a class="sourceLine" id="cb69-17" title="17">ndCov2 &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, dims) {</a>
<a class="sourceLine" id="cb69-18" title="18">  <span class="co">#dims contains dimensions of x and y</span></a>
<a class="sourceLine" id="cb69-19" title="19">  p &lt;-<span class="st"> </span>dims[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb69-20" title="20">  q &lt;-<span class="st"> </span>dims[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb69-21" title="21">  d &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span>q</a>
<a class="sourceLine" id="cb69-22" title="22">  x &lt;-<span class="st"> </span>z[ , <span class="dv">1</span><span class="op">:</span>p] <span class="co">#leave x as is</span></a>
<a class="sourceLine" id="cb69-23" title="23">  y &lt;-<span class="st"> </span>z[ix, <span class="op">-</span>(<span class="dv">1</span><span class="op">:</span>p)] <span class="co">#permute rows of y</span></a>
<a class="sourceLine" id="cb69-24" title="24">  <span class="kw">return</span>(<span class="kw">nrow</span>(z) <span class="op">*</span><span class="st"> </span><span class="kw">dCov</span>(x, y)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb69-25" title="25">}</a>
<a class="sourceLine" id="cb69-26" title="26"></a>
<a class="sourceLine" id="cb69-27" title="27"><span class="kw">library</span>(boot)</a>
<a class="sourceLine" id="cb69-28" title="28"><span class="kw">library</span>(Ball)</a>
<a class="sourceLine" id="cb69-29" title="29"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb69-30" title="30">n&lt;-<span class="dv">20</span></a>
<a class="sourceLine" id="cb69-31" title="31">p.cor1&lt;-p.cor2&lt;-p.ball1&lt;-p.ball2&lt;-<span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb69-32" title="32"></a>
<a class="sourceLine" id="cb69-33" title="33">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</a>
<a class="sourceLine" id="cb69-34" title="34">    x &lt;-<span class="st"> </span>e &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">2</span><span class="op">*</span>i), , <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb69-35" title="35">    <span class="co"># for model 1</span></a>
<a class="sourceLine" id="cb69-36" title="36">    y1&lt;-x<span class="op">/</span><span class="dv">4</span><span class="op">+</span>e</a>
<a class="sourceLine" id="cb69-37" title="37">    z1 &lt;-<span class="st"> </span><span class="kw">cbind</span>(x,y1)</a>
<a class="sourceLine" id="cb69-38" title="38">    boot.obj1 &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> z1, <span class="dt">statistic =</span> ndCov2, <span class="dt">R =</span> <span class="dv">999</span>,</a>
<a class="sourceLine" id="cb69-39" title="39">                      <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">dims =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb69-40" title="40">    <span class="co"># permutatin: resampling without replacement</span></a>
<a class="sourceLine" id="cb69-41" title="41">    tb1 &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj1<span class="op">$</span>t0, boot.obj1<span class="op">$</span>t)</a>
<a class="sourceLine" id="cb69-42" title="42">    p.cor1[i]&lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span><span class="kw">mean</span>(tb1<span class="op">&gt;=</span>tb1[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb69-43" title="43">    <span class="co">#ball</span></a>
<a class="sourceLine" id="cb69-44" title="44">    p.ball1 [i]&lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span><span class="kw">bcov.test</span>(z1[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],z1[,<span class="dv">3</span><span class="op">:</span><span class="dv">4</span>],<span class="dt">R=</span><span class="dv">999</span>)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb69-45" title="45">    </a>
<a class="sourceLine" id="cb69-46" title="46">    <span class="co"># for model 2</span></a>
<a class="sourceLine" id="cb69-47" title="47">    y2&lt;-x<span class="op">/</span><span class="dv">4</span><span class="op">*</span>e</a>
<a class="sourceLine" id="cb69-48" title="48">    z2 &lt;-<span class="st"> </span><span class="kw">cbind</span>(x,y2)</a>
<a class="sourceLine" id="cb69-49" title="49">    boot.obj2 &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> z2, <span class="dt">statistic =</span> ndCov2, <span class="dt">R =</span> <span class="dv">999</span>,</a>
<a class="sourceLine" id="cb69-50" title="50">                      <span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">dims =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb69-51" title="51">    <span class="co"># permutatin: resampling without replacement</span></a>
<a class="sourceLine" id="cb69-52" title="52">    tb2 &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj2<span class="op">$</span>t0, boot.obj2<span class="op">$</span>t)</a>
<a class="sourceLine" id="cb69-53" title="53">    p.cor2[i]&lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span><span class="kw">mean</span>(tb2<span class="op">&gt;=</span>tb2[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb69-54" title="54">    <span class="co">#ball</span></a>
<a class="sourceLine" id="cb69-55" title="55">    p.ball2[i] &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span><span class="kw">bcov.test</span>(z2[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],z2[,<span class="dv">3</span><span class="op">:</span><span class="dv">4</span>],<span class="dt">R=</span><span class="dv">999</span>)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb69-56" title="56">  }</a>
<a class="sourceLine" id="cb69-57" title="57"></a>
<a class="sourceLine" id="cb69-58" title="58"><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>,p.cor1,<span class="st">&#39;l&#39;</span>,<span class="dt">xlab =</span> <span class="st">&#39;n&#39;</span>,<span class="dt">ylab =</span> <span class="st">&#39;power&#39;</span>,<span class="dt">main =</span> <span class="st">&#39;model 1&#39;</span>)</a>
<a class="sourceLine" id="cb69-59" title="59"><span class="kw">lines</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>,p.ball1,<span class="st">&#39;l&#39;</span>,<span class="dt">col=</span><span class="st">&#39;red&#39;</span>)</a>
<a class="sourceLine" id="cb69-60" title="60"><span class="kw">legend</span>(<span class="dv">10</span>,<span class="fl">0.4</span>,<span class="kw">c</span>(<span class="st">&#39;distance correlation test&#39;</span>,<span class="st">&#39;ball covariance test&#39;</span>),<span class="dt">col=</span><span class="kw">c</span>(<span class="st">&#39;black&#39;</span>,<span class="st">&#39;red&#39;</span>),</a>
<a class="sourceLine" id="cb69-61" title="61">       <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>),<span class="dt">cex =</span> <span class="fl">0.7</span> )</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" title="1"><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>,p.cor2,<span class="st">&#39;l&#39;</span>,<span class="dt">xlab =</span> <span class="st">&#39;n&#39;</span>,<span class="dt">ylab =</span> <span class="st">&#39;power&#39;</span>,<span class="dt">main =</span> <span class="st">&#39;model 2&#39;</span>)</a>
<a class="sourceLine" id="cb70-2" title="2"><span class="kw">lines</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>,p.ball2,<span class="st">&#39;l&#39;</span>,<span class="dt">col=</span><span class="st">&#39;red&#39;</span>)</a>
<a class="sourceLine" id="cb70-3" title="3"><span class="kw">legend</span>(<span class="dv">10</span>,<span class="fl">0.4</span>,<span class="kw">c</span>(<span class="st">&#39;distance correlation test&#39;</span>,<span class="st">&#39;ball covariance test&#39;</span>),<span class="dt">col=</span><span class="kw">c</span>(<span class="st">&#39;black&#39;</span>,<span class="st">&#39;red&#39;</span>),</a>
<a class="sourceLine" id="cb70-4" title="4">       <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>),<span class="dt">cex =</span> <span class="fl">0.7</span> )</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAq1BMVEUAAAAAADoAAGYAOjoAOmYAOpAAZmYAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZmY6ZpA6ZrY6kNtmAABmADpmAGZmOgBmOjpmOmZmOpBmkLZmkNtmtrZmtttmtv+QOgCQOjqQZjqQttuQ2/+2ZgC2Zjq2kDq225C22/+2///bkDrbkGbbtmbbtpDb25Db/7bb/9vb////AAD/tmb/25D/27b//7b//9v///9jfi+RAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKA0lEQVR4nO2dC5ubRBSGZ7ddE1urNtF67a4aqg22ajdpkv//y5wLJJAA3zAXMrDf+2gkCXsGXs/cgIA4kE7EtTcgdSgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCDAGARl4nZdebt/EHefiuXPPwghXr2PWPi4BW3mQnGzilf4qAXJpdvVYTs/ZVR4rixotxSzjy/FzdvD33Px3CTCR1ltnv2sd3n/Tn76hxG0fydT5fWnqqDdD/PZ4UJgWK4vyPBSvej9zM0Hd0aFQX5RrPl8XWuDNFMXtDh8kHv+VplZHIoKY5Y3Qsw+qcyRAqSF9+rLxYWgqVcxuXPmVe99mQ5ZIWWt17ldyxf5pRR3uz4TpBzfx9vC6wuala+19Mhl1ySXVROjPW3nRW3TH1cEfV6KmAmUnCCzqGvXfbmsBG1EsyAlLqaf5ASdZZBeLjKorEdVQdH9JCeoow2aFX9TEbSLXL8OCQq67MWyoheTg6XPqjWvCMqi+0lPUHUcpAScjYPkrOIk6NhyT3ocdC7IjKR/0V/v/5yLZ29NTfv8u9Tx7ftqFcvF5AWlDwUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAgQWJ0XAtQWHDxYOCABQEGFhQ/6ptHdnrj8+36vRmLBn02MDFl10rO9BvQ68r6PHsvf7fW90ToSJemKv9QWORMJXHKug8QMMHF+8uy7So6eMQdOmnwYeov6/sfLl4XqjNRiQuqFgNChLnIfUHF15qGWPXUaQtqNiHBj+gCpVqxLmH8o11P5q0oDJRmgRdJkyDoIY0EaYPt93OpAWVidLop0FQRUtX1H57krCgY1ZgQeeNTcCNTVfQcaeb/TQ2OdbB7YkkKBNipn/M3vYzYxjutLP2gi4yKQBxBOV3n6Qj/QOvhVu40/dtfqq9d30haLJHEbR/UD+T1HcSyVt+CQnCVb7uI6htxOxBFEG7paxZG/3rvk3Lb/ysBT22TyFaVIVtLdPMoFoCNQwJ64tn/dkIBJ3aIK2qf7haC9Q4Eq4u1z+7zpxo4F6sVVBjNtUNjkOQX7izLqyp2am8a62CQRiXoMYGO7SStm0JtWKd3KEXOx8DTVrQeRSbg/YXg8TWKUT4Xr1jY0Kt6B+OgrrDXY6iW6dY4xVU3nWt9V4ZVoIeax81/UnwcWHH1oRaUZGLYny4Ef0Hiv0ERfYTcaph6D/VaJyntmXKSAXpyaqh/2T1KQgKlEGP1Q9b/iC2n2htUJFC/dugxgRqn2IlKKh1gl6lvLNo643DegvCZcahv6BKAxOh3OrnTRchDI5DFWtrd4OU25JA18MlgwQYBPqUOwFBUctNroZREMJFkL5pcWbRl/UvN7ka5tRI36zk8K/1lKBXuVMQpMZBanzcdqzQq9wpCFLjICXIr7efsKAygzKv2+s2l5ueH/c2KPe7P/yUBZmhottDTsBB+4kIilcuBYFwjceCrovTXGzWtaJPuZMQVLknevBypyHIsFtGGAdNRpBKoggZlKAfF0HqEQPex8wmLMizbnWVOw1BOoW8+7FuQen4cW2kc6snUW3nrSt1CkrIT5xe7HjYuv3I9ZQFZfigfXG+0DGDUvLjNpLGPfxuqQ6GuAlKyk+8uVh2s3ITlJYf117MYpyYi0VPQSn6cTpgVjy8CnVj2/mzJymovHih7cKWE/uHdoltglLz43HxQviD9iJBP1EzSK/VYxw0EUHWbVBjlK5j0l6CXG4uZYX1BpwW7Xox63CVzzwSKPAh4atvwFMX5HIhuV8TlJIgPRftbKKdLiSfjKDix6gdjZDbZcBTEbR/MN1Xx7l5twvJpyJo951JnY6BomsG+YyC0hFUZlDXQNHpQvKpCJI7rfa+e6DociH5VARZHE/tE6760TQERQs3mCDZSGy/Nqm9+ynYQ9ajC/Lz01NQuViKCsBkBOXi+RuZQf/Jsf5CP3A9F2J22H5TPqldNhsbUZz4U2+Db4BruGCCuufk2xfr7VwK+jA77L5fywyS/6iFF2v5qoYw+UylVaaSTL913yMvrpZBuRx3ZFLQP/r0sHIh0+RmJRf2v61Mjdsoo2p40qsCTk2QFqP+Kwe8MlNqgsoT64kJ8juaaLt9qi4tpZg/pYVsoQTN1OzSCFJ1anP3z5cr047rt6E3wDncQIJkI33zUmVOpoaxu+Xdv0vxhTKmBKXdSA8kKBaxBXk2QVMR1H4snIJAOAoC4TybIArqHXBopiKoOviT42k0FNx+HXoDXMMlKij8BriGCyeo/RkZiu2rN2oUaKbwhSAzPMzVBEzNROS/5utXb27/SiaDfC9bsM6g+b05YKbn8lpQMYd/UZuTqa+/XKVTxXwTqM9cTKVIMYXXgk5T1Oz+8G61fX04zvCfrKByCn8paDNTL+UMP5qg3ufmhxOkq1g5hT9WMTmH11XssPvxx/XhOMOPJaj/ufnhBOlGeldM4c8aaXWMI9M3Ui9m+JEEOZxZ9b60bFQDRYdz809LEDMI0f/c/BMT1PvcvHcbPTZBfcNREAjnf330WAVZXkgeQFAsrDfAexfqu6HfNsy2U2NgQbHCxYOCAJEE+dyRPC3iCPK6I3laRBFkM9UYDTEEWUxWg5cafkd6JnngDApe6qgEWUxWg5c6LkF4shq81JEJCgUFBSuVgkKtSUGDr+i0eiAoaDpQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgwPCCzGFbiztXqyt7D/rHyuDGamZFFFef9FzYRawwvCB1obsNxY2b1X2fNp37U6wI4u4fZJBcCcQRqwwvyPKU2sac4DanmrKOhCtWRHHNDWjz2zWOWGN4QbnVpm3EQu/xcb/QinZx1XXkKGKd4QVlX5VtAcAI0hWnOzvMt1Zxs9u1TcQKgwsy9+y2eZSi3gfTWHQ3GXpFq7jqhKdNxApX6uZt/gf2E2QTd1O20ekL6rhn95GeVQzHNSfMU69iBpu+3q6RPtQFdcTNq48sSLeRNttnXcVsOuWKyY645ZUXyXfzetOsG2mbYV3Ri3XH3c7Lr1IfKOoHeNjctLrIhhxODIoVu+Pm5roUFQpHrMDJKoCCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCJC6oN3y16Xd1TKRSF+QukDe8yHvPqQvaGF3yWcs0hd0X7s32OBQEICCABQEoCAABQFSF3R1KAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgwP+MkuPa+qG7awAAAABJRU5ErkJggg==" /><!-- --></p>
</div>
</div>
</div>
<div id="section-26" class="section level3">
<h3>2019.11.29</h3>
<div id="qusetion" class="section level4">
<h4>Qusetion</h4>
<div id="section-27" class="section level5">
<h5>9.4</h5>
<p>Implement a random walk Metropolis sampler for generating the standard Laplace distribution (see Exercise 3.2). For the increment, simulate from a normal distribution. Compare the chains generated when different variances are used for the proposal distribution. Also, compute the acceptance rates of each chain.</p>
</div>
</div>
<div id="answer-4" class="section level4">
<h4>Answer</h4>
<p>To implement a random walk Metropolis for generating the standard Laplace distribution, we need first get the density function(which I defined as “dl” in R code). And then set a random x0 as our starter to get the markov chain and the acceptance rate(this is what the fuction &quot;rw.Metropolis does). From the R code below, we can get the random walk Metropolis chains generated by proposal distributions with different variances, and we can also compute its corresponding acceptance rate. From the result, we can find when <span class="math inline">\(\sigma=1\)</span>, the chain is best.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" title="1"><span class="co">#define the density fuction</span></a>
<a class="sourceLine" id="cb71-2" title="2">dl&lt;-<span class="cf">function</span>(x) <span class="dv">1</span><span class="op">/</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x))</a>
<a class="sourceLine" id="cb71-3" title="3">rw.Metropolis &lt;-<span class="st"> </span><span class="cf">function</span>(n, sigma, x0, N) {</a>
<a class="sourceLine" id="cb71-4" title="4">  x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb71-5" title="5">  x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</a>
<a class="sourceLine" id="cb71-6" title="6">  u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</a>
<a class="sourceLine" id="cb71-7" title="7">  k &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb71-8" title="8">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb71-9" title="9">    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</a>
<a class="sourceLine" id="cb71-10" title="10">    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">dl</span>(y) <span class="op">/</span><span class="st"> </span><span class="kw">dl</span>(x[i<span class="dv">-1</span>])))</a>
<a class="sourceLine" id="cb71-11" title="11">      x[i] &lt;-<span class="st"> </span>y <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb71-12" title="12">        x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb71-13" title="13">        k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb71-14" title="14">      }</a>
<a class="sourceLine" id="cb71-15" title="15">  }</a>
<a class="sourceLine" id="cb71-16" title="16">  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">k=</span>k))</a>
<a class="sourceLine" id="cb71-17" title="17">}</a>
<a class="sourceLine" id="cb71-18" title="18"></a>
<a class="sourceLine" id="cb71-19" title="19">n &lt;-<span class="st"> </span><span class="dv">4</span> </a>
<a class="sourceLine" id="cb71-20" title="20">N &lt;-<span class="st"> </span><span class="dv">3000</span></a>
<a class="sourceLine" id="cb71-21" title="21">sigma &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">01</span>, <span class="fl">.1</span>, <span class="dv">1</span>, <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb71-22" title="22">x0 &lt;-<span class="st"> </span><span class="dv">5</span></a>
<a class="sourceLine" id="cb71-23" title="23">index &lt;-<span class="st"> </span><span class="dv">0</span><span class="op">:</span>N</a>
<a class="sourceLine" id="cb71-24" title="24"></a>
<a class="sourceLine" id="cb71-25" title="25"></a>
<a class="sourceLine" id="cb71-26" title="26"><span class="co">#sigama=0.01</span></a>
<a class="sourceLine" id="cb71-27" title="27">rw1 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(n, sigma[<span class="dv">1</span>], x0, N)</a>
<a class="sourceLine" id="cb71-28" title="28">y1 &lt;-<span class="st"> </span>rw1<span class="op">$</span>x[index]</a>
<a class="sourceLine" id="cb71-29" title="29"><span class="kw">plot</span>(y1, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">main=</span><span class="kw">expression</span>(sigma<span class="op">==</span><span class="fl">0.01</span>), <span class="dt">ylab=</span><span class="st">&quot;x&quot;</span>,<span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" title="1">p1&lt;-<span class="dv">1</span><span class="op">-</span>rw1<span class="op">$</span>k<span class="op">/</span>N</a>
<a class="sourceLine" id="cb72-2" title="2"></a>
<a class="sourceLine" id="cb72-3" title="3"><span class="co">#sigama=0.1</span></a>
<a class="sourceLine" id="cb72-4" title="4">rw2 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(n, sigma[<span class="dv">2</span>], x0, N)</a>
<a class="sourceLine" id="cb72-5" title="5">y2 &lt;-<span class="st"> </span>rw2<span class="op">$</span>x[index]</a>
<a class="sourceLine" id="cb72-6" title="6"><span class="kw">plot</span>(y2, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">main=</span><span class="kw">expression</span>(sigma<span class="op">==</span><span class="fl">0.1</span>), <span class="dt">ylab=</span><span class="st">&quot;x&quot;</span>,<span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" title="1">p2&lt;-<span class="dv">1</span><span class="op">-</span>rw2<span class="op">$</span>k<span class="op">/</span>N</a>
<a class="sourceLine" id="cb73-2" title="2"></a>
<a class="sourceLine" id="cb73-3" title="3"><span class="co">#sigama=1</span></a>
<a class="sourceLine" id="cb73-4" title="4">rw3 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(n, sigma[<span class="dv">3</span>], x0, N)</a>
<a class="sourceLine" id="cb73-5" title="5">y3 &lt;-<span class="st"> </span>rw3<span class="op">$</span>x[index]</a>
<a class="sourceLine" id="cb73-6" title="6"><span class="kw">plot</span>(y3, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">main=</span><span class="kw">expression</span>(sigma<span class="op">==</span><span class="dv">1</span>), <span class="dt">ylab=</span><span class="st">&quot;x&quot;</span>,<span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" title="1">p3&lt;-<span class="dv">1</span><span class="op">-</span>rw3<span class="op">$</span>k<span class="op">/</span>N</a>
<a class="sourceLine" id="cb74-2" title="2"></a>
<a class="sourceLine" id="cb74-3" title="3"><span class="co">#sigma=10</span></a>
<a class="sourceLine" id="cb74-4" title="4">rw4 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(n, sigma[<span class="dv">4</span>], x0, N)</a>
<a class="sourceLine" id="cb74-5" title="5">y4 &lt;-<span class="st"> </span>rw4<span class="op">$</span>x[index]</a>
<a class="sourceLine" id="cb74-6" title="6"><span class="kw">plot</span>(y4, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">main=</span><span class="kw">expression</span>(sigma<span class="op">==</span><span class="dv">10</span>), <span class="dt">ylab=</span><span class="st">&quot;x&quot;</span>,<span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" title="1">p4&lt;-<span class="dv">1</span><span class="op">-</span>rw4<span class="op">$</span>k<span class="op">/</span>N</a>
<a class="sourceLine" id="cb75-2" title="2"></a>
<a class="sourceLine" id="cb75-3" title="3">rate&lt;-<span class="kw">data.frame</span>(p1,p2,p3,p4,<span class="dt">row.names =</span><span class="st">&#39;acceptance rate&#39;</span>)</a>
<a class="sourceLine" id="cb75-4" title="4"><span class="kw">names</span>(rate)&lt;-<span class="kw">c</span>(<span class="fl">0.01</span>,<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb75-5" title="5">knitr<span class="op">::</span><span class="kw">kable</span>(rate)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">0.01</th>
<th align="right">0.1</th>
<th align="right">1</th>
<th align="right">10</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>acceptance rate</td>
<td align="right">0.997</td>
<td align="right">0.9606667</td>
<td align="right">0.704</td>
<td align="right">0.1596667</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="section-28" class="section level3">
<h3>2019.12.6</h3>
<div id="question-4" class="section level4">
<h4>Question</h4>
<div id="section-29" class="section level5">
<h5>11.1</h5>
<p>The natural logarithm and exponential functions are inverses of each other,so that mathematically <span class="math inline">\(\log(\exp x) = \exp(\log x) = x\)</span>. Show by example that this property does not hold exactly in computer arithmetic. Does the identity hold with near equality? (See all.equal.)</p>
</div>
<div id="section-30" class="section level5">
<h5>11.5</h5>
<p>Write a function to solve the equation: <span class="math display">\[
\frac{2 \Gamma\left(\frac{k}{2}\right)}{\sqrt{\pi(k-1)} \Gamma\left(\frac{k-1}{2}\right)} \int_{0}^{c_{k-1}}\left(1+\frac{u^{2}}{k-1}\right)^{-k / 2} d u =\frac{2 \Gamma\left(\frac{k+1}{2}\right)}{\sqrt{\pi k} \Gamma\left(\frac{k}{2}\right)} \int_{0}^{c_{k}}\left(1+\frac{u^{2}}{k}\right)^{-(k+1) / 2} d u
\]</span> for <span class="math inline">\(a\)</span>, where <span class="math inline">\(c_{k}=\sqrt{\frac{a^{2} k}{k+1-a^{2}}}\)</span><br />
Compare the solutions with the points <span class="math inline">\(A(k)\)</span> in Exercise 11.4</p>
</div>
<div id="slides" class="section level5">
<h5>Slides</h5>
<p>Let the three alleles be A, B, and O with allele frequencies p,q, and r. The 6 genotype frequencies under HWE andcomplete counts are as follows.</p>
<p><span class="math display">\[\begin{array}{|c|c|c|c|c|c|c|}\hline \text { Genotype } &amp; {A A} &amp; {B B} &amp; {O O} &amp; {A O} &amp; {B O} &amp; {A B} &amp; {S u m} \\ \hline \text { Frequency } &amp; {p^{2}} &amp; {q^{2}} &amp; {r^ 2} &amp; {2 p r} &amp; {2 q r} &amp; {2 p q} &amp; {1} \\ \hline \text { Count } &amp; {n_{AA} } &amp; {n_ {B B}} &amp; {n_ {O O}} &amp; {n _{A O}} &amp; {n _{B O}} &amp; {n_ {A B}} &amp; {n} \\ \hline\end{array}\]</span></p>
<p>Observed data: <span class="math inline">\(n_{A·} = n_{AA} + n_{AO} = 28\)</span> (A-type), <span class="math inline">\(n_{B·} = n_{BB} + n_{BO} = 24\)</span>(B-type), <span class="math inline">\(n_{OO} = 41\)</span> (O-type), <span class="math inline">\(n_{AB} = 70\)</span> (AB-type).<br />
(1)Use EM algorithm to solve MLE of <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span> (consider missing data <span class="math inline">\(n_{AA}\)</span> and <span class="math inline">\(n_{BB}\)</span>).<br />
(2)Show that the log-maximum likelihood values in M-steps are increasing via line plot.</p>
</div>
</div>
<div id="answer-5" class="section level4">
<h4>Answer</h4>
<div id="section-31" class="section level5">
<h5>11.1</h5>
<p>Given a random value 3, we can find the result of <span class="math inline">\(\log(\exp(x)) , \exp(\log(x)),x\)</span> are not all equal, but we can find the identity hold with near equality by the R function “all.equal”</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" title="1">x&lt;-<span class="dv">3</span> <span class="co">#given a random value</span></a>
<a class="sourceLine" id="cb76-2" title="2">x1&lt;-<span class="kw">log</span>(<span class="kw">exp</span>(x))</a>
<a class="sourceLine" id="cb76-3" title="3">x2&lt;-<span class="kw">exp</span>(<span class="kw">log</span>(x))</a>
<a class="sourceLine" id="cb76-4" title="4"><span class="kw">cat</span>(<span class="st">&quot;x-log(exp(x))=&quot;</span>,x<span class="op">-</span>x1)</a>
<a class="sourceLine" id="cb76-5" title="5"><span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">x-exp(log(x))=&quot;</span>,x<span class="op">-</span>x2)</a>
<a class="sourceLine" id="cb76-6" title="6"><span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">log(exp(x))-exp(log(x))=&quot;</span>,x1<span class="op">-</span>x2)</a>
<a class="sourceLine" id="cb76-7" title="7"><span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</a>
<a class="sourceLine" id="cb76-8" title="8"><span class="kw">all.equal</span>(x,x1)</a>
<a class="sourceLine" id="cb76-9" title="9"><span class="kw">all.equal</span>(x,x2)</a>
<a class="sourceLine" id="cb76-10" title="10"><span class="kw">all.equal</span>(x1,x2)</a></code></pre></div>
<pre><code>## x-log(exp(x))= 0
## x-exp(log(x))= -4.440892e-16
## log(exp(x))-exp(log(x))= -4.440892e-16
## [1] TRUE
## [1] TRUE
## [1] TRUE</code></pre>
</div>
<div id="section-32" class="section level5">
<h5>11.5</h5>
<p>To solve the equation for <span class="math inline">\(a\)</span> is to find <span class="math inline">\(a\)</span> makes <span class="math display">\[
\frac{2 \Gamma\left(\frac{k}{2}\right)}{\sqrt{\pi(k-1)} \Gamma\left(\frac{k-1}{2}\right)} \int_{0}^{c_{k-1}}\left(1+\frac{u^{2}}{k-1}\right)^{-k / 2} d u -\frac{2 \Gamma\left(\frac{k+1}{2}\right)}{\sqrt{\pi k} \Gamma\left(\frac{k}{2}\right)} \int_{0}^{c_{k}}\left(1+\frac{u^{2}}{k}\right)^{-(k+1) / 2} d u=0
\]</span> Thus, we can use the R function “uniroot” to find such <span class="math inline">\(a\)</span> with different <span class="math inline">\(k\)</span>. The code is as follows.<br />
Compared with the results in 11.4, we can find the point estimation under the same <span class="math inline">\(k\)</span> value is same</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" title="1"><span class="co">#in the 11.5 case</span></a>
<a class="sourceLine" id="cb78-2" title="2">fc&lt;-<span class="cf">function</span>(a,k) <span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>k<span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb78-3" title="3">f1&lt;-<span class="cf">function</span>(u) (<span class="dv">1</span><span class="op">+</span>u<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(k<span class="dv">-1</span>))<span class="op">^</span>(<span class="op">-</span>k<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb78-4" title="4">f2&lt;-<span class="cf">function</span>(u) (<span class="dv">1</span><span class="op">+</span>u<span class="op">^</span><span class="dv">2</span><span class="op">/</span>k)<span class="op">^</span>(<span class="op">-</span>(k<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb78-5" title="5">f &lt;-<span class="st"> </span><span class="cf">function</span>(a){</a>
<a class="sourceLine" id="cb78-6" title="6">  <span class="dv">2</span><span class="op">*</span><span class="kw">gamma</span>(k<span class="op">/</span><span class="dv">2</span>)<span class="op">/</span>(<span class="kw">sqrt</span>(pi<span class="op">*</span>(k<span class="dv">-1</span>))<span class="op">*</span><span class="kw">gamma</span>((k<span class="dv">-1</span>)<span class="op">/</span><span class="dv">2</span>))<span class="op">*</span><span class="kw">integrate</span>(f1,<span class="dv">0</span>,<span class="kw">fc</span>(a,k<span class="dv">-1</span>))<span class="op">$</span>value<span class="dv">-2</span><span class="op">*</span><span class="kw">gamma</span>((k<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)<span class="op">/</span>(<span class="kw">sqrt</span>(pi<span class="op">*</span>k)<span class="op">*</span><span class="kw">gamma</span>(k<span class="op">/</span><span class="dv">2</span>))<span class="op">*</span><span class="kw">integrate</span>(f2,<span class="dv">0</span>,<span class="kw">fc</span>(a,k))<span class="op">$</span>value</a>
<a class="sourceLine" id="cb78-7" title="7">}   </a>
<a class="sourceLine" id="cb78-8" title="8"></a>
<a class="sourceLine" id="cb78-9" title="9">K &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>,<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb78-10" title="10">n &lt;-<span class="st"> </span><span class="kw">length</span>(K)</a>
<a class="sourceLine" id="cb78-11" title="11">R &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb78-12" title="12"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</a>
<a class="sourceLine" id="cb78-13" title="13">  k &lt;-<span class="st"> </span>K[i]</a>
<a class="sourceLine" id="cb78-14" title="14">  R[i] &lt;-<span class="st"> </span><span class="kw">uniroot</span>(f,<span class="kw">c</span>(<span class="fl">0.5</span>,<span class="kw">sqrt</span>(k)<span class="op">/</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>))<span class="op">$</span>root</a>
<a class="sourceLine" id="cb78-15" title="15">}</a>
<a class="sourceLine" id="cb78-16" title="16"><span class="kw">print</span>(R)</a></code></pre></div>
<pre><code>##  [1] 1.492105 1.533565 1.562774 1.584429 1.601210 1.614520 1.625383 1.634421
##  [9] 1.642056 1.648526 1.654168 1.659095 1.663433 1.667281 1.670725 1.673824
## [17] 1.676639 1.679154 1.681472 1.683596 1.685550 1.687355 1.720600</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" title="1"><span class="co"># in the 11.4case</span></a>
<a class="sourceLine" id="cb80-2" title="2">S&lt;-<span class="cf">function</span>(a){</a>
<a class="sourceLine" id="cb80-3" title="3">  <span class="kw">pt</span>(<span class="kw">sqrt</span>((k<span class="dv">-1</span>)<span class="op">*</span>a<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(k<span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),k<span class="dv">-1</span>)<span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>((k<span class="op">*</span>a<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),k)</a>
<a class="sourceLine" id="cb80-4" title="4">}</a>
<a class="sourceLine" id="cb80-5" title="5">K1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb80-6" title="6">n &lt;-<span class="st"> </span><span class="kw">length</span>(K1)</a>
<a class="sourceLine" id="cb80-7" title="7">inter &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb80-8" title="8"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</a>
<a class="sourceLine" id="cb80-9" title="9">  k &lt;-<span class="st"> </span>K1[i]</a>
<a class="sourceLine" id="cb80-10" title="10">  inter[i] &lt;-<span class="st"> </span><span class="kw">uniroot</span>(S,<span class="kw">c</span>(<span class="fl">0.5</span>,<span class="kw">sqrt</span>(k)<span class="op">/</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>))<span class="op">$</span>root</a>
<a class="sourceLine" id="cb80-11" title="11">}</a>
<a class="sourceLine" id="cb80-12" title="12"><span class="kw">print</span>(inter)</a></code></pre></div>
<pre><code>##  [1]  1.492105  1.533565  1.562774  1.584429  1.601210  1.614520  1.625383
##  [8]  1.634421  1.642056  1.648526  1.654168  1.659095  1.663433  1.667281
## [15]  1.670725  1.673824  1.676639  1.679154  1.681472  1.683596  1.685550
## [22]  1.687355  1.720600 12.180340 16.811388</code></pre>
</div>
<div id="slides-1" class="section level5">
<h5>Slides</h5>
<p>(1)In this question, we can first get the log-maximum likelihood function with the data we get(which is denote as “E” in my code), and than by iteration and updating <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span>, we can finally get the estimators of <span class="math inline">\(p,q\)</span> which converges. Finally, by my code, the estimators of <span class="math inline">\(p,q\)</span> are 0.3273442, 0.3104267.<br />
(2)And we can find the log-maximum likelihood values in M-steps are increasing by line plot.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" title="1"><span class="kw">library</span>(rootSolve)</a>
<a class="sourceLine" id="cb82-2" title="2">N &lt;-<span class="st"> </span><span class="dv">500</span></a>
<a class="sourceLine" id="cb82-3" title="3">na.&lt;-<span class="dv">28</span></a>
<a class="sourceLine" id="cb82-4" title="4">nb.&lt;-<span class="dv">24</span></a>
<a class="sourceLine" id="cb82-5" title="5">noo&lt;-<span class="dv">41</span></a>
<a class="sourceLine" id="cb82-6" title="6">nab&lt;-<span class="dv">70</span></a>
<a class="sourceLine" id="cb82-7" title="7">n&lt;-<span class="kw">sum</span>(na.,nb.,noo,nab)</a>
<a class="sourceLine" id="cb82-8" title="8"><span class="co">#initial estimations for p and q</span></a>
<a class="sourceLine" id="cb82-9" title="9">p.hat&lt;-<span class="kw">uniroot</span>(<span class="cf">function</span>(p) <span class="dv">2</span><span class="op">*</span>p<span class="op">-</span>p<span class="op">^</span><span class="dv">2</span><span class="op">-</span>(na.<span class="op">+</span>nab)<span class="op">/</span>n,<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">$</span>root</a>
<a class="sourceLine" id="cb82-10" title="10">q.hat&lt;-<span class="kw">uniroot</span>(<span class="cf">function</span>(q) <span class="dv">2</span><span class="op">*</span>q<span class="op">-</span>q<span class="op">^</span><span class="dv">2</span><span class="op">-</span>(nb.<span class="op">+</span>nab)<span class="op">/</span>n,<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="op">$</span>root</a>
<a class="sourceLine" id="cb82-11" title="11">pa &lt;-<span class="st"> </span><span class="kw">c</span>(p.hat,q.hat)</a>
<a class="sourceLine" id="cb82-12" title="12"></a>
<a class="sourceLine" id="cb82-13" title="13"><span class="co"># initial estimates </span></a>
<a class="sourceLine" id="cb82-14" title="14">tol &lt;-<span class="st"> </span>.Machine<span class="op">$</span>double.eps<span class="op">^</span><span class="fl">0.5</span></a>
<a class="sourceLine" id="cb82-15" title="15">pa.old &lt;-<span class="st"> </span>pa<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb82-16" title="16">E &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb82-17" title="17"><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb82-18" title="18">  E[j]&lt;-<span class="dv">2</span><span class="op">*</span>pa[<span class="dv">1</span>]<span class="op">*</span>na.<span class="op">*</span><span class="kw">log</span>(pa[<span class="dv">1</span>])<span class="op">/</span>(<span class="dv">2</span><span class="op">-</span>pa[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>pa[<span class="dv">2</span>])<span class="op">+</span><span class="dv">2</span><span class="op">*</span>pa[<span class="dv">2</span>]<span class="op">*</span>nb.<span class="op">*</span><span class="kw">log</span>(pa[<span class="dv">2</span>])<span class="op">/</span>(<span class="dv">2</span><span class="op">-</span>pa[<span class="dv">2</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>pa[<span class="dv">1</span>])<span class="op">+</span><span class="dv">2</span><span class="op">*</span>noo<span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>pa[<span class="dv">1</span>]<span class="op">-</span>pa[<span class="dv">2</span>])<span class="op">+</span>na.<span class="op">*</span>(<span class="dv">2-2</span><span class="op">*</span>pa[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>pa[<span class="dv">2</span>])<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>pa[<span class="dv">1</span>]<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>pa[<span class="dv">1</span>]<span class="op">-</span>pa[<span class="dv">2</span>]))<span class="op">/</span>(<span class="dv">2</span><span class="op">-</span>pa[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>pa[<span class="dv">2</span>])<span class="op">+</span>nb.<span class="op">*</span>(<span class="dv">2-2</span><span class="op">*</span>pa[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>pa[<span class="dv">2</span>])<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>pa[<span class="dv">2</span>]<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>pa[<span class="dv">1</span>]<span class="op">-</span>pa[<span class="dv">2</span>]))<span class="op">/</span>(<span class="dv">2</span><span class="op">-</span>pa[<span class="dv">2</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>pa[<span class="dv">1</span>])<span class="op">+</span>nab<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>pa[<span class="dv">1</span>]<span class="op">*</span>pa[<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb82-19" title="19">  M&lt;-<span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb82-20" title="20">    P1&lt;-<span class="dv">2</span><span class="op">*</span>pa[<span class="dv">1</span>]<span class="op">*</span>na.<span class="op">/</span>((<span class="dv">2</span><span class="op">-</span>pa[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>pa[<span class="dv">2</span>])<span class="op">*</span>x[<span class="dv">1</span>])<span class="op">-</span><span class="dv">2</span><span class="op">*</span>noo<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>x[<span class="dv">1</span>]<span class="op">-</span>x[<span class="dv">2</span>])<span class="op">+</span>na.<span class="op">*</span>(<span class="dv">2-2</span><span class="op">*</span>pa[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>pa[<span class="dv">2</span>])<span class="op">*</span>(<span class="dv">1-2</span><span class="op">*</span>x[<span class="dv">1</span>]<span class="op">-</span>x[<span class="dv">2</span>])<span class="op">/</span>((<span class="dv">2</span><span class="op">-</span>pa[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>pa[<span class="dv">2</span>])<span class="op">*</span>x[<span class="dv">1</span>]<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x[<span class="dv">1</span>]<span class="op">-</span>x[<span class="dv">2</span>]))<span class="op">-</span>nb.<span class="op">*</span>(<span class="dv">2-2</span><span class="op">*</span>pa[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>pa[<span class="dv">2</span>])<span class="op">/</span>((<span class="dv">2</span><span class="op">-</span>pa[<span class="dv">2</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>pa[<span class="dv">1</span>])<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x[<span class="dv">1</span>]<span class="op">-</span>x[<span class="dv">2</span>]))<span class="op">+</span>nab<span class="op">/</span>x[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb82-21" title="21">    P2&lt;-<span class="dv">2</span><span class="op">*</span>pa[<span class="dv">2</span>]<span class="op">*</span>nb.<span class="op">/</span>((<span class="dv">2</span><span class="op">-</span>pa[<span class="dv">2</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>pa[<span class="dv">1</span>])<span class="op">*</span>x[<span class="dv">2</span>])<span class="op">-</span><span class="dv">2</span><span class="op">*</span>noo<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>x[<span class="dv">1</span>]<span class="op">-</span>x[<span class="dv">2</span>])<span class="op">-</span>na.<span class="op">*</span>(<span class="dv">2-2</span><span class="op">*</span>pa[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>pa[<span class="dv">2</span>])<span class="op">/</span>((<span class="dv">2</span><span class="op">-</span>pa[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>pa[<span class="dv">2</span>])<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x[<span class="dv">1</span>]<span class="op">-</span>x[<span class="dv">2</span>]))<span class="op">+</span>nb.<span class="op">*</span>(<span class="dv">2-2</span><span class="op">*</span>pa[<span class="dv">1</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>pa[<span class="dv">2</span>])<span class="op">*</span>(<span class="dv">1-2</span><span class="op">*</span>x[<span class="dv">2</span>]<span class="op">-</span>x[<span class="dv">1</span>])<span class="op">/</span>((<span class="dv">2</span><span class="op">-</span>pa[<span class="dv">2</span>]<span class="op">-</span><span class="dv">2</span><span class="op">*</span>pa[<span class="dv">1</span>])<span class="op">*</span>x[<span class="dv">2</span>]<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x[<span class="dv">1</span>]<span class="op">-</span>x[<span class="dv">2</span>]))<span class="op">+</span>nab<span class="op">/</span>x[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb82-22" title="22">    <span class="kw">c</span>(<span class="dt">P1=</span>P1,<span class="dt">P2=</span>P2)</a>
<a class="sourceLine" id="cb82-23" title="23">  }</a>
<a class="sourceLine" id="cb82-24" title="24">  S&lt;-<span class="kw">multiroot</span>(<span class="dt">f=</span>M,<span class="dt">star=</span><span class="kw">c</span>(.<span class="dv">1</span>,.<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb82-25" title="25">  pa&lt;-S<span class="op">$</span>root</a>
<a class="sourceLine" id="cb82-26" title="26">  <span class="co"># update p and q</span></a>
<a class="sourceLine" id="cb82-27" title="27">  <span class="cf">if</span> (<span class="kw">sum</span>(<span class="kw">abs</span>(pa<span class="op">-</span>pa.old)<span class="op">/</span>pa.old)<span class="op">&lt;</span>tol) <span class="cf">break</span></a>
<a class="sourceLine" id="cb82-28" title="28">  pa.old&lt;-pa</a>
<a class="sourceLine" id="cb82-29" title="29">}</a>
<a class="sourceLine" id="cb82-30" title="30"><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span>N,E,<span class="dt">xlab=</span><span class="st">&#39; &#39;</span>,<span class="dt">ylab=</span><span class="st">&#39; &#39;</span>,<span class="st">&#39;l&#39;</span>,<span class="dt">main=</span><span class="st">&#39;log-maximum likelihood&#39;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" title="1"><span class="kw">cat</span>(<span class="st">&quot;p=&quot;</span>,pa[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb83-2" title="2"><span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">q=&quot;</span>,pa[<span class="dv">2</span>])</a></code></pre></div>
<pre><code>## p= 0.3273442
## q= 0.3104267</code></pre>
</div>
</div>
</div>
<div id="section-33" class="section level3">
<h3>2019.12.13</h3>
<div id="question-5" class="section level4">
<h4>Question</h4>
<div id="section-34" class="section level5">
<h5>1.</h5>
<p>Use both for loops and lapply() to fit linear models to the mtcars using the formulas stored in this list:<br />
<em>formulas &lt;- list(</em><br />
<em>mpg ~ disp,</em><br />
<em>mpg ~ I(1 / disp),</em><br />
<em>mpg ~ disp + wt,</em><br />
<em>mpg ~ I(1 / disp) + wt</em><br />
<em>)</em></p>
</div>
<div id="section-35" class="section level5">
<h5>2.</h5>
<p>Fit the model mpg ~ disp to each of the bootstrap replicates of mtcars in the list below by using a for loop and lapply(). Can you do it without an anonymous function?<br />
<em>bootstraps &lt;- lapply(1:10, function(i) {</em><br />
<em>rows &lt;- sample(1:nrow(mtcars), rep = TRUE)</em><br />
<em>mtcars[rows, ]</em><br />
<em>})</em></p>
</div>
<div id="section-36" class="section level5">
<h5>3.</h5>
<p>For each model in the previous two exercises, extract R2 using the function below.<br />
<em>rsq &lt;- function(mod) summary(mod)$r.squared</em></p>
</div>
<div id="section-37" class="section level5">
<h5>4.</h5>
<p>The following code simulates the performance of a t-test for non-normal data. Use sapply() and an anonymous function to extract the p-value from every trial.<br />
<em>trials &lt;- replicate(</em><br />
<em>100,</em><br />
<em>t.test(rpois(10, 10), rpois(7, 10)),</em><br />
<em>simplify = FALSE</em><br />
<em>)</em></p>
</div>
<div id="section-38" class="section level5">
<h5>5.</h5>
<p>Implement mcsapply(), a multicore version of sapply(). Can you implement mcvapply(), a parallel version of vapply()? Why or why not?</p>
</div>
</div>
<div id="answer-6" class="section level4">
<h4>Answer</h4>
<div id="section-39" class="section level5">
<h5>1.</h5>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" title="1"><span class="kw">data</span>(<span class="st">&quot;mtcars&quot;</span>)</a>
<a class="sourceLine" id="cb85-2" title="2"><span class="kw">attach</span>(mtcars)</a>
<a class="sourceLine" id="cb85-3" title="3">formulas &lt;-<span class="st"> </span><span class="kw">list</span>(</a>
<a class="sourceLine" id="cb85-4" title="4">  mpg <span class="op">~</span><span class="st"> </span>disp,</a>
<a class="sourceLine" id="cb85-5" title="5">  mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),</a>
<a class="sourceLine" id="cb85-6" title="6">  mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,</a>
<a class="sourceLine" id="cb85-7" title="7">  mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt</a>
<a class="sourceLine" id="cb85-8" title="8">)</a>
<a class="sourceLine" id="cb85-9" title="9"></a>
<a class="sourceLine" id="cb85-10" title="10"><span class="co">#using fuction &quot;lapply&quot;</span></a>
<a class="sourceLine" id="cb85-11" title="11">m1&lt;-<span class="kw">lapply</span>(formulas, lm)</a>
<a class="sourceLine" id="cb85-12" title="12"><span class="kw">print</span>(m1)</a></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" title="1"><span class="co">#using loop</span></a>
<a class="sourceLine" id="cb87-2" title="2"><span class="cf">for</span> (x <span class="cf">in</span> formulas) {</a>
<a class="sourceLine" id="cb87-3" title="3">  <span class="kw">print</span>(<span class="kw">lm</span>(x))</a>
<a class="sourceLine" id="cb87-4" title="4">}</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = x)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## Call:
## lm(formula = x)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## Call:
## lm(formula = x)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## Call:
## lm(formula = x)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
</div>
<div id="section-40" class="section level5">
<h5>2.</h5>
<p>If we don’t want use an anonymous function, we can use the function“lapply” in a special way by adding some commands. Besides, we can also bootstrap only in “mpg” and its corresponding “disp”, which is showed below. Both two ways are avoid using an anonymous function.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" title="1"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb89-2" title="2">bootstraps &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</a>
<a class="sourceLine" id="cb89-3" title="3">  rows &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(mtcars), <span class="dt">rep =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb89-4" title="4">  mtcars[rows,]</a>
<a class="sourceLine" id="cb89-5" title="5">})</a>
<a class="sourceLine" id="cb89-6" title="6"><span class="co">#using fuction &quot;lapply&quot;</span></a>
<a class="sourceLine" id="cb89-7" title="7">m2&lt;-<span class="kw">lapply</span>(<span class="kw">seq_along</span>(bootstraps),<span class="cf">function</span>(i) {<span class="kw">lm</span>(bootstraps[[i]]<span class="op">$</span>mpg<span class="op">~</span>bootstraps[[i]]<span class="op">$</span>disp)})</a>
<a class="sourceLine" id="cb89-8" title="8"><span class="kw">print</span>(m2)</a></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = bootstraps[[i]]$mpg ~ bootstraps[[i]]$disp)
## 
## Coefficients:
##          (Intercept)  bootstraps[[i]]$disp  
##              30.0287               -0.0434  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = bootstraps[[i]]$mpg ~ bootstraps[[i]]$disp)
## 
## Coefficients:
##          (Intercept)  bootstraps[[i]]$disp  
##             29.44060              -0.03799  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = bootstraps[[i]]$mpg ~ bootstraps[[i]]$disp)
## 
## Coefficients:
##          (Intercept)  bootstraps[[i]]$disp  
##             28.92155              -0.03918  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = bootstraps[[i]]$mpg ~ bootstraps[[i]]$disp)
## 
## Coefficients:
##          (Intercept)  bootstraps[[i]]$disp  
##             29.10046              -0.04044  
## 
## 
## [[5]]
## 
## Call:
## lm(formula = bootstraps[[i]]$mpg ~ bootstraps[[i]]$disp)
## 
## Coefficients:
##          (Intercept)  bootstraps[[i]]$disp  
##             30.76035              -0.04505  
## 
## 
## [[6]]
## 
## Call:
## lm(formula = bootstraps[[i]]$mpg ~ bootstraps[[i]]$disp)
## 
## Coefficients:
##          (Intercept)  bootstraps[[i]]$disp  
##             31.49804              -0.04948  
## 
## 
## [[7]]
## 
## Call:
## lm(formula = bootstraps[[i]]$mpg ~ bootstraps[[i]]$disp)
## 
## Coefficients:
##          (Intercept)  bootstraps[[i]]$disp  
##             29.77795              -0.04433  
## 
## 
## [[8]]
## 
## Call:
## lm(formula = bootstraps[[i]]$mpg ~ bootstraps[[i]]$disp)
## 
## Coefficients:
##          (Intercept)  bootstraps[[i]]$disp  
##             31.23589              -0.04872  
## 
## 
## [[9]]
## 
## Call:
## lm(formula = bootstraps[[i]]$mpg ~ bootstraps[[i]]$disp)
## 
## Coefficients:
##          (Intercept)  bootstraps[[i]]$disp  
##             27.47647              -0.03299  
## 
## 
## [[10]]
## 
## Call:
## lm(formula = bootstraps[[i]]$mpg ~ bootstraps[[i]]$disp)
## 
## Coefficients:
##          (Intercept)  bootstraps[[i]]$disp  
##             28.61819              -0.03719</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" title="1"><span class="co">#using loop</span></a>
<a class="sourceLine" id="cb91-2" title="2"><span class="cf">for</span> (x <span class="cf">in</span> bootstraps) {</a>
<a class="sourceLine" id="cb91-3" title="3">  <span class="kw">print</span>(<span class="kw">lm</span>(mpg<span class="op">~</span>disp))</a>
<a class="sourceLine" id="cb91-4" title="4">}</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = mpg ~ disp)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## Call:
## lm(formula = mpg ~ disp)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## Call:
## lm(formula = mpg ~ disp)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## Call:
## lm(formula = mpg ~ disp)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## Call:
## lm(formula = mpg ~ disp)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## Call:
## lm(formula = mpg ~ disp)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## Call:
## lm(formula = mpg ~ disp)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## Call:
## lm(formula = mpg ~ disp)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## Call:
## lm(formula = mpg ~ disp)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## Call:
## lm(formula = mpg ~ disp)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" title="1"><span class="co">#without an anonymous function </span></a>
<a class="sourceLine" id="cb93-2" title="2">m2&lt;-<span class="kw">lapply</span>(bootstraps, lm, <span class="dt">formula=</span>mpg<span class="op">~</span>disp)</a>
<a class="sourceLine" id="cb93-3" title="3"><span class="kw">print</span>(m2)</a></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##     30.0287      -0.0434  
## 
## 
## [[2]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.44060     -0.03799  
## 
## 
## [[3]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.92155     -0.03918  
## 
## 
## [[4]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.10046     -0.04044  
## 
## 
## [[5]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.76035     -0.04505  
## 
## 
## [[6]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    31.49804     -0.04948  
## 
## 
## [[7]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.77795     -0.04433  
## 
## 
## [[8]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    31.23589     -0.04872  
## 
## 
## [[9]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    27.47647     -0.03299  
## 
## 
## [[10]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.61819     -0.03719</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" title="1"><span class="co"># there are another way which also not using an anonymous function</span></a>
<a class="sourceLine" id="cb95-2" title="2">bootstraps1 &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</a>
<a class="sourceLine" id="cb95-3" title="3">  rows &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(mtcars), <span class="dt">rep =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb95-4" title="4">  mtcars[rows,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)]</a>
<a class="sourceLine" id="cb95-5" title="5">})</a>
<a class="sourceLine" id="cb95-6" title="6"><span class="co">#using fuction &quot;lapply&quot;(without an anonymous function)</span></a>
<a class="sourceLine" id="cb95-7" title="7"><span class="kw">lapply</span>(bootstraps1, lm)</a></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.62902     -0.03916  
## 
## 
## [[2]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.98527     -0.03813  
## 
## 
## [[3]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.41508     -0.03828  
## 
## 
## [[4]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.86877     -0.04647  
## 
## 
## [[5]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.52220     -0.03762  
## 
## 
## [[6]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    27.45020     -0.03641  
## 
## 
## [[7]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.81769     -0.03972  
## 
## 
## [[8]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.92344     -0.03997  
## 
## 
## [[9]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.00493     -0.03795  
## 
## 
## [[10]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.44821     -0.03436</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" title="1"><span class="co">#using loop(without an anonymous function)</span></a>
<a class="sourceLine" id="cb97-2" title="2"><span class="cf">for</span> (x <span class="cf">in</span> bootstraps1) {</a>
<a class="sourceLine" id="cb97-3" title="3">  <span class="kw">print</span>(<span class="kw">lm</span>(x))</a>
<a class="sourceLine" id="cb97-4" title="4">}</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = x)
## 
## Coefficients:
## (Intercept)         disp  
##    28.62902     -0.03916  
## 
## 
## Call:
## lm(formula = x)
## 
## Coefficients:
## (Intercept)         disp  
##    28.98527     -0.03813  
## 
## 
## Call:
## lm(formula = x)
## 
## Coefficients:
## (Intercept)         disp  
##    28.41508     -0.03828  
## 
## 
## Call:
## lm(formula = x)
## 
## Coefficients:
## (Intercept)         disp  
##    30.86877     -0.04647  
## 
## 
## Call:
## lm(formula = x)
## 
## Coefficients:
## (Intercept)         disp  
##    28.52220     -0.03762  
## 
## 
## Call:
## lm(formula = x)
## 
## Coefficients:
## (Intercept)         disp  
##    27.45020     -0.03641  
## 
## 
## Call:
## lm(formula = x)
## 
## Coefficients:
## (Intercept)         disp  
##    28.81769     -0.03972  
## 
## 
## Call:
## lm(formula = x)
## 
## Coefficients:
## (Intercept)         disp  
##    29.92344     -0.03997  
## 
## 
## Call:
## lm(formula = x)
## 
## Coefficients:
## (Intercept)         disp  
##    29.00493     -0.03795  
## 
## 
## Call:
## lm(formula = x)
## 
## Coefficients:
## (Intercept)         disp  
##    28.44821     -0.03436</code></pre>
</div>
<div id="section-41" class="section level5">
<h5>3</h5>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" title="1">rsq &lt;-<span class="st"> </span><span class="cf">function</span>(mod) <span class="kw">summary</span>(mod)<span class="op">$</span>r.squared</a>
<a class="sourceLine" id="cb99-2" title="2"><span class="co">#R^2 in question 1</span></a>
<a class="sourceLine" id="cb99-3" title="3"><span class="kw">lapply</span>(m1, rsq)</a></code></pre></div>
<pre><code>## [[1]]
## [1] 0.7183433
## 
## [[2]]
## [1] 0.8596865
## 
## [[3]]
## [1] 0.7809306
## 
## [[4]]
## [1] 0.8838038</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb101-1" title="1"><span class="co">#R^2 in question 2</span></a>
<a class="sourceLine" id="cb101-2" title="2"><span class="kw">lapply</span>(m2, rsq)</a></code></pre></div>
<pre><code>## [[1]]
## [1] 0.7475099
## 
## [[2]]
## [1] 0.7179526
## 
## [[3]]
## [1] 0.7571433
## 
## [[4]]
## [1] 0.6921848
## 
## [[5]]
## [1] 0.8488426
## 
## [[6]]
## [1] 0.7702828
## 
## [[7]]
## [1] 0.7491175
## 
## [[8]]
## [1] 0.7843995
## 
## [[9]]
## [1] 0.677981
## 
## [[10]]
## [1] 0.7887093</code></pre>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb103-1" title="1"><span class="kw">detach</span>(mtcars)</a></code></pre></div>
</div>
<div id="section-42" class="section level5">
<h5>4.</h5>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb104-1" title="1"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb104-2" title="2">trials &lt;-<span class="st"> </span><span class="kw">replicate</span>(</a>
<a class="sourceLine" id="cb104-3" title="3">  <span class="dv">100</span>,</a>
<a class="sourceLine" id="cb104-4" title="4">  <span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</a>
<a class="sourceLine" id="cb104-5" title="5">  <span class="dt">simplify =</span> <span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb104-6" title="6">)</a>
<a class="sourceLine" id="cb104-7" title="7"><span class="kw">sapply</span>(<span class="kw">seq_along</span>(trials),<span class="cf">function</span>(i) {<span class="kw">round</span>(trials[[i]]<span class="op">$</span>p.value,<span class="dv">4</span>)})</a></code></pre></div>
<pre><code>##   [1] 0.9813 0.0000 0.6242 0.6694 0.5677 0.6611 0.5952 0.5005 0.4763 0.3430
##  [11] 0.8155 0.7197 0.1244 0.2229 0.0111 0.4626 0.6516 0.1659 0.9343 0.8012
##  [21] 0.4628 0.5928 0.2930 0.5738 0.0345 0.2739 0.2656 0.8197 0.6647 0.8057
##  [31] 0.5061 0.7107 0.2321 0.1106 0.5459 0.0187 0.2434 0.2689 0.9819 0.4940
##  [41] 0.3268 0.8000 0.9822 0.1936 0.7390 0.0389 0.4350 0.0743 0.5787 0.4865
##  [51] 0.1476 0.5525 0.7129 0.0087 0.0905 0.4415 0.4955 0.1745 0.6615 0.4479
##  [61] 0.2886 0.0303 0.1019 0.0181 0.6376 0.0141 0.0901 0.4516 0.8703 0.7251
##  [71] 0.8184 0.8465 0.8787 0.1652 0.3952 0.1754 0.3650 0.0722 0.6565 0.9947
##  [81] 0.3716 0.0842 0.4550 0.8530 0.1971 0.2298 0.1149 0.7770 0.4934 0.3526
##  [91] 0.2036 0.8839 0.0647 0.4089 0.5780 0.8011 0.5956 0.9267 0.0992 0.1764</code></pre>
</div>
<div id="section-43" class="section level5">
<h5>5.</h5>
<p>Just like the function “lapply” and “mclapply”, we can get the function “mcsapply” and use it.<br />
However, I don’t think the function “mcvapply()” is practical, because the implement of “sapply” needs to set the parameter—“function value”, which seems not easy to apply it to each cores meanwhile.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb106-1" title="1"><span class="kw">library</span>(parallel)</a>
<a class="sourceLine" id="cb106-2" title="2"></a>
<a class="sourceLine" id="cb106-3" title="3">num_cores =<span class="st"> </span><span class="kw">detectCores</span>()</a>
<a class="sourceLine" id="cb106-4" title="4">cluster =<span class="st"> </span><span class="kw">makePSOCKcluster</span>(num_cores)</a>
<a class="sourceLine" id="cb106-5" title="5"></a>
<a class="sourceLine" id="cb106-6" title="6">mcsapply =<span class="st"> </span><span class="cf">function</span>(cluster,X,FUN,...){</a>
<a class="sourceLine" id="cb106-7" title="7"> res =<span class="st"> </span><span class="kw">parLapply</span>(cluster,X,FUN,...) </a>
<a class="sourceLine" id="cb106-8" title="8"> <span class="kw">simplify2array</span>(res)</a>
<a class="sourceLine" id="cb106-9" title="9">}</a>
<a class="sourceLine" id="cb106-10" title="10"></a>
<a class="sourceLine" id="cb106-11" title="11"><span class="kw">system.time</span>(<span class="kw">mcsapply</span>(cluster, <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) <span class="kw">Sys.sleep</span>(<span class="dv">1</span>)))</a></code></pre></div>
<pre><code>## 用户 系统 流逝 
## 0.00 0.00 3.05</code></pre>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb108-1" title="1"><span class="kw">system.time</span>(<span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) <span class="kw">Sys.sleep</span>(<span class="dv">1</span>)))</a></code></pre></div>
<pre><code>##  用户  系统  流逝 
##  0.00  0.00 10.01</code></pre>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb110-1" title="1"><span class="kw">stopCluster</span>(cluster)</a></code></pre></div>
</div>
</div>
</div>
<div id="section-44" class="section level3">
<h3>2019.12.20</h3>
<div id="question-6" class="section level4">
<h4>Question</h4>
<p>You have already written an R function for Exercise 9.4 (page 277, Statistical Computing with R). Rewrite an Rcpp function for the same task.<br />
(1)Compare the generated random numbers by the two functions using qqplot.<br />
(2) Campare the computation time of the two functions with microbenchmark.<br />
(3) Comments your results.</p>
</div>
<div id="answer-7" class="section level4">
<h4>Answer</h4>
<p>Both functions are showed in the code below. By compare the results of two functions and their qqplot, we can find that the chains generated by two functions are similar (while sigma is small, the chain is not good and the chains generated by two functions may different). However, compare the computing time, we can easily find that the cpp function is more efficient than R function under different sigma. Thus, The cpp function performs better than R function in this case.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb111-1" title="1"><span class="kw">library</span>(Rcpp)</a>
<a class="sourceLine" id="cb111-2" title="2"><span class="kw">library</span>(microbenchmark)</a>
<a class="sourceLine" id="cb111-3" title="3"><span class="co">#define cpp function</span></a>
<a class="sourceLine" id="cb111-4" title="4"><span class="kw">cppFunction</span>(<span class="st">&#39;NumericMatrix rwMC(double sigma, double x0, int N){</span></a>
<a class="sourceLine" id="cb111-5" title="5"><span class="st">  NumericMatrix x(N,2);</span></a>
<a class="sourceLine" id="cb111-6" title="6"><span class="st">  x(0,0) = x0;</span></a>
<a class="sourceLine" id="cb111-7" title="7"><span class="st">  x(0,1) = 1;</span></a>
<a class="sourceLine" id="cb111-8" title="8"><span class="st">  NumericVector u(N);</span></a>
<a class="sourceLine" id="cb111-9" title="9"><span class="st">  u=runif(N);</span></a>
<a class="sourceLine" id="cb111-10" title="10"><span class="st">  for (int i=1;i&lt;N; i++) {</span></a>
<a class="sourceLine" id="cb111-11" title="11"><span class="st">    double y = rnorm(1, x[i-1], sigma)[0];</span></a>
<a class="sourceLine" id="cb111-12" title="12"><span class="st">    double t = exp(-abs(y)) / exp(-abs(x[i-1]));</span></a>
<a class="sourceLine" id="cb111-13" title="13"><span class="st">      if (u[i] &lt;= t) {</span></a>
<a class="sourceLine" id="cb111-14" title="14"><span class="st">        x(i,0) = y; </span></a>
<a class="sourceLine" id="cb111-15" title="15"><span class="st">        x(i,1) = 1;</span></a>
<a class="sourceLine" id="cb111-16" title="16"><span class="st">      }else {</span></a>
<a class="sourceLine" id="cb111-17" title="17"><span class="st">        x(i,0) = x(i-1,0);</span></a>
<a class="sourceLine" id="cb111-18" title="18"><span class="st">        x(i,1) = 0;</span></a>
<a class="sourceLine" id="cb111-19" title="19"><span class="st">      }</span></a>
<a class="sourceLine" id="cb111-20" title="20"><span class="st">  };</span></a>
<a class="sourceLine" id="cb111-21" title="21"><span class="st">  return x;</span></a>
<a class="sourceLine" id="cb111-22" title="22"><span class="st">}&#39;</span>)</a>
<a class="sourceLine" id="cb111-23" title="23"><span class="co">#define R function</span></a>
<a class="sourceLine" id="cb111-24" title="24">rwMR &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, x0, N){</a>
<a class="sourceLine" id="cb111-25" title="25">  x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb111-26" title="26">  x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</a>
<a class="sourceLine" id="cb111-27" title="27">  u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</a>
<a class="sourceLine" id="cb111-28" title="28">  k &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb111-29" title="29">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb111-30" title="30">    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</a>
<a class="sourceLine" id="cb111-31" title="31">    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(y)) <span class="op">/</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x[i<span class="dv">-1</span>])))) x[i] =<span class="st"> </span>y </a>
<a class="sourceLine" id="cb111-32" title="32">    <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb111-33" title="33">      x[i] =<span class="st"> </span>x[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb111-34" title="34">      k =<span class="st"> </span>k<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb111-35" title="35">    }</a>
<a class="sourceLine" id="cb111-36" title="36">  }</a>
<a class="sourceLine" id="cb111-37" title="37">  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x =</span> x, <span class="dt">k =</span> k))</a>
<a class="sourceLine" id="cb111-38" title="38">}</a>
<a class="sourceLine" id="cb111-39" title="39"><span class="co"># the plot with sigma=2</span></a>
<a class="sourceLine" id="cb111-40" title="40">out1&lt;-<span class="kw">rwMC</span>(<span class="dv">2</span>,<span class="dv">20</span>,<span class="dv">2000</span>)</a>
<a class="sourceLine" id="cb111-41" title="41">out2&lt;-<span class="kw">rwMR</span>(<span class="dv">2</span>,<span class="dv">20</span>,<span class="dv">2000</span>)</a>
<a class="sourceLine" id="cb111-42" title="42"><span class="kw">plot</span>(out1[,<span class="dv">1</span>], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">main=</span><span class="st">&#39;rwMC(sigma=2)&#39;</span>, <span class="dt">ylab=</span><span class="st">&quot;x&quot;</span>,<span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAvVBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZmYAZpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZmY6ZpA6ZrY6kLY6kNtmAABmOgBmOjpmOpBmkLZmtrZmtttmtv+QOgCQOjqQOmaQZgCQZjqQkDqQkGaQkLaQtpCQttuQtv+Q27aQ2/+2ZgC2Zjq2kDq2kGa229u22/+2///bkDrbkGbbtmbbtpDb27bb29vb2//b////tmb/25D/27b//7b//9v////3lp/jAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJ30lEQVR4nO2dCWObNhiGlazZ4i6743Zb092X3a0J7Q6T2Pz/nzVdCIGAF7Bsy/b7dGs4pE/osQ5IAYuC9CIOfQCpQ0EACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEOIWgphLhalUvXamHz/kYufnqv96/nFwsv+ea1TT2ap5c26OPs8mHiwR5KkFawnltB6xfCcKv2Z3UhkwXlMx1TFiVD3E482EMJ0gf8ODOC5PGX3BXb1KaGjHO5UGVIvdnURrhbQZm4+PWFuHyhj26pa5/Lv+XSJ3pTJowg+fPZb7JHvNZdLzfN653sdBdf3LsWtHkjUy2W4vJBNrzrv2/Exavi3UxuUiX9rZrgpwvr3LSb9cuZap0qh9p8N60OOxakuHqvaqy60605XCno85lu+Jc/KUHqo9ZDxOa7L/9TudSayasWjSDTyi5ujCDDjU2htNvO5AmyB6EFySwTW+WuBV3dF//qj08duXZxrdrSK9WNHmdXf6qNqkVUmXQSvW1VvFdSjSDp4Hq1WQor6FbtE69UETrFRytVwm0oyHQxWebEPrZrQaph6ypn+sPWrpa6m12tcnGbKUG6Zg6jS2579tZsMIJ0Q1A7tSC5wfzt8v7z143wPVfR9DEsxcR5bNdj0ML8vFotxYdy9tbdRwnKdVe7axFk1kyP+uCblRVUTmXlGOSJVKl/NM0mEPQ0t2cUmaidOgxnL4LksPvHXHerpWkMFwtZsW+lsDzsYlbXk5n5L343gso0rYKUzWe//DM3sr0uptZM10pbkKyLGpUz2YjMQH2x0C1E9bL6IC1nLdeenn6+0WlwCzJZ1oGgyk/iguy5c26PWwmyJ9F5OM37HW7zg/TRNgbVBeV6nAkG6fXc+UldUC5sV7Izityc65NFWZ/miaKpuNz91Ur1s7Lx1GexoAVdrZTe+hi0rPwkPkjrz/VOe/BP3cxpS+1S48tymi/euIbQdh4UjkHhIO0ak1KT6jRvBckaqKXMm3LNwGMFlRerb00uXRd3+eqdSX923z2LPfstq7eSTFSCpl++JPjrjrxvuJjYEh5nE4egFAXJT7vlummp+1/Z4saSp3mxOpGsTULevMYaxfKoft2BWM/bZpynlzN7eT+eI/uF2VFBQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAkQWJI6GQwmKG253UBCAggB7FtTo2keg6bAtiIJAOAoC4SgIhKMgEI6CQDgKAuEoCISjIBQufUMUBKAgwE4ErefqiRD1VEnnkw8UVGTquaL1vONFDxRk1WQdj19R0ONMC8o7OhkFsQX1YN66op9Snnc8wHfeggrtSD/z3vWA49kLGhiOgppRGv/cREEgHAWBcGcqyL07rPti47wFqbeygcfPz1yQNAReDHHuguQZUP/rCM9e0MBwFATCURAIR0EgHAWBcBQEwlEQCEdBIBwFgXAUBMJREAhHQSAcBYFwFNSM0vyddPKGDt2CKKg/HAWBcBQEwlEQCEdBIBwFgXCnKGjzX8RyT1HQem7+yWvz/dRXU3vhTlGQfdd+NvX7J+rhTlGQ/XaK7b4c7qQFaUMTv8etGe4kBZnvRZv69Qr1cCcoyH7JXR5nDEre0ARBX5umE2UWO0VBkcs9S0HDH2Y5Z0GDHmY5Y0HDHkU4Y0HtD7OEr+U5W0FsQT0Mf5gltqAB0UZeH+9qmh/4MEuqgkTL0vZFj+HAgvrS1fenKGiLonqyuqu/oxUkyhUKKrCgacX1jS9nIAgfQpcg4e06DUGtNRWtK/5WLEioheD1kUHkRAWpY9d/yo+5VnlrUDSqILwoXRUPBYl22+VKSoK8mtoPd6eChCeo8SmJaiU1QcIslIJEJajWwGqChO/GVb9egKj+7xJUhi18Qc04o2oUB1+Q/eMJEk1BoqyJTWmGkXKr3V5VzLVBm8J7tWWLIOEJEl7mcfXev6BqRHIqRCjIOmgT5KL5ynsFVVGLhASJhiDhBNl9riWIXkFexQYJEn2Cmv1uRI3iUBPkFLULavlZeCmqYctV2woqbfhtUvg7RLXJE1QdQjqCRCio8bO+pQh2FUGWNkFeniZF4f9IT5CAgpp7Ru8AgoIgiQpqVKG7RsOpF9If8cCCGqVvIwhWdVouf4A6gKAwXKCi8FeGCRohaqDWovSTuKC26nhW6vNbV0Vri37Eoj9fOoIKd7zlRN1oR7XmVKW2NSz6Ktoc9f12VxTNXW49RUFurap6MP0EgsqKVNVqJCrqcm3Zojzz8eO79fJcc1y9dynIGxKFd2URnsBU539NQS5LJagqoApiyz4tQWVyX1DRK6jwbJR2bXqb2KUqG6Y9ohQFFV2C3EVRmbIUVF1M+BmGC7K+3aIvyKVKSFARCnK76uvemYmrcLPafqIym612axWE999RCKqnaQqrcjTSljuCjWXLK5Agu3bMgmo5Wl20HqZrPT2CqrVkBbUU0ydoxBG1xg4PpJE6LUHtldiLIBQ9ZUHFyQoafxNnp6CWcncraGop4wUNvInTru5SUEeZw3LtTNDQW/Ds6ghBY48oUUHD3kjuVicIGso0QaMz7bYFdX1gJytInfkNu4mzf3uMuTNBQUXnTZzCMS7cNmxX1MHPg3ZPuoI2r7sf26SggoIgiQjaDgoCUBDgDGax7TiYoKPhQILGBR2Y7iDJJiaPG5SC4qSjoBSTTUweNygFxUlHQSkmm5g8blAKipPu9ASdEhQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAgQX1Au9Ju7O6juMXLp+jP08fjxQ+yQAdEF5er+oe6je3y+aKQDGXpYz/WNgDFDhsQWZP5detn5ldDlzY0uHcrQTW5vR44YsoXYgsxNnlnnjdTZdSMdytBJLm6Nmngh24guSLf3rptg5ef6idDvzXfpUIY+TK6oIQNiCzJdv3MAWM/V7bHL2yodyNBfmHIQN2TAngXZRJcP8QTFDRmw7y5mEs3uInaxqCED9j1Im0TPF1FGVF9QpJABe57mzbHLikWZk7WguCED9n2iqA9bjqhRzursLBYzZED8S42s/zR/KezXv7h0IEMPtovFDBnAi1UABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIA/wMFNZ59hXn7SQAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb112-1" title="1"><span class="kw">plot</span>(out2<span class="op">$</span>x,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">main=</span><span class="st">&#39;rwMR(sigma=2)&#39;</span>, <span class="dt">ylab=</span><span class="st">&quot;x&quot;</span>,<span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAulBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZmYAZpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZmY6ZpA6ZrY6kLY6kNtmAABmOgBmOjpmOpBmkLZmtrZmtttmtv+QOgCQOmaQZgCQZjqQkDqQkGaQkLaQtpCQttuQtv+Q27aQ2/+2ZgC2Zjq2kDq2kGa229u22/+2///bkDrbkGbbtmbbtpDb27bb29vb2//b////tmb/25D/27b//7b//9v///+VAYwxAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJ2klEQVR4nO2da2OjuBmFlTRp7W2213im7STd3ra1d9sJO7utSWz9/79VXUASAnEwFjaxz/NhxkbiRXqQhHC4CEl6EecuwNyhIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCAOcQtBFC3G/rTwu5fxaGm1991gt3q5t1kFul2swH8/ZRBdUxX5e3L2MLey5BxsFu1RBULS2aQkYLKpd1TBXicWxhzyXIlPh1GQlSX+QxtQlRcW7XehNKbzG2EU4sqBA3//ggbj+Y4iktT2q3qn/Vp6/NokLUgkz5bWVK245+eFA7/7efXQvafyfE3Xojbl9Uu1v8+CBuPskflmqR3tCPH3RnWlfKbbvZfVwq3VKvoRc/jazDxII09190lXV3erTlVYJ+szQt//avoSCVaPa2HjDsqvqjTbWt7ObBCrI8VDm09aozBYKqMhhBapWxrXJqQfef5X/N/tNFNy4Wui190v3odXn/fasFmRy6Rout/KKd2lTlYLHdb0Ql6FGniU96CybHL7Z67ce2INsqrfpRTC1It2xT58LsbeNqY7rZ/bYUj0U0Bj0aNaZed/+xQawg0xB0ohGkFth/jRXNT/9+MCNYhJapi2BXH8PUY9Da/n+/3Yifq8O36T9aUGm62lMkaFFX2S762R+3laC6kdVjkPQide6/uCG+yduqmlAUojF1OICTCFLj7r9WplttbGu4Waua/UkJK0NBd9/Kusry7YPtKf+Uxo3VkRCk17/7+096QbOL6W+2a81ckKqMHpUL1YjsQH2zNlJ0L6vHoP33tjKu07z97cFkwS3IrrJrCfJ+5i6omjuXVcG1oGoSXQaDtOluXpBi/43y0TUGNQWVZpxpDdK7lfMze0GlsVGX2AgqzZCsKuSPYmamZCuuUn+/1f2sbjzNo1irBd1v357jMWjj/cx9kDY79knuqzrUczc7b2kc5k2D0Xm+cw2hax7UHoPag7RrTFrNbA/zlSBVBf2pCI65+kzgpSlI7/NFfVrw5aE60wxm0r/+nD6K3X1bNFtJIbygI05f5vdzR9k3XIxsCa/LsUPQDAWpvd1x3qQa1++kbXAjKGd6sjqOoktCGZ9jHcTmff3cAdituo44bx+X1en94by3H8zeFRQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCBAZkHi3XAuQXnDTQcFASgIcGJBUdd+B5rO24IoCIWbvyEKAlAQgIIAFASgIAAFASgIQEGASQTtVvqOB33XRPLKfgqShb5vZrdKPMiAgio1ReL2Igp6XRpBZaKTURBbUA/2qSILWQ/X6XBXKkgaR+aW7tQNfFcvaGA4CoqjRH9NoSAQjoJAuCsV5J6NlT7ZuG5Bcv+Mbq++ckFy/wwefHDtgtQMqP9xe1cvaGA4CgLhKAiEoyAQjoJAOAoC4SgIhKMgEI6CQDgKAuEoCISjIBBu+HXa5+LcP7lSUH84CkLhKAiEoyAQjoJAOAoC4SgIhKMgEI6CQLgLFLT/X87tXqCg3cr+TXD/59HPppYXLah62H4x+gUUjXCXKEjuzespjns73EULktrQ2Be5ReEuUpB9L1rP+xWGX2l/iYKqt9yVPWPQ8CvtjxB0IrUjBP3BNp2eo9jw66QvUdAA0lfatx6Jcb2CTtKCTiBpIkFDr7SfVlAOf1Odiw280v5YQf2rz1nQ0HDTCVJpFy5oQPMQPf3sYgW5JVkEHf13pbkKiuvWnW8SQaLn2+DVjiYpSLQEie7NpwQJn3ZRgqI/RvcKckv6BYm2oCG1mLcgcaCgloPamUgJElHeqByXIEj4xtNwIHxipyBhvokoRpgmZZfSw2qUiUiQf6pZLEgEgoSvnKgFuZqJQwQJHyNMCzcbFXRwjTLhBNliVbVxokQoyA00LrOtnOgQ5GoeCPI7IxQkwp3RFBROoc4tyNTL11S4ivteUC2TDZtCOAtVrZ2gIKkW5BQKP4D7wPW+CYLPUpDoFhQU2Kc2cRritECQkyBEKCjcpgztH1zvSQU19rsXJGRQ4baXsI6yM4NvHYHIRtSGpzDIrAXVdYOgPLKZqdOibPwXJsxEkIgFDaq8hHlk60PCQ3Jz5xAUbb25qKeSiZRBgrqXxskzEdQRrq8+BwmKB+jWosYSMLrNSFB3E5eN6nR1DJeeyJQSFAzsqd5VL5+joPC43qp7Y6/7Q131IWoTqeNVY4bkXM1ZkJQde7MWJN2MurHX62lPvUQ2D4eyrp4LF67qJ+rxzgimGbM5itlv/jwjEBQkuolyfZJRf2tmaAvy+etpp9uem6j7EwwvSM5SUGNO10gMBcmUID+3bAqSQwQFEbzQQ+o9rSBZG3CtO96eGxE6BPlMgaVwWacgv+GwFCKI3y7o4BodzUhB0gnqLFPdKmJBPnMkKIocxJ+jIPcNCkqVqU9QuEqfoKBtdW4jxaSCorTebUFBkoKSQQYL6ixK52YnEXTAFWZHJb5vQcOuMDsqcbSg4VubTtDA64OOSuwTFC0bzWSChj3LdcS2DhbUFwxzBS2oLxhmIkF6tjfoCrO8iV3daY6CZPIKs+AnhbHbGj9BGMUc50FTJY5iSkH75/T9HBNVk4IAVyJoPBQEoCDA+xJ0wnDThaWgXBEp6LSbpqDThpsOCgJQEICCAGcT9G44k6DDgg7Md5ZsI7PnDUpBefJR0ByzjcyeNygF5clHQXPMNjJ73qAUlCff5Qm6JCgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBAgv6BSmCd3J/CXErt8/Sv08frLl9whW2QXVOrLhNOle/1qHeUDK/SwW5nr/XOGbJNbkL38bJN8Z3Z9D4PLh1ZIU1Z3HWUM2UFuQfZejiJ5v1SxiPKhFZKU4tGqyReyi+yCTHtP3eui9uvXwjw33+VDK/Rh18oaskVuQbbrJweA3UrfBbN59PnACv0b0w7yhmxxYkFVptuXfILyhmxx6i5mMy2fMnaxrCFbnHqQtpm+WmcZUUNBmUK2OPFh3pZdVSzLMdkIyhuyxakniqbYakTNMqurjmI5Q7bIf6pR9E/zN6J6/YvLB1booepiOUO24MkqgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBgP8DSi+NjcNMziYAAAAASUVORK5CYII=" /><!-- --></p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb113-1" title="1"><span class="co">#compare the generated random numbers</span></a>
<a class="sourceLine" id="cb113-2" title="2"><span class="kw">qqplot</span>(out1[,<span class="dv">1</span>],out2<span class="op">$</span>x,<span class="dt">xlab =</span> <span class="st">&#39;rwMR&#39;</span>,<span class="dt">ylab =</span> <span class="st">&#39;rwMC&#39;</span>,<span class="dt">main=</span><span class="st">&#39;qqplot of two functions(sigma=2)&#39;</span>)</a>
<a class="sourceLine" id="cb113-3" title="3"><span class="kw">abline</span>(<span class="dt">a=</span><span class="dv">0</span>,<span class="dt">b=</span><span class="dv">1</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb114-1" title="1"><span class="co">#compare the computation time</span></a>
<a class="sourceLine" id="cb114-2" title="2">ts &lt;-<span class="st"> </span><span class="kw">microbenchmark</span>(<span class="dt">r=</span><span class="kw">rwMR</span>(<span class="dv">2</span>,<span class="dv">20</span>,<span class="dv">2000</span>),<span class="dt">cpp=</span><span class="kw">rwMC</span>(<span class="dv">2</span>,<span class="dv">20</span>,<span class="dv">2000</span>))</a>
<a class="sourceLine" id="cb114-3" title="3"><span class="kw">summary</span>(ts)</a></code></pre></div>
<pre><code>##   expr    min     lq     mean median      uq     max neval
## 1    r 5497.2 5946.8 7168.461 6159.3 6752.85 14906.4   100
## 2  cpp  362.1  378.0  516.949  408.5  462.05  7146.7   100</code></pre>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb116-1" title="1"><span class="co"># the plot with sigma=10</span></a>
<a class="sourceLine" id="cb116-2" title="2">out1&lt;-<span class="kw">rwMC</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">2000</span>)</a>
<a class="sourceLine" id="cb116-3" title="3">out2&lt;-<span class="kw">rwMR</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">2000</span>)</a>
<a class="sourceLine" id="cb116-4" title="4"><span class="kw">plot</span>(out1[,<span class="dv">1</span>], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">main=</span><span class="st">&#39;rwMC(sigma=10)&#39;</span>, <span class="dt">ylab=</span><span class="st">&quot;x&quot;</span>,<span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb117-1" title="1"><span class="kw">plot</span>(out2<span class="op">$</span>x,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">main=</span><span class="st">&#39;rwMR(sigma=10)&#39;</span>, <span class="dt">ylab=</span><span class="st">&quot;x&quot;</span>,<span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb118-1" title="1"><span class="co">#compare the generated random numbers</span></a>
<a class="sourceLine" id="cb118-2" title="2"><span class="kw">qqplot</span>(out1[,<span class="dv">1</span>],out2<span class="op">$</span>x,<span class="dt">xlab =</span> <span class="st">&#39;rwMR&#39;</span>,<span class="dt">ylab =</span> <span class="st">&#39;rwMC&#39;</span>,<span class="dt">main=</span><span class="st">&#39;qqplot of two functions(sigma=10)&#39;</span>)</a>
<a class="sourceLine" id="cb118-3" title="3"><span class="kw">abline</span>(<span class="dt">a=</span><span class="dv">0</span>,<span class="dt">b=</span><span class="dv">1</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb119-1" title="1"><span class="co">#compare the computation time</span></a>
<a class="sourceLine" id="cb119-2" title="2">ts &lt;-<span class="st"> </span><span class="kw">microbenchmark</span>(<span class="dt">r=</span><span class="kw">rwMR</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">2000</span>),<span class="dt">cpp=</span><span class="kw">rwMC</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">2000</span>))</a>
<a class="sourceLine" id="cb119-3" title="3"><span class="kw">summary</span>(ts)</a></code></pre></div>
<pre><code>##   expr    min      lq     mean  median      uq     max neval
## 1    r 5595.4 6096.75 7550.256 6468.35 7900.35 13825.2   100
## 2  cpp  370.5  389.45  462.610  430.90  470.45   746.3   100</code></pre>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb121-1" title="1"><span class="co"># the plot with sigma=0.5</span></a>
<a class="sourceLine" id="cb121-2" title="2">out1&lt;-<span class="kw">rwMC</span>(<span class="fl">0.5</span>,<span class="dv">20</span>,<span class="dv">2000</span>)</a>
<a class="sourceLine" id="cb121-3" title="3">out2&lt;-<span class="kw">rwMR</span>(<span class="fl">0.5</span>,<span class="dv">20</span>,<span class="dv">2000</span>)</a>
<a class="sourceLine" id="cb121-4" title="4"><span class="kw">plot</span>(out1[,<span class="dv">1</span>], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">main=</span><span class="st">&#39;rwMC(sigma=0.5)&#39;</span>, <span class="dt">ylab=</span><span class="st">&quot;x&quot;</span>,<span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb122-1" title="1"><span class="kw">plot</span>(out2<span class="op">$</span>x,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">main=</span><span class="st">&#39;rwMR(sigma=0.5)&#39;</span>, <span class="dt">ylab=</span><span class="st">&quot;x&quot;</span>,<span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb123-1" title="1"><span class="co">#compare the generated random numbers</span></a>
<a class="sourceLine" id="cb123-2" title="2"><span class="kw">qqplot</span>(out1[,<span class="dv">1</span>],out2<span class="op">$</span>x,<span class="dt">xlab =</span> <span class="st">&#39;rwMR&#39;</span>,<span class="dt">ylab =</span> <span class="st">&#39;rwMC&#39;</span>,<span class="dt">main=</span><span class="st">&#39;qqplot of two functions(sigma=0.5)&#39;</span>)</a>
<a class="sourceLine" id="cb123-3" title="3"><span class="kw">abline</span>(<span class="dt">a=</span><span class="dv">0</span>,<span class="dt">b=</span><span class="dv">1</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb124-1" title="1"><span class="co">#compare the computation time</span></a>
<a class="sourceLine" id="cb124-2" title="2">ts &lt;-<span class="st"> </span><span class="kw">microbenchmark</span>(<span class="dt">r=</span><span class="kw">rwMR</span>(<span class="fl">0.5</span>,<span class="dv">20</span>,<span class="dv">2000</span>),<span class="dt">cpp=</span><span class="kw">rwMC</span>(<span class="fl">0.5</span>,<span class="dv">20</span>,<span class="dv">2000</span>))</a>
<a class="sourceLine" id="cb124-3" title="3"><span class="kw">summary</span>(ts)</a></code></pre></div>
<pre><code>##   expr    min     lq     mean  median      uq     max neval
## 1    r 5510.4 6030.7 7517.761 6690.20 7979.45 15035.7   100
## 2  cpp  327.5  355.9  422.175  384.05  440.30   726.0   100</code></pre>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
